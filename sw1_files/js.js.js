'use strict';(function(){var z,D,v,t;function B(a,b,c){if(c=a[b])if(c=document.getElementById(c))return a[b]=c;delete a[b]}function L(a,b){for(var c in b)!a.hasOwnProperty(c)&&b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function G(a,b,c){if(!a)return-1;for(var d=0,e=a.length;d<e;d++)if(a[d][b]==c)return d;return-1}function H(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function n(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,
c);else{var e=a[d];a[d]=function(){var a=e.apply(this,arguments),b=c.apply(this,arguments);return a===void 0?b:b===void 0?a:b&&a}}}function o(a,b,c){if(c)a.setAttribute(b,c);else return a.getAttribute(b)}function C(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent)}return{left:b,top:c}}function E(a){return"<b>"+a+"</b>"}function M(){var a=function(){var a=void 0;window.XMLHttpRequest?a=new XMLHttpRequest:window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP"));
return a}();return{call:function(b,c){if(a&&b)try{a.open("GET",b,!0),a.send(null)}catch(d){window.ueLogError&&window.ueLogError(d,{logLevel:"ERROR",attribution:"ISS Recent Searches : "+c+" Feature",message:c+" Operation Failed when calling "+b})}}}}function N(a){var b,c,d,e,f=a||0;return{callSuggestionsService:function(a){b=a;c=document.getElementsByTagName("head").item(0);d="JscriptId"+f;e=document.createElement("script");o(e,"type","text/javascript");o(e,"charset","utf-8");o(e,"src",b);o(e,"id",
d);c.appendChild(e)},cleanup:function(){try{c.removeChild(e)}catch(a){}},counter:f}}function F(a){var b=document.getElementsByTagName("*"),a=RegExp("(^|\\s)"+a+"(\\s|$)"),c=[],d;for(d=0;d<b.length;d++)a.test(b[d].className)&&c.push(b[d]);return c}function w(){var a=document.getElementsByClassName("psearch");if(!(a.length<=0)){var b=document.getElementById("search-ac-init-data");if(b){for(var c=b.getAttribute("data-aliases").split(","),d=b.getAttribute("data-ime"),e=b.getAttribute("data-mkt"),b=b.getAttribute("data-src"),
f=0;f<a.length;f++){var g=a[f];if(g){var j=g.tagName.toLowerCase()==="input"?g:g.getElementsByTagName("input")[0];if(j&&j.id){var i=document.getElementById(j.id+"-data");if(i){var k=i.getAttribute("data-form"),g=j.id.replace(/-/g,"___"),x=i.getAttribute("data-dropdown"),q=i.getAttribute("data-popup"),i=i.getAttribute("data-implicit-alias");if(k!==void 0&&(!ACs[g]||q))j=new AutoComplete({src:b,mkt:e,ime:d,aliases:i?[i]:c,sb:j.id,form:k,dd:x,popupBox:q,callback:"ACs."+g+".updateAutoCompletion"}),ACs[g]=
j}}}}typeof uet=="function"&&(uet("be",t,{wb:1}),uex("ld",t,{wb:1}))}}}typeof uet=="function"&&uet("bb","iss-init-aw",{wb:1});z=window.ue&&typeof ue.tag=="function"&&typeof uet=="function"&&typeof uex=="function";t="iss-init-aw";D={disabled0:"iss-c0-aw",disabled2:"iss-cs-aw"};v=!1;var O=function(a,b){function c(b){if(b!==void 0)f=g=b,a.value=b;return a.value}function d(a){a!==void 0&&(i=a);return i}function e(a){var i=c();if(i!=f&&(a||i!=g))d(f=i),b.change(i)}var f,g,j,i,k,x=this;z&&!v&&(ue.tag(a===
document.activeElement?"iss-late-aw":"iss-on-time-aw"),v=!0);n(a,"keyup",function(a){switch(a.keyCode){case 13:b.hide();break;case 27:return b.dismiss();default:e(!0)}});n(document.body,"click",function(c){var h;h=(c=c.target||c.srcElement)&&c.id&&c.id.indexOf("iss_sh_delete")!==-1,c=h;document.activeElement!=a&&!c&&(b.dismiss(),j=!1)});n(a,"focus",function(){j=!0;var a=x.pos(),d=c();window.sx&&window.sx.searchsuggest&&(b.change(d),k||(b.record("27941"),k=!0));window.scrollTo(0,a.top)});o(a,"autocomplete",
"off");i=f=c();this.keyword=function(a){return c(a)};this.userInput=function(a){return d(a)};this.size=function(){return{width:a.offsetWidth,height:a.offsetHeight}};this.pos=function(){return C(a)};this.parent=function(){for(var b=a.parentNode;b&&b.className;){if(/\b(?:a-global-nav-search|suggest_parent)\b/.test(b.className))return b;b=b.parentNode}return a.parentNode};this.update=e;this.hasFocus=function(){return j};this.focus=function(){a.focus()};this.blur=function(){a.blur()}},P=function(a,b,
c,d){function e(){a.pos();a.size();c&&C(c);g.style.width=b.offsetWidth+"px"}function f(){a.pos();a.size();g=document.createElement("div");g.id="srch_sggst";g.style.display="none";n(g,"click",function(a){for(var a=a?a:event,b=a=a.srcElement?a.srcElement:a.target,c=-1,e=!1,c=4;b!==g&&b.className!=="suggest_row"&&c>=0;)b=b.parentNode,c-=1;b.className==="suggest_row"&&(c=b.id?parseInt(b.id.substr(6)):-1,e=a&&a.id&&a.id.indexOf("iss_sh_delete")!==-1,d(b,c,e))});e();a.parent().appendChild(g);n(window,"resize",
e);return g}var g;this.visible=function(){return(g||f()).style.display!="none"};this.hide=function(){(g||f()).style.display="none";this.html("")};this.show=function(){g||f();e();(g||f()).style.display=""};this.html=function(a){(g||f()).innerHTML=a};this.destroy=function(){g&&(a.parent().removeChild(g),g=void 0)}};window.AutoComplete=function(a){function b(a){h=L(a,F);B(h,"sb");B(h,"form");if(h.sb&&h.form)B(h,"dd"),B(h,"popupBox"),r=new O(h.sb,{hide:e,dismiss:f,change:g,record:d}),u=new P(r,h.form,
h.popupBox,i),h.protocol=h.protocol||window.parent.document.location.protocol,c(),h.ime&&window.setInterval(function(){r.update()},20),h.aliases&&h.aliases.length==1&&(v=h.aliases[0])}function c(){y=[];if(window.sx&&window.sx.searchsuggest&&window.sx.searchsuggest.searchedText)for(var a=window.sx.searchsuggest.searchedText,b={},c=0;c<a.length;c++)if(!b[a[c].keywords]){var d=a[c];d.sh="1";var h=d,g=a[c].keywords,p=document.createElement("div");p.innerHTML=g;h.keyword=p.childNodes.length===0?"":p.childNodes[0].nodeValue;
y.push(d);b[a[c].keywords]=1}}function d(a){ue&&ue.id&&(a=[h.protocol+"//",location.host,"/mn/search/csl?","rrid="+ue.id,"&cpt=SearchAW","&ctw="+a].join(""),J.call(a,"WeblabTrigger"))}function e(){!h.ime&&q()}function f(){return u.visible()?(setTimeout(function(){return function(){q()}}(),300),l=-1,k(),!1):!0}function g(){n&&(clearTimeout(n),n=null);n=setTimeout(function(){return function(){s&&s.cleanup();if(r.hasFocus()){var a;if(!(a=v))a=h.dd?(a=h.dd.value&&h.dd.value.match(C))?a[1]:null:null;var b=
r.keyword(void 0),c;if(c=h.dd)if(!(c=!a)){c=h.aliases;var d;if(d=c){a:{d=0;for(var g=c.length;d<g;d++)if(c[d]==a){c=d;break a}c=-1}d=c>=0}c=!d}c||(!h.dd&&!a&&(a="aps"),!b||!b.length?(m=I([],[],y),m.length>0?j(""):q()):(c=!z?null:D[K],b=encodeURIComponent(b),a=h.protocol+"//"+h.src+"?method=completion&q="+b+"&search-alias="+a+"&client="+h.cid+"&mkt="+h.mkt+"&x="+h.callback,s=new N(K++),c&&uet("bb",c,{wb:1}),s.callSuggestionsService(a)))}n=null;l=-1}}(),100)}function j(a){var b=h.sugPrefix;if(A<=0)u.hide();
else{u.show();for(var c=document.getElementById("srch_sggst"),d="",g=0;g<A;g++){d+='<div id="'+(b+g)+'" class="suggest_row">';var e;e=m[g];var p=a,i=g,f=e.keyword,j=e.sh?x(f,p):f.toLowerCase().indexOf(p.toLowerCase()),k=void 0,k=j==-1,l=i+1==A?"suggest_link suggest_link_bottom":"suggest_link";if(e.sh)f=p,p=document.createElement("div"),p["textContent"in p?"textContent":"innerText"]=f,p=p.innerHTML,k=p.length,f=e.keywords,j=x(f,p),j>=0&&(f=f.substr(0,j)+E(f.substr(j,k))+f.substr(j+k)),e=" <div class='"+
l+"'><span style='color:#800080;'>"+f+"</span></div> <div class='suggest_delete'> <i id='iss_sh_delete"+i+"'  class='a-icon a-icon-clearsearch'></i></div> ";else{if(!k)e.sc?f=E(f):(k=p.length,f=f.substr(0,j)+E(f.substr(j,k))+f.substr(j+k));e=f="<div class='"+l+"'>"+f+"</div>"}d+=e;d+="</div>"}c.innerHTML=d}}function i(a,b,c){l=b;l<0||(c?(b=m[l],a=h.protocol+"//"+location.host+b.deleteUrl,b=G(y,"keyword",b.keyword),b!=-1&&y.splice(b,1),window.setTimeout(function(){r.focus()},0),J.call(a,"DeleteKeyword")):
(window.setTimeout(function(){r.blur()},0),k(),u.hide(),h.form.submit()))}function k(){var a=r.keyword(void 0);if(l>=0)a=m[l],a=a.keyword;r.keyword(a);var b=l,c=document.getElementById("issprefix");if(b>=0){var a=r.userInput(),d=h.form,f=m&&m[b]&&m[b].sc=="1"?"ss_sc":m&&m[b]&&m[b].sh=="1"?"ss_sh":"ss_i",g=a.length,e=o(d,"action"),b=f+"_"+b+"_"+g;w.test(e)?e=e.replace(w,"ref=is_s_"+b):(e.charAt(e.length-1)!="/"&&(e+="/"),e+=b);o(d,"action",e);c?o(c,"value",a):(c=h.form,d=document.createElement("input"),
o(d,"name","sprefix"),o(d,"value",a),o(d,"type","hidden"),d.id="issprefix",c.appendChild(d))}else c&&h.form.removeChild(c)}function x(a,b){var c=a.toLowerCase().search(RegExp("(^|(?:\\s))"+H(b.toLowerCase()),"i"));return c<=0?c:c+1}function q(){s&&(s.cleanup(),s=null);A=0;u.hide();l=-1}function I(a,b,c){for(var d=c?c.slice(0,t):[],e=0,f=Math.min(t,a.length),g,e=0;e<f;e++)G(c,"keyword",a[e])==-1&&(g={keyword:a[e],sc:b&&b[e]&&b[e].sc=="1"},d.push(g));d=d.slice(0,t);A=d.length;return d}var h={},l=-1,
m=[],A=0,n=null,t=6,s=null,r,u,v,w=/(ref=[\w-]+)/,C=/search-alias\s*=\s*([\w-]+)/,y=[],J=new M,F={dd:"searchDropdownBox",cid:"amazon-search-ui-mobile",action:"",sugPrefix:"issDiv"},K=0;a&&b(a);return{updateAutoCompletion:function(){if(s){var a=!z?null:D[s.counter];s.cleanup();s=null;if(r.hasFocus()){a&&(uet("be",a,{wb:1}),uex("ld",a,{wb:1}));var a=y,b=completion[1].length>0?2:t;if(a&&a.length!=0){for(var c=RegExp("(^|(?:\\s))"+H(completion[0].toLowerCase()),"i"),d=0,e=a.length,f=[],g;d<e&&f.length<
b;d++)g=a[d],g.keyword.toLowerCase().match(c)&&f.push(g);a=f}m=I(completion[1],completion.length>2?completion[2]:[],a);j(completion[0])}}},buildAuxSuggestions:c,hide:q,cleanUp:function(){u.destroy()}}};z&&uet("cf",t,{wb:1});window.ACs={};if(!document.getElementsByClassName)document.getElementsByClassName=F;document.readyState==="complete"?w():window.addEventListener?window.addEventListener("load",w):window.attachEvent&&window.attachEvent("load",w);(function(){function a(a){return!a?void 0:!/\ba-hidden\b/.test(a.className)}
function b(b,c){if(b){var f=a(b);c&&!f?b.className=b.className.replace(/\s?\ba-hidden\b/,""):!c&&f&&(b.className+=" a-hidden")}}function c(){function c(){var a=i.value!=="";o&&b(k,a&&(!h||l));h&&(b(q,l),b(n,!l))}function e(){m=null}function f(){m||(m=setTimeout(e,10))}function g(){m||(l=!1,c())}function j(){l=!0;c()}var i=document.getElementById("nav-search-keywords");if(i){var k=document.getElementById("nav-clear-search"),n=document.getElementById("nav-search-placeholder-icon"),q=document.getElementById("nav-searchbar-button"),
o=k&&!a(k),h=q&&!a(q),l=document.activeElement===i,m=null;o&&(i.addEventListener("change",c),i.addEventListener("keyup",c));h&&(i.addEventListener("focus",j),i.addEventListener("blur",g),q.addEventListener("mousedown",f),k&&k.addEventListener("mousedown",f));(o||h)&&c();if(k)k.onclick=function(a){a.preventDefault();i.value="";l=document.activeElement===i;c()};if(n)n.onclick=function(a){a.preventDefault();i.focus()}}}document.readyState==="complete"?c():window.addEventListener?window.addEventListener("load",
c):window.attachEvent&&window.attachEvent("load",c)})()})();
/* ******** */
(function(a,d){a.execute(function(){a.when("jQuery","A","p13n-sc-math","p13n-sc-util","p13n-sc-call-on-visible","p13n-sc-lazy-image-loader").register("p13n-sc-static-row",function(d,h,i,g,e,l){function b(e){var b=this;b.$container=d(e);if(b.$container.attr(j))return!1;else b.$container.attr(j,!0);b.$productFaceouts=b.$container.find(".p13n-sc-row-static-item");b.$heading=b.$container.find(".p13n-sc-row-static-heading");b.$overflowButton=b.$container.find(".p13n-sc-row-static-overflow-button");l.loadImages(b.$container);
b.renderRow();h.on.orientationchange(function(){b.renderRow()})}var j="data-p13n-sc-static-row-initialized";b.prototype={renderRow:function(){this.containerWidth=this.$container.children(":first").outerWidth();this.containerLeft=this.$container.children(":first").position().left;this.updateFaceouts()},updateFaceouts:function(){for(var b=this.$productFaceouts.width(),e=i.floor((this.containerWidth+4)/(b+4)),l=e>1?(this.containerWidth-e*b)/(e-1):0,c=0,a=0;a<this.$productFaceouts.length;a++)if(a<e){var d=
this.containerLeft+a*(l+b);this.$productFaceouts.eq(a).css("left",d);this.$productFaceouts.eq(a).removeClass("a-hidden");this.$productFaceouts.eq(a).height()>c&&(c=this.$productFaceouts.eq(a).height())}else this.$productFaceouts.eq(a).addClass("a-hidden");c+=this.$heading.height();this.$container.css("height",c)}};a.when("afterReady").execute("p13n-sc-static-row:init",function(){var a={distanceY:-500,distanceX:0};d(".p13n-sc-row-static-container").each(function(l,d){e.register(d,function(){new b(d)},
a)})});return b});a.when("jQuery","A").register("p13n-sc-grid-four-pack",function(f,h){function i(e,a){var b=this;a?(b.$faceouts=f(e),b.$container=f("<div></div>"),b.$container.data("reftag-prefix",b.$faceouts.eq(0).data("reftag-prefix"))):(b.$container=f(e),b.$faceouts=b.$container.find(".p13n-sc-grid-four-pack-faceout"));if(b.$container.attr(g))return!1;else b.$container.attr(g,!0);b.$images=b.$faceouts.find(".p13n-sc-grid-four-pack-faceout-image");b.reftagPrefix=b.$container.data("reftag-prefix");
b.debug=b.$container.data("debug")||"";b.loaded=!1;b.$images.load(function(e){b.layoutImage(f(e.target))});h.on.orientationchange(function(){b.layoutAllImages()});b.fetchData()}var g="p13n-sc-grid-four-pack-initialized";i.prototype={fetchData:function(){var e=this;h.ajax("/gp/p13n-mobile/four-pack",{method:"get",params:e.debug?{debug:e.debug}:{},success:function(a){e.handleAjaxComplete(a)},error:function(){e.handleAjaxComplete(null)}})},handleAjaxComplete:function(e){if(!e||e.length!==4)e=d.ue&&d.ue.count||
function(){},e("p13n:sc:four-pack:network-failure",(e("p13n:sc:four-pack:network-failure")||0)+1);else{for(var a=0;a<4;a++)this.applyData(e[a],this.$faceouts.eq(a));this.loaded=!0}},applyData:function(e,a){var b=a.find(".p13n-sc-grid-four-pack-faceout-link"),d=a.find(".p13n-sc-grid-four-pack-faceout-title"),g=a.find(".p13n-sc-grid-four-pack-faceout-image");b.attr("href",this.generateOverflowURL(e,a));d.html(e.truncatedTitle);g.attr("src",e.imageURL)},generateOverflowURL:function(a){var d=f.param({ref:this.reftagPrefix+
"_l_of_"+a.type+"_"+a.reftagID,reftagPrefix:this.reftagPrefix,title:a.title,ie:"UTF8"});d+="&asins="+a.asins.join(",");return"/gp/p13n-mobile/overflow?"+d},layoutAllImages:function(){var a=this;a.loaded&&a.$faceouts.each(function(d,b){a.layoutImage(f(b).find(".p13n-sc-grid-four-pack-faceout-image"))})},layoutImage:function(a){var d=a.get(0).naturalWidth,b=a.get(0).naturalHeight,g=a.parent(),k=g.width(),f=g.height(),m=d/b>k/f,c;d<k||b<f?(c=d,d=b):(c=!m?g.width():d*(f/b),d=m?g.height():b*(k/d));a.css({width:c,
height:d,left:(k-c)/2,top:(f-d)/2});setTimeout(function(){a.closest(".p13n-sc-grid-four-pack-faceout-link").animate({opacity:1},300,"linear")},Math.random()*500)}};a.when("afterReady").execute("p13n-sc-grid-four-pack:init",function(){if(f(".p13n-sc-grid-four-pack-gateway-weblab").length){var a=f(".p13n-sc-grid-four-pack-faceout");a.length===4&&new i(a,!0)}else f(".p13n-sc-grid-four-pack").each(function(a,b){new i(b,!1)})})})})})(function(){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors;
return d?d("PersonalizationSharedMobileExperimentJS"):a}(),window);
/* ******** */
(function(e,l,q){e.execute(function(){(function(){e.register("p13n-sc-math",function(){return Math});e.register("p13n-sc-document",function(){return document});e.register("p13n-sc-window",function(){return l});e.register("p13n-sc-undefined",function(){});var b=function(){return l.P&&l.P.AUI_BUILD_DATE};b()?(e.when("jQuery").register("p13n-sc-jQuery",function(b){return b}),e.when("ready").register("p13n-sc-ready",function(){})):l.amznJQ&&(l.amznJQ.available("jQuery",function(){e.register("p13n-sc-jQuery",
function(){return l.amznJQ.jQuery})}),l.amznJQ.onReady("jQuery",function(){e.register("p13n-sc-ready",function(){})}),l.amznJQ.available("amazonShoveler",function(){e.register("p13n-sc-amznJQ-shoveler",function(){})}));e.when("p13n-sc-window").register("p13n-sc-util",function(d){var j=d.ueLogError;typeof j!=="function"&&(j=function(b,d){if(d&&d.message)throw Error(d.message);if(b&&b.message)throw Error(b.message);});var g=function(b,d){j({logLevel:b,attribution:"P13NSharedSitewideJS",message:"[p13n-sc] "+
d})};return{constants:{DATA_ATTR_P13N_FEATURE_NAME:"p13nFeatureName"},count:d.ue&&d.ue.count||function(){},isAUI:b,log:{warn:function(b){g("WARN",b)},error:function(b){g("ERROR",b)}}}})})();e.when("p13n-sc-jQuery","p13n-sc-window","p13n-sc-undefined").register("p13n-sc-heartbeat",function(b,d,j){var g=d.clearInterval,h={},e,k,a=function(){if(!e){var a=d.setInterval(function(){var c=a,b=(new Date).getTime();c!==e?g(c):((!k||b-k>200)&&f(),k=(new Date).getTime())},200);e=a}},f=function(){b.each(h,function(a,
c){c.call(d)})};return{subscribe:function(b,c){h[b]||(h[b]=c,a())},unsubscribe:function(a){h[a]&&delete h[a];var a=!0,c;for(c in h)h.hasOwnProperty(c)&&(a=!1);a&&(g(e),e=j)}}});e.when("p13n-sc-jQuery","p13n-sc-heartbeat").register("p13n-sc-call-on-visible",function(b,d){var e=[],g=b(l),h=function(){for(var b=g.scrollTop()+g.height(),h=g.scrollLeft()+g.width(),a=e.length-1;a>=0;a--){var f=e[a],i=f.callback,c=f.$element,n=f.distanceY,f=f.distanceX;if(c.parents("body").size()===0)e.splice(a,1);else if(!c.is(":hidden")){var o=
c.offset();b-n>o.top&&h-f>o.left&&(i.call(null,c[0]),e.splice(a,1))}}e.length===0&&d.unsubscribe("p13n-sc-call-on-visible")};return{register:function(g,k,a){var f=a&&typeof a.distance!=="undefined"?a.distance:0,i=a&&typeof a.distanceY!=="undefined"?a.distanceY:f,c=a&&typeof a.distanceX!=="undefined"?a.distanceX:0;b(g).each(function(){e.push({$element:b(this),callback:k,distanceY:i,distanceX:c})});d.subscribe("p13n-sc-call-on-visible",h);h()}}});e.when("A","jQuery","p13n-sc-call-on-visible","p13n-sc-util",
"p13n-sc-math").register("p13n-sc-view-trigger",function(b,d,j,g,h){var m=function(a){var f=d(a),a=f.attr("data-params"),i=f.attr("data-url");if(a&&i){var a=b.parseJSON(a),c=f.offset(),f=[c.top,c.left,f.height(),d(l).width()];a.elementRect=f.join(",");var g=0,e={cache:!0,crossDomain:!1,data:d.param(a,!1),error:function(a){a=a.status||0;g>=3||a>=400&&a<500||setTimeout(j,200*h.pow(2,g))},global:!1,url:i},j=function(){g+=1;d.ajax(e)};j()}},k=function(a){var f=d(a);if(f.size()===1){var i=f.attr("data-params"),
i=i?b.parseJSON(i):{};if(!(i.allowEmpty!==!0&&d.trim(f.text()).length===0)){var c=f.height();if(!(i.allowEmpty!==!0&&c<5)){c=0;if(typeof i.distance==="number")c=i.distance;f.attr("data-p13n-sc-vt-initialized")||(f.attr("data-p13n-sc-vt-initialized",!0),j.register(a,function(){m(a)},{distance:c}))}}}},g=function(){b.each(d(".p13n-sc-vt:not([data-p13n-sc-vt-initialized])"),function(a){k(a)})};e.execute(g);e.when("afterReady").execute("p13n-sc-view-trigger:init",g);return{initializeElement:k}});e.when("p13n-sc-jQuery",
"p13n-sc-util","p13n-sc-window","p13n-sc-document","p13n-sc-ready").register("p13n-sc-logger",function(b,d,e,g){function h(a){return a.join("")}function m(a,c){var b=a.attr(c),f={};b!==q&&b!==null&&(f=typeof e.JSON!=="undefined"?JSON.parse(b):eval("("+b+")"));return f}function k(a,c){for(var f=[a.widget,":"],d=0;d<a.asins.length;d++){var i=a.asins[d];f.push(i.asin,"@");b.each(i,function(a,c){a!=="asin"&&f.push(a,"=",c,"|")});f.splice(f.length-1,1);f.push(",")}a.asins.length>0&&f.splice(f.length-1,
1);c&&(f.push(":","action=",a.action),b.each(a.meta,function(a,c){f.push(",",a,"=",c)}));return h(f)}function a(a,c){var f=m(b(c),"data-p13n-asin-metadata");if(f&&f.asin){var d=f.asin,i=m(b(a),"data-p13n-asin-metadata");i&&b.extend(!0,f,i[d]);return f}}function f(a,f){var i=new Image;d.count("p13n:logger:attempt",1);i.onerror=function(){c++;d.count("p13n:logger:error",1)};i.src=h(["https:"===g.location.protocol?"https://":"http://",e.ue_furl||"fls-na.amazon.com","/1/","p13n-shared-components","/1/OP/p13n/",
f,h(["?",b.param(m(b(a.featureElement),"data-p13n-global"))])])}function i(){return c>3?(n||(d.log.warn("impression image load failed too many times, no longer logging impressions"),d.count("p13n:logger:abort",1),n=!0),!0):!1}var c=0,n=!1,o={},p={},l={logAction:function(c){if(!i())if("featureElement"in c)if("action"in c){var g=b(c.featureElement);c.asins=b.map(b(c.featureElement).find(".p13n-asin").filter(":visible"),function(c){return a(g,c)});c.meta=c.meta||{};var e=m(g,"data-p13n-feature-metadata");
b.extend(!0,c.meta,e);c.widget=g.attr("data-p13n-feature-name");c.widget in o||(o[c.widget]={});if(c.asins.length!==0){for(var n=e=0;n<c.asins.length;n++)c.asins[n].asin in o[c.widget]||(o[c.widget][c.asins[n].asin]=!0,e++);c.logOnlyOnNew&&e===0||(e=h(["action/",h([c.widget,"_:",c.action,"@v=",c.eventtime||0,",impressed@v=",e]),"/",k(c,!0)]),c.replicateAsinImpressions&&(n=h(["asin/",k(c,!1)]),e=h(["batch/",e,"$",n])),f(c,e))}}else d.log.warn("action missing in eventData for logAction");else d.log.warn("featureElement missing in eventData for logAction")},
logAsyncAction:function(a){var c=(new Date).getTime(),f=typeof a.initialDelay==="number"?a.initialDelay:400,d=typeof a.timeout==="number"?a.timeout:5E3,i=b(a.featureElement);a.widget=i.attr("data-p13n-feature-name");a.widget in p&&e.clearTimeout(p[a.widget]);var h=function(){var b=a.isEventComplete(),f=(new Date).getTime();if(f-c<d&&!b)p[a.widget]=e.setTimeout(h,150);else{if(!b){if(!("meta"in a))a.meta={};a.meta.err="notfinished"}a.eventtime=f-c;delete p[a.widget];l.logAction(a)}};p[a.widget]=e.setTimeout(h,
f)},eventPending:function(a){return b(a).attr("data-p13n-feature-name")in p},impressAsin:function(c){if(!i())if("featureElement"in c)if("faceoutElement"in c){var g=b(c.faceoutElement),e=b(c.featureElement);c.widget=e.attr("data-p13n-feature-name");c.asins=[a(e,g)];g=h(["asin/",k(c,!1)]);f(c,g)}else d.log.warn("faceoutElement missing in eventData for logAction");else d.log.warn("featureElement missing in eventData for logAction")}};return l});e.when("jQuery","A","p13n-sc-call-on-visible","p13n-sc-logger",
"ready").register("p13n-sc-faceout-logger",function(b,d,e,g){var h=function(d,h){var a=b(d),f=b(h);a.length===1&&!a.attr("data-p13n-sc-fl-initialized")&&(a.attr("data-p13n-sc-fl-initialized",!0),e.register(a,function(){g.impressAsin({featureElement:f,faceoutElement:a})}))};d.on("p13n:faceoutsloaded",function(d){b(d).find(".p13n-asin:not([data-p13n-sc-fl-initialized])").each(function(b,a){h(a,d)})})});e.when("A","jQuery").register("p13n-sc-lazy-image-loader",function(b,d){return{loadImages:function(e){b.executeDeferred();
e.find(".p13n-sc-lazy-loaded-img").each(function(g,h){var e=d(h),j=e.find(".a-dynamic-image");j.load(function(){e.removeClass("p13n-sc-lazy-loaded-img")});b.loadDynamicImage(j)})}}});e.when("p13n-sc-jQuery","p13n-sc-util","p13n-sc-math").register("p13n-sc-line-truncator",function(b,d,j){function g(a){this.$element=a;this.$experimentElement=b("<div>").addClass("p13n-sc-offscreen-truncate");this.maxRows=a.attr("data-rows");this.lineHeight=this.getLineHeight();this.maxRows||d.log.error("Truncation element missing necessary line number data")}
var h=/(?=[ \-\/])/,m=/[^\/\-\[\]():\s]/;g.prototype.truncate=function(){var a=this.$element.html(),a=b.trim(a);this.$element.append(this.$experimentElement);if(!this.checkLineFit(a)){var f=this.truncateByToken(a);f?(this.$element.html(f),this.$element.attr({title:a})):d.log.error("Unable to successfully truncate line "+a)}this.$experimentElement.remove()};g.prototype.getLineHeight=function(){var a=this.$element.text();this.$element.html("&hellip;");var b=this.$element.innerHeight();this.$element.html(a);
return b};g.prototype.checkLineFit=function(a){this.$experimentElement.html(a);a=this.$experimentElement.get(0).clientHeight/this.lineHeight;return j.round(a)<=this.maxRows};g.prototype.truncateByToken=function(a){for(var a=a.split(this.getTokenSeparatorRegex()),b=1,d=a.length,c,h,e=0;b!==d;)if(c=j.floor((d+b)/2),h=a.slice(0,c).join("")+"&hellip;",this.checkLineFit(h)){if(d-c<=1){for(e=c;e>0&&!m.test(a[e-1]);)e--;break}b=c}else d=c;return e===0?void 0:a.slice(0,e).join("")+"&hellip;"};g.prototype.getTokenSeparatorRegex=
function(){return this.$element.attr("data-truncate-by-character")?"":h};var k=function(){};e.when("A").execute("trigger-linestruncated",function(a){k=function(){a.trigger("p13n:linestruncated")}});return{truncateLines:function(a){a.find(".p13n-sc-truncate:visible, .p13n-sc-truncate-medium:visible").each(function(){var a=new g(b(this));a&&(a.truncate(),b(this).addClass("p13n-sc-truncated").removeClass("p13n-sc-truncate p13n-sc-truncate-medium"),b(this).removeClass(function(a,c){return(c.match(/p13n-sc-line-clamp-\d/g)||
[]).join(" ")}))});k()}}});e.when("jQuery","A","p13n-sc-call-on-visible","p13n-sc-math","p13n-sc-window","p13n-sc-faceout-logger","p13n-sc-lazy-image-loader","p13n-sc-line-truncator").register("p13n-sc-carousel",function(b,d,j,g,h,m,k,a){function f(c){this.$container=b(c);this.$content=this.$container.find(".p13n-sc-carousel-content");if(this.$container.attr(i))return!1;else this.$container.attr(i,!0);this.devicePixelRatio=h.devicePixelRatio||1;this.itemWidth=this.originalItemWidth=this.$content.children(":first").outerWidth();
this.maxItemHeight=0;this.asins=this.$container.data("asins").toString().split(",");this.asinIndex=this.$container.data("asin-index");this.ajaxUrl=this.$container.data("ajax-url");this.lastPositionedCellIndex=0;var c=this.$container.offset(),f=parseInt(this.$container.css("margin-left"),10);g.abs(c.left)>0&&this.$container.css("margin","0 "+(f-c.left)+"px");this.hasAdditionalProducts()&&this.addLoadingAnimation();var e=this;(this.useNativeScrolling=d.capabilities.touchScrolling)?this.hasAdditionalProducts()&&
this.$container.bind("scroll.p13n-sc-carousel",function(){e.handleScroll()}):(this.useTranslate=d.capabilities.transition&&d.capabilities.transform3d,this.offsetX=0,this.transitionClass="",this.$container.bind("touchstart.p13n-sc-carousel",function(a){e.handleTouchStart(a)}));d.trigger("p13n:faceoutsloaded",this.$container);b(h).bind("resize.p13n-sc-carousel",function(a){e.handleResize(a)});this.handleResize();k.loadImages(this.$container);a.truncateLines(this.$container)}var i="data-p13n-sc-carousel-initialized";
b.extend(b.easing,{easeOutQuad:function(a){return-a*(a-2)}});f.prototype={hasAdditionalProducts:function(){return this.asins.length>this.asinIndex+1},handleScroll:function(){if(!this.isLoadingProducts&&this.hasAdditionalProducts()&&this.maxScroll){var a=this.itemWidth*5;this.maxScroll-(this.useNativeScrolling?this.$container.scrollLeft():this.offsetX)<=a&&this.loadAdditionalProducts()}},loadAdditionalProducts:function(){this.isLoadingProducts=!0;for(var a=[],f=this.asinIndex+1;f<=this.asinIndex+10&&
f<this.asins.length;f++)a.push(this.asins[f]);(f=this.$container.data("ajax-params"))||(f={faceoutTemplateClass:this.$container.data("faceout-template-class"),widgetTemplateClass:this.$container.data("widget-template-class"),reftagPrefix:this.$container.data("reftag-prefix"),auiDeviceType:this.$container.data("aui-device-type"),suppressCurrencyImageFormat:this.$container.data("suppress-currency-image-format")});f.lazyLoadImages=1;f.asins=a.join();f.offset=this.asinIndex+1;var d=this;b.ajax({url:this.ajaxUrl,
data:f,success:function(b){d.handleAjaxComplete(b,a.length)},error:function(){d.handleAjaxComplete(null,a.length)}})},handleAjaxComplete:function(c,f){var d=!1;c&&b.isArray(c)&&c.length>0&&(d=b(c.join("")),this.$loadingAnimation.before(d),k.loadImages(d),a.truncateLines(d),d=!0);this.asinIndex+=f;this.hasAdditionalProducts()||(this.removeLoadingAnimation(),this.$container.unbind("scroll.p13n-sc-carousel"),d=!0);d&&this.positionCells();this.isLoadingProducts=!1},addLoadingAnimation:function(){if(!this.$loadingAnimation)this.$loadingAnimation=
b('<div class="p13n-sc-carousel-item p13n-sc-carousel-loading-image a-manually-loaded" style="right: 0px;"></div>');this.$content.append(this.$loadingAnimation)},removeLoadingAnimation:function(){this.$loadingAnimation&&this.$loadingAnimation.remove()},handleResize:function(){this.useNativeScrolling||(this.$content.removeClass(this.transitionClass),this.$container.stop());var a=this.$container.innerWidth();this.pageSize=g.floor(a/this.originalItemWidth);this.itemWidth=this.originalItemWidth;this.positionCells(0);
if(!this.useNativeScrolling)this.offsetX=g.floor(this.offsetX/this.itemWidth)*this.itemWidth,this.applyPosition();this.handleScroll()},positionCells:function(a){for(var b=this.$content.children(),a=a===q?this.lastPositionedCellIndex:a;a<b.length;a++){var f=b.eq(a);this.maxItemHeight=g.max(this.maxItemHeight,f.height())}this.lastPositionedCellIndex=b.length-1;b=b.length*this.itemWidth;this.$content.width(b);this.$content.height(this.maxItemHeight);this.maxScroll=b-this.$container.innerWidth();d.trigger("p13n:faceoutsloaded",
this.$container)},handleTouchStart:function(a){a=a.originalEvent.targetTouches[0];this.startTouchX=a.pageX;this.startTouchY=a.pageY;this.startContentX=this.initialOffsetX=this.offsetX;this.scrollState=0;this.$content.removeClass(this.transitionClass);this.$container.stop();var f=this;b(h).bind("touchmove.p13n-sc-carousel",function(a){f.handleTouchMove(a)});b(h).bind("touchend.p13n-sc-carousel",function(a){f.handleTouchEnd(a)})},handleTouchMove:function(a){var f=a.originalEvent.targetTouches[0];if(this.scrollState===
0){var d=g.abs(f.pageX-this.startTouchX),e=g.abs(f.pageY-this.startTouchY);if(d>5&&d>e)this.scrollState=2;else if(e>5&&e>d){this.scrollState=1;b(h).unbind("touchmove.p13n-sc-carousel");b(h).unbind("touchend.p13n-sc-carousel");return}}a.originalEvent.preventDefault();a=this.startContentX+this.startTouchX-f.pageX;if(a<0||a>this.maxScroll)a=g.max(a,0),a=g.min(a,this.maxScroll),this.startTouchX=f.pageX,this.startContentX=a;this.offsetX=a;this.applyPosition()},handleTouchEnd:function(){b(h).unbind("touchmove.p13n-sc-carousel");
b(h).unbind("touchend.p13n-sc-carousel");var a=g.floor(this.startContentX/this.itemWidth);if(this.offsetX<this.startContentX)this.offsetX=(a-this.pageSize)*this.itemWidth;else if(this.offsetX>this.startContentX)this.offsetX=(a+this.pageSize)*this.itemWidth;this.offsetX=g.max(this.offsetX,0);this.offsetX=g.min(this.offsetX,this.maxScroll);this.offsetX!==this.initialOffsetX&&this.handleScroll();if(this.offsetX!==this.startContentX)a=g.abs(this.offsetX-this.startContentX)/(this.itemWidth*this.pageSize),
this.useTranslate?(this.transitionClass="p13n-sc-carousel-transition-"+g.ceil(5*a),this.$content.addClass(this.transitionClass),this.applyPosition()):this.$container.animate({scrollLeft:this.offsetX},{easing:"easeOutQuad",duration:g.ceil(250*a)})},applyPosition:function(){this.useTranslate?this.$content.css("-webkit-transform","translate3d("+-this.offsetX+"px,0,0)"):this.$container.scrollLeft(this.offsetX)}};e.when("afterReady").execute("p13n-sc-carousel:init",function(){var a={distanceY:-500,distanceX:0};
b(".p13n-sc-carousel").each(function(b,d){j.register(d,function(){new f(d)},a)})});return f});e.when("A","a-modal-positions","p13n-sc-lazy-image-loader","p13n-sc-line-truncator").register("p13n-sc-quick-look-modal",function(b,d,e,g){var h=function(a){var b={},c=a.maximumInnerHeight(),d=a.innerVerticalPadding();c-=d;a.landscape()?(a=d/2,c+=a,b.row={height:c+"px",marginTop:"-"+a+"px"},b.imageCol={height:""}):(b.row={height:c+"px",marginTop:""},c-=a.detailHeight(),b.imageCol={height:c+"px"});b.image=
{maxHeight:c+"px"};return b},m=function(a){var i=a.getContent(),c=h({maximumInnerHeight:function(){return d.util.determineMaximumInnerHeight(a)},innerVerticalPadding:function(){return d.util.determineInnerVerticalPadding(a)},landscape:function(){return b.widescreen()},detailHeight:function(){return i.find(".p13n-sc-ql-detail-col").outerHeight(!0)}});i.find(".p13n-sc-ql-row").css(c.row);i.find(".p13n-sc-ql-image-col").css(c.imageCol);i.find(".p13n-sc-ql-image").css(c.image);g.truncateLines(i);e.loadImages(i)},
k=function(a){return a.data==="p13n-sc-ql"},a=!1;b.on.resize(function(){a=!0});b.on("a:popover:beforeShow",function(b){k(b.popover)&&(a=!1,m(b.popover))});b.on("a:popover:afterUpdatePosition",function(f){k(f.popover)&&a&&(a=!1,b.delay(function(){m(f.popover);f.popover.updatePosition()},100))});return{isQuickLookModal:k,determineQuickLookModalCssUpdates:h}});e.when("A","p13n-sc-call-on-visible","p13n-sc-lazy-image-loader","p13n-sc-line-truncator").execute("p13n-sc-vw-setup",function(b,d,j,g){e.when("afterReady").execute("p13n-sc-vw-carousel:init",
function(){d.register(".p13n-sc-vw-carousel",function(d){d=b.$(d);g.truncateLines(d);j.loadImages(d)},{distanceY:-500,distanceX:0})});b.on("a:carousel:ajaxSuccess",function(b){b=b.carousel.dom.$container;b.is(".p13n-sc-vw-carousel")&&(g.truncateLines(b),j.loadImages(b))})});e.when("jQuery","A","p13n-sc-util","p13n-sc-call-on-visible","p13n-sc-lazy-image-loader","p13n-sc-line-truncator").execute("p13n-sc-static-list",function(b,d,j,g,h,m){function k(a){this.$container=b(a);h.loadImages(this.$container);
m.truncateLines(this.$container)}d.declarative("filterCoRCheckbox-change","change",function(a){a.$event.preventDefault();var f=a.$target.prop("checked");if(a.$declarativeParent){var e=a.$declarativeParent.closest(".p13n-sc-static-list");if(e.length!==0){if(l.ue&&l.ue.count){var c=f?"p13n:sc:ag:static-list:checkbox:checked":"p13n:sc:ag:static-list:checkbox:unchecked";l.ue.count(c,(l.ue.count(c)||0)+1)}var g=e.data("filtered-amazon-global-asins").toString().split(","),k=e.data("asins").toString().split(",");
e.data("filter-amazon-global-asins",f?1:0);var p=e.find(".a-touch-link");p.html(p.html().replace(/\d+/g,f?g.length:k.length));p.attr("href",p.attr("href").replace(/filterAmazonGlobalAsins=[01]/g,"filterAmazonGlobalAsins="+(f?1:0)));var c=f?g.slice(0,3):k.slice(0,3),s=e.data("ajax-params"),u=e.data("ajax-url");b.extend(s,{lazyLoadImages:1,asins:c.join(","),offset:0});e.find(".p13n-sc-ag-filter-checkbox").addClass("aok-hidden");e.find(".p13n-sc-ag-filter-spinner").removeClass("aok-hidden");d.ajax(u,
{method:"post",params:s,success:function(a){if(a&&b.isArray(a)&&a.length>0){var a=b(a.join("")),c=e.find(".p13n-sc-list-cells");c.empty();c.append(a);h.loadImages(a);m.truncateLines(a);e.find(".p13n-sc-amazon-global-error-alert").addClass("aok-hidden");e.find(".p13n-sc-ag-filter-spinner").addClass("aok-hidden");e.find(".p13n-sc-ag-filter-checkbox").removeClass("aok-hidden")}},error:function(){f=!f;a.$target.prop("checked",f);p.html(p.html().replace(/\d+/g,f?g.length:k.length));p.attr("href",p.attr("href").replace(/filterAmazonGlobalAsins=[01]/g,
"filterAmazonGlobalAsins="+(f?1:0)));e.find(".p13n-sc-amazon-global-error-alert").removeClass("aok-hidden");e.find(".p13n-sc-ag-filter-spinner").addClass("aok-hidden");e.find(".p13n-sc-ag-filter-checkbox").removeClass("aok-hidden");j.log.error("[p13n-sc-ag] List View partial endpoint for filtered AmazonGlobal ASINs had an error or returned an empty list of cells.")}})}}});e.when("afterReady").execute("p13n-sc-static-list:init",function(){var a={distanceY:-500,distanceX:0};b(".p13n-sc-static-list").each(function(b,
d){g.register(d,function(){new k(d)},a)})});return k})})})(function(){var e=window.AmazonUIPageJS||window.P,l=e._namespace||e.attributeErrors;return l?l("P13NSharedSitewideJS"):e}(),window);
/* ******** */
(function(e,i){e.execute(function(){(function(i,n,j){typeof j!=="function"&&(j=function(h,g){if(g&&g.message)throw Error(g.message);if(h&&h.message)throw Error(h.message);});e.when("jQuery","A","p13n-sc-line-truncator").register("sims-fbt",function(h,g,e){function l(){var b=this;g.declarative("fbt-expander-action",["click"],function(a){a=a.$declarativeParent.parents().find(".sims-fbt-container");a.find("#fbt-expander-heading").addClass("a-hidden");a.find("#fbt-expander-content").removeClass("a-hidden");
b.initializeCheckboxHandling(g,a)});return b}l.prototype={initializeCheckboxHandling:function(b,a){this.detachedImages=[];this.fbtRootElement=a;var c=this.fbtRootElement.find(".sims-fbt");this.cartDiv=c.find(".sims-fbt-add-to-cart");this.totalPriceDiv=c.find("div.sims-fbt-total-price");this.imageUL=c.find("ul.sims-fbt-images-list");this.chooseItemsTextDiv=c.find(".sims-fbt-choose-items-to-buy");this.fbtExpanderContent=c.find("#fbt-expander-content");this.fbtRootElement.attr("data-fbt-initialized",
"true");var d=c.find(".sims-fbt-data");if(d.size()!==0){try{this.FBTData=d.data("fbt")}catch(k){j({logLevel:"ERROR",attribution:"SimilaritiesDetailJS",message:"[sims-fbt] Unable to find Data Attribute "+k});return}this.numOfItems=c.find("div.sims-fbt-checkbox-div").length;var f=this;f.declarativeInitialized||b.declarative("fbt-checkbox-click",["change"],function(b){b.$target[0].nodeName.toLowerCase()==="input"&&f.handleCheckboxChange(b)});f.declarativeInitialized&&f.imageUL.find(".sims-fbt-image").each(function(){b.loadDynamicImage(h(this).find("img"))});
f.declarativeInitialized=!0;b.on("a:popover:show:sims-fbt-shipping-details",function(a){a=h(a.popover.$container[0]);e.truncateLines(a);a.find(".sims-fbt-details-image").each(function(){b.loadDynamicImage(h(this).find("img"))})});e.truncateLines(a)}},handleCheckboxChange:function(b){var a=b.$declarativeParent,b=b.data,c=a.find("input[type='checkbox']");c.is(":checked")?this.handleItemChecked(c,a,b):this.handleItemUnchecked(c,a,b)},handleItemChecked:function(b,a,c){a.find("div.sims-fbt-checkbox-icon").removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active");
b.attr("checked","checked");this.addItemImage(c);this.unFadeFBTItem(a);this.updateTotalPrice(a);this.updateAddToCartButton(a);this.FBTData.isAmazonApp?this.updateItemsInAppDeclarative():this.updateItemsInWebForm()},unFadeFBTItem:function(b){b.closest(".sims-fbt-row").find("div.sims-fbt-checkbox-div, .sims-fbt-row-outer").removeClass("sims-fbt-item-disable")},addItemImage:function(b){b=parseInt(b.itemNum,10);this.imageUL.find(".sims-fbt-image-"+b);for(var a=b-1;a>=1;a--){var c=this.imageUL.find(".sims-fbt-image-"+
a);if(c.length){this.detachedImages[b].insertAfter(c);this.detachedImages[b]=null;return}}this.chooseItemsTextDiv.addClass("a-hidden");this.imageUL.removeClass("a-hidden");this.imageUL.prepend(this.detachedImages[b]);this.detachedImages[b]=null},handleItemUnchecked:function(b,a,c){a.find("div.sims-fbt-checkbox-icon").removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive");b.removeAttr("checked");this.fadeFBTItem(a);this.removeItemImage(c);this.updateTotalPrice(a);this.updateAddToCartButton(a);
this.FBTData.isAmazonApp?this.updateItemsInAppDeclarative():this.updateItemsInWebForm()},updateItemsInWebForm:function(){var b=this.getOfferListingIDsSeletected(),a=this.cartDiv.find(".sims-fbt-form-input-elements"),c,d;a.find("input[name^='clientName']").length>0?(c="offerListingID.",d="ASIN."):(c="offeringID.",d="asin.");for(var k=a.find("input[name^='"+c+"']").length,f=1;f<=k;f++)a.find("input[name='"+d+f+"']").remove(),a.find("input[name='"+c+f+"']").remove();for(f=0;f<b.length;f++){var e=f+1,
g=b[f],k=h("<input>",{type:"hidden",name:d+e,value:this.FBTData.itemDetails[g].asin}),e=h("<input>",{type:"hidden",name:c+e,value:g});a.append(k,e)}},updateItemsInAppDeclarative:function(){for(var b=this.cartDiv.find("#fbt-add-to-cart-declarative").data("awMash"),a=this.getOfferListingIDsSeletected(),c="",d="",e="",f=0;f<a.length;f++){var g=a[f],h=this.FBTData.itemDetails[g].asin;c&&(c+="|");c+=h;d&&(d+="|");d+=g;e&&(e+="|");e+="1"}b.inputs.a=c;b.inputs.oid=d;b.inputs.quantity=e},getOfferListingIDsSeletected:function(){var b=
[];this.fbtExpanderContent.find("input",".sims-fbt-checkbox").each(function(){this.checked&&b.push(this.value)});return b},fadeFBTItem:function(b){b.closest(".sims-fbt-row").find("div.sims-fbt-checkbox-div, .sims-fbt-row-outer").addClass("sims-fbt-item-disable")},removeItemImage:function(b){var a=this.imageUL.find(".sims-fbt-image-"+b.itemNum),b=parseInt(b.itemNum,10),a=a.detach();this.detachedImages[b]||(this.detachedImages[b]=a);this.imageUL.find("li.sims-fbt-image").length===0&&(this.chooseItemsTextDiv.removeClass("a-hidden"),
this.imageUL.addClass("a-hidden"))},updateAddToCartButton:function(){for(var b=this.getOfferListingIDsSeletected(),a=1,c="preOrderText",d=b.length-1;d>=0;d--)if(!this.FBTData.itemDetails[b[d]].isPreorder){c="addToCartText";a=0;break}d=this.cartDiv.find(".sims-fbt-add-to-cart");a?d.removeClass("a-button-primary").addClass("a-button-preorder"):d.removeClass("a-button-preorder").addClass("a-button-primary");b.length>=1?(d.find(".a-button-text").text(this.FBTData[c][b.length]),d.attr("disabled")&&(this.FBTData.isAmazonApp&&
this.cartDiv.find("#fbt-add-to-cart-declarative").data("action","aw-mash"),d.removeClass("a-button-disabled"),d.removeAttr("disabled"))):(this.FBTData.isAmazonApp&&this.cartDiv.find("#fbt-add-to-cart-declarative").data("action","sims-fbt-declarative-disabled"),d.find(".a-button-text").text(this.FBTData.addToCartText[1]),d.addClass("a-button-disabled"),d.attr("disabled","disabled"))},updateTotalPrice:function(){var b=this.getOfferListingIDsSeletected(),a=0,c=0;if(b.length===0)this.totalPriceDiv.addClass("a-hidden");
else{for(var d=0;d<b.length&&!c;d++)if(this.FBTData.itemDetails[b[d]].doesMAPPolicyApply){c=1;break}else isFinite(this.FBTData.itemDetails[b[d]].price)&&(a+=this.FBTData.itemDetails[b[d]].price);this.totalPriceDiv.removeClass("a-hidden");b=this.totalPriceDiv.find(".fbt-total-price-value");d=this.totalPriceDiv.find(".fbt-total-price-text");c?(b.html(this.FBTData.MAPText),b.removeClass("a-color-price fbt-total-price-value-currency").addClass("fbt-map-text"),d.addClass("a-hidden")):(c=this.FBTData.currencySymbol,
c+=this.formatPrice(a),b.html(c),b.removeClass("fbt-map-text").addClass("a-color-price fbt-total-price-value-currency"),d.removeClass("a-hidden"))}},formatPrice:function(b){for(var a=(b-parseInt(b,10)).toFixed(2),a=a.replace("0.","."),c=parseInt(b,10),d=0;c>0;){var e=c%10,c=parseInt(c/10,10),a=e.toString()+a;d++;d%3===0&&c>0&&(a=","+a)}this.FBTData.currencyCode==="EUR"?(a=a.replace(/,/,"+"),a=a.replace(/\./,","),a=a.replace(/\+/,".")):this.FBTData.currencyCode==="JPY"&&(a=a.replace(".00",""));Math.abs(b)<
1&&(a="0"+a);return a}};g.on.ready(function(){return new l})})})(i,document,i.ueLogError);e.when("jQuery","A","p13n-sc-call-on-visible").execute("sims-mobile-client-side-weblab",function(e,i,j){function h(g){var b=0,a={cache:!0,crossDomain:!1,data:e.param(g,!1),error:function(a){a=a.status||0;b>=3||a>=400&&a<500||setTimeout(c,200*Math.pow(2,b))},global:!1,url:"/gp/similarities/record.html"},c=function(){b+=1;e.ajax(a)};c()}function g(e){return function(){var b=i.state(e);b&&h(b)}}function m(){i.map({"sims-session":"session-sims-weblab-state",
"udpv3-vtp-hero":"vtp-hero-weblab-state"},function(h,b){var a=e("#"+b);a.length>0&&a.data("callOnVisibleInitialized")!=="true"&&(a.data("callOnVisibleInitialized","true"),j.register(a,g(h)))})}i.on("ready a:pageUpdate",function(){m()})})})})(function(){var e=window.AmazonUIPageJS||window.P,i=e._namespace||e.attributeErrors;return i?i("SimilaritiesDetailJS"):e}(),window);
/* ******** */
(function(a){a.execute(function(){a.when("A","jQuery").register("jumpLink",function(a,c){return{bind:function(a,b,e){try{b=b||1E3,e=e||0,c("body").delegate(a,"click",function(f){try{var g=c(a);if(g.get(0)){var d=g.attr("href");d&&d.charAt(0)==="#"&&c(d).length!==0&&(f.preventDefault(),c("html, body").animate({scrollTop:c(d).offset().top-e},b))}}catch(h){window.ueLogError&&window.ueLogError(h,{logLevel:"FATAL",attribution:"jumpLink",message:"[JumpLink - Error in executing click handler]"})}})}catch(f){window.ueLogError&&
window.ueLogError(f,{logLevel:"FATAL",attribution:"jumpLink",message:"[JumpLink - Error in binding click handler]"})}}}});a.when("A","jQuery").execute(function(a){a.declarative("mySummaryExpander_1","click",function(){var a=document.getElementById("summaryText");if(a)a.style.display=a.style.display==="block"?"none":"block"})})})})(function(){var a=window.AmazonUIPageJS||P,b=a.attributeErrors;return b?b("DetailPageCommonScripts"):a}());
/* ******** */
(function(u){u.execute(function(){u.when("A","a-popover-base","a-popover-ajax","a-state","mobile-twister-data","mobile-udp-twister-view-controller","twister-swatch-click-state","twister-history").register("udp-twister",function(f,t,i,qa,u,d,G,n){var C,E;function J(a,w){var g=d.calculateViewPortRange({dimName:a}),x=f.state("mobile-twister-dim-val-list");if(x&&x[a]&&g.end&&g.end===x[a].length-1)(x=window.ue)&&x.count&&x.count("dpmobiletwistersecviewscrollend",(x.count("dpmobiletwistersecviewscrollend")||
0)+1);H(g.start,g.end,w)}function I(a){return B[a].length===1?1:0}function fa(){var a=window.ue;a&&a.count&&a.count("dpmobiletwistersecviewopen",(a.count("dpmobiletwistersecviewopen")||0)+1);X={};m=h.extend({},y);if(ga){var a=0,w;for(w in o)if(o.hasOwnProperty(w)){var g=o[w];I(g)||(R[a++]=g)}}Y!==void 0&&Y!==null&&(ha=Y.partialRefreshWorkflow);d.hasTwisterTilesOnMobile()&&(ha=d.isRequired("partial-refresh-workflow"));ra=f.state("mobile-twister-defaultAsin-list");S=1}function ia(){y=h.extend({},m);
f.each(y,function(a,w){var g=X[w];if(g){var x=h("#"+g.dimension+"-button"),b=h(".dimension-label",x),c=h(".dimension-thumbnail",x);x.removeClass("twister-required-dim-alert");b.html(g.label);c.attr("src",g.thumbnail);c.show();if(document.getElementById("unselectedDimAlert")!==null)document.getElementById("unselectedDimAlert").style.display="none";if(document.getElementById("dimsInlineError")!==null)document.getElementById("dimsInlineError").style.display="none"}})}function K(){var a=h(window).height(),
w=h(window).width(),g=h(window).scrollTop(),b=h("#twister_feature_div"),c=b.offset().top,b=b.height();g+a>=c+b&&(f.off("scroll",K),f.off("ready",K),a=h(".twisterCarousel .a-carousel-viewport").first(),c=h(".twisterCarousel .swatchSelect").first(),c.length!==0&&(g=c.outerWidth(!0),c=c.offset().left-g,ua||(ua=!0,c>=w-2*g?(a.animate({scrollLeft:c+50+"px"},"slow"),a.animate({scrollLeft:c+"px"})):(a.animate({scrollLeft:"50px"}),a.animate({scrollLeft:"0px"})))))}function L(){var a=h(".twisterCarousel .a-carousel-viewport").first(),
w=a.height(),g=a.width(),c=h(".twisterCarousel .a-carousel-viewport ol").first()[0].scrollWidth,a=a.scrollLeft();a<=3?h("#twisterLeftFade").hide():h("#twisterLeftFade").height(w).show();a+g+3>=c?h("#twisterRightFade").hide():h("#twisterRightFade").height(w).show()}function M(){ia();S=0;m={};X={};b=0;ga=!1}function N(){O.show();f.delay(function(){O.offset({top:window.scrollY,left:0}).css("height",window.innerHeight)})}function T(){O.hide();v=0}function I(a){return B[a].length===1?1:0}function ja(a){var w=
[],g=f.state("mobile-twister-singleton-display").enable,c;for(c in o)if(o.hasOwnProperty(c)){var b=o[c];a[b]===void 0&&(g&&I(b)?a[b]=0:w.push(b))}return w}function ka(a,w,g,c,b,l,e,A){var j=w[c],s,m=typeof f.state("other-avail-strings")!=="undefined"&&typeof f.state("other-avail-strings").multiple!=="undefined"&&typeof f.state("other-avail-strings").single!=="undefined",Z={};if(!l){var q=0,k,i;for(i in w)if(w.hasOwnProperty(i)&&i!==c){if(q){s="";break}s=B[i][w[i]];k=i;q=1}if(m){var Z=k,q={},o;for(o in a)if(a.hasOwnProperty(o))for(var r in B[c])if(B[c].hasOwnProperty(r)&&
B[c][r]===a[o].label&&(k=h.extend(!0,{},w),k[c]=r,(k=ba(Z,k).available)&&k.length)){q[o]={isMultiple:k.length>1,newOtherDim:k[0].label};break}Z=q}}for(var p in a)if(a.hasOwnProperty(p)&&(i=a[p],q=i.label,k=c+"_"+q,q)){o=!1;e&&(o=e[q]);(r=f.state("mobile-twister-dim-sum"))&&o&&(r=r[o]);q=B&&B[c]&&B[c][j]===q?1:0;k=b[k];i=i.label||"";var v={availabilityText:"",isAvailable:l};if(l)v.availabilityText=r&&r.availability?r.availability:"";else if(m&&typeof Z!=="undefined"&&typeof Z[p]!=="undefined"){var F=
Z[p].isMultiple?f.state("other-avail-strings").multiple:f.state("other-avail-strings").single;v.availabilityText=F.replace("otherVal###",Z[p].newOtherDim)}else v.availabilityText=s?va.replace("otherVal###",s):wa;F=ca(w,c);k=d.constructHTML(c,v,k,p,i,o,q,s,r,F);A&&A.push(k);g+=k}return g}function la(a){if(a.search("\\*")<0)return Q[a]?!0:!1;var a="^"+a.replace(/\*/g,"\\d+")+"$",a=RegExp(a,"g"),c;for(c in Q)if(c.match(a))return!0;return!1}function U(a){var c=[],g;for(g in o)if(o.hasOwnProperty(g)){var b=
a[o[g]];typeof b==="undefined"?c.push("*"):c.push(b)}return c}function ba(a,c){var g=[],b=[],d=U(c);d[o.indexOf(a)]="*";var h=!1,f;for(f in d)if(d[f]!=="*"){h=!0;break}f=d.join(":");var d={},l=B[a],e;for(e in l)if(l.hasOwnProperty(e)){var s=f.replace("*",e);la(s)&&(d[l[e]]=!0)}e=B[a];for(var k in e)e.hasOwnProperty(k)&&(f=e[k],f in d||!h?g.push({label:f}):b.push({label:f}));return{available:g,unavailable:b}}function ma(a,c,g){var b={};b[c]=ba(a,g);f.state("mobile-twister-dim-data",b)}function sa(a,
c){var g=ja(a);if(ga&&!c&&R&&R.length>0)return{type:"NXT_DIM",dimensionToDisplay:R[0]};if(!c&&g&&g.length>0)return ha?{type:"PARTIAL_REFRESH"}:{type:"NXT_DIM",dimensionToDisplay:g[0]};var b="UNKNOWN",d=U(a).join(":");if(d=Q[d]){a||(b="PARENT_REFRESH");if(a&&(!g||g.length===0))b="FULL_REFRESH";a&&g&&g.length>0&&(b="PARTIAL_REFRESH");return{type:b,asin:d}}return{type:b}}function D(a,b,g,h){N();a="/gp/twister/update?asin="+a+(b?b:"")+(g?h?"&sd="+h:"":"&vs=1");d.hasTwisterTilesOnMobile()&&(a+="&tiles=1");
(b=xa.getDeviceType())&&(a=a+"&deviceType="+b);C=a;f.ajax(a,{success:function(){d.canRemoveSpinner()&&(O.hide(),v=0)},failure:T,timeout:c})}function da(a){var c={};c.currentAsin=a;f.state("twister-selection-state",c)}function H(a,b,g){var x=f.state("mobile-twister-dim-data");x&&x[g]&&(x=x[g].available);var e=[],s=f.state("mobile-twister-dim-asin-map");s&&(s=s[g]);for(g=f.state("mobile-twister-dim-sum");a<=b;a++){var k=x[a];if(!k)break;k=s[k.label];(!g||!g[k])&&e.push(k)}var b="",A;for(A in e)e.hasOwnProperty(A)&&
(b=b+(A>0?",":"")+e[A]);b&&(e="/gp/twister/dimension?asinList="+b+"&vs=1"+(l?l:""),(A=xa.getDeviceType())&&(e=e+"&deviceType="+A),f.ajax(e,{chunk:function(a){var g={};if(a){for(var c in a)if(a.hasOwnProperty(c)){var b=a[c];if(b&&b.asin){if(!b.availability||b.availability===null)b.availability="";if(!b.price||b.price===null)b.price="";b.addOnItemBadge=!b.isAddOnItem||b.isAddOnItem===null||b.isAddOnItem===!1?"":ya;b.primeBadge=!b.hasPrimeBadge||b.hasPrimeBadge===null||b.hasPrimeBadge===!1?"":r;b.selectedBadge=
typeof b.hasFreshBadge!=="undefined"&&b.hasFreshBadge===!0?F:b.primeBadge;d.updateResponseData(b.asin,b.price,b.addOnItemBadge,b.selectedBadge,b.availability,b.isAvailable===!0);g[b.asin]=b}}g&&(a=f.state("mobile-twister-dim-sum"),g=h.extend({},a,g),f.state("mobile-twister-dim-sum",g))}},timeout:c}))}function z(a,b,g){g=U(g);g[o.indexOf(a)]="*";var c=g.join(":"),g={},a=B[a],d;for(d in a)if(a.hasOwnProperty(d)){var h=c.replace("*",d);(h=Q[h])&&(g[a[d]]=h)}g&&(d={},d[b]=g,f.state("mobile-twister-dim-asin-map",
d))}function ca(a,b){var g=ja(a);return!g||g.length===0||g.length===1&&g[0]===b?1:0}function V(a,b,g,c,h){var f=g.numInserted,l=g.totalDims-f;if(l<=0)return 0;c>l&&(c=l);for(var l=g.listHtmlArray,e=0;e<c;e++)d.appendDimensionValueView(a,b,l[e+f]);g.numInserted+=c;d.onDimensionValueViewsAppendDone(a,b,g,h);return c}function q(a,c,g,l){var e,s,k,A;function q(b){ca(m,g)&&z(g,c,m);ma(g,c,m);var h=g,l=c,x=m,j="",i=f.state("mobile-twister-dim-data"),r=f.state("mobile-twister-dim-html-data"),p=f.state("mobile-twister-secondary-view-html-data"),
p=p.secView,i=i[l],v=f.state("mobile-twister-dim-asin-map");v&&(v=v[l]);var F;i&&(F=[],j=ka(i.available,x,j,h,r,1,v,F),ka(i.unavailable,x,j,h,r,0,null,F));l=p.replace("dimKey###",aa[h]);l=l.replace("dimensionID###",h);e=l;s=F;k=F.length;A=h+"-list";(!d.hasTwisterTilesOnMobile()||ta[g])&&d.updateDimensionView(a,c,e);h=0;d.hasTwisterTilesOnMobile()&&!ta[g]&&(h=k);o={totalDims:k,numInserted:h,listDivId:A,listHtmlArray:s};d.setListUpdateData(g,o);V(g,A,o,b,c);d.hasTwisterTilesOnMobile()&&(ta[g]=!0)}function j(){if(d.isRequired("vertical-scroll")){var a=
p.secViewDimsHTML,b=p.secViewDimsMoreLoadCount,b=parseInt(b,10);h(d.createDimensionListDomSelector(A)).append(a);h(window).bind("scroll.twisterDimScope",function(){if(S){var l=h(this).scrollTop();l>na&&f.onScreen(h("#big-fat-twister-loading-div"))&&(h(d.createDimensionListDomSelector(A)+" li").filter(":visible").slice(-1).remove(),V(g,A,o,b,c),o.numInserted<o.totalDims?h(d.createDimensionListDomSelector(A)).filter(":visible").append(a):h(window).unbind("scroll.twisterDimScope"));na=l}})}}function i(a,
g,c){ca(a,g)&&setTimeout(function(){b=1;J(g,c)},250)}function r(b,g){var c=p.secViewDimsInitLoadCount,c=parseInt(c,10);d.hasTwisterTilesOnMobile()||d.updateDimensionView(a,g,"<div class='twister-white-bgcolor' id='wow-twister-spinner'></div>");f.delay(function(){var a=new Date;q(c);o.numInserted<o.totalDims&&setTimeout(function(){new Date-a<1E3&&V(b,A,o,c,g);o.numInserted<o.totalDims&&j()},10);i(m,b,g)},150)}var o,p=f.state("mobile-twister-loading-dims-html-data");!d.hasTwisterTilesOnMobile()&&d.getCurrentSecViewId(g)&&
(d.updateDimensionView(a,c,{content:""}),h(d.getCurrentSecViewId(g)).empty());d.setCurrentSecViewId(g,"#"+g+"-list");l&&window.scrollTo(0,0);d.hasTwisterTilesOnMobile()||r(g,c)}function ea(a,b,c){if(typeof ues==="function"){ues("t0",a,b);ues("ctb",a,"1");var d=function(){c&&h("#twister_tiles_enabled").length===0&&document.getElementById("a-page").scrollIntoView();v=h("#ppd").offset().top+h("#ppd").outerHeight(!0);f.delay(function(){O.offset({top:v,left:0}).css("height",window.innerHeight)})};updateCSMReqs(function(){d();
uet("af",a);setCSMReq("cf")},function(){f.trigger("image-block-refresh");uet("cf",a);CSMReqs.cf.id&&(ues("id",a,CSMReqs.cf.id),uex("ld",a))})}}function za(){if(f.state("mobile-twister-dim-list")!=="undefined"){var b=f.state("mobile-twister-dim-list").key,c;for(c in b)b.hasOwnProperty(c)&&function(b){f.on("a:popover:beforeShow:mobile-twister_"+b,function(c){if(!oa[b]){oa[b]=!0;fa();var c=c.popover,d=a+h.param(m)+"&dimension="+c.data+(l?l:"");C=d;E=c.data;q(c,d,c.data);pa=b}})}(b[c])}}function k(b,
c){fa();for(var g in b)if(b.hasOwnProperty(g)){var d=b[g],f=c[d],e=a+h.param(m)+"&dimension="+d+(l?l:"");C=e;z(d,e,{});q(f,e,d,!1)}}function j(a,b,c,l,e,k){if((c=d.getListUpdateData(a))&&k>c.numInserted-10){var e=c.listDivId,s=f.state("mobile-twister-loading-dims-html-data").secViewDimsMoreLoadCount,s=parseInt(s,10);V(a,e,c,s,b)}k>l&&(l="scrollTimer:"+a,clearTimeout(h.data(d,l)),h.data(d,l,setTimeout(function(){z(a,b,m);J(a,b)},500)))}function Aa(a,b){var c=d.getListUpdateData(a);c&&j(a,b,0,c.numInserted-
1,0,c.totalDims)}function e(){var b=f.state("mobile-twister-dim-list").key,c=f.state("prefetch-dimsum-config");if(b){m=h.extend({},y);for(var g=h(window).height(),d=parseInt(c.secondaryViewRowHeight,10),g=parseInt(g/d,10),c=c.maxDimension,d=0;d<b.length&&c>0;d++){var e=b[d];if(ca(m,e)){var s=a+h.param(m)+"&dimension="+e+(l?l:"");C=s;ma(e,s,m);z(e,s,m);H(0,g,s);c--}}}}function p(a,b,c){var d={};d[a]=b;if((a=ba(c,d).available)&&a.length){var a=a[0].label,c=B[c],h;for(h in c)if(c.hasOwnProperty(h)&&
c[h]===a)return h}return!1}var h=f.$,y={},m={},S=0,X={},aa={},a="",c=2E4,b=0,l="",s=!1,r="",F="",pa="",ya="",wa="",va="",oa={},Q=[],o=[],B=[],na=0,v=0,ga=!1,R=[],ha=!1,ra=[],Y=null,ta={};E="";C="";var xa=function(){var a;return{getDeviceType:function(){if(a)return a;var b=f.state("detail-page-device-type");if(typeof b!=="undefined")a=b.deviceType;return a}}}(),O=h('<div id="wow-twister-loading"><div id="wow-twister-spinner"></div></div>');O.hide();h("body").append(O);O.bind("touchmove touchstart touchend",
function(a){a.preventDefault()});var ua=!1;f.declarative("swatchthumb-action",["tap","click"],function(a){a=a.data;if(a.dimensionKey!==null&&a.dimValueIndex!==null){y[a.dimensionKey]=a.dimValueIndex;var b=h.extend({},y),b=U(b).join(":"),b=Q[b];da(b);ea("twisterscope_"+b,new Date,!1);d.setCanRemoveSpinner(!0);D(b,l,0);h("#twisterCarouselLabelValue-"+a.dimensionKey).text(" "+a.label);var b=h(".swatchSelect"),c=h(".swatchSelect .a-color-price"),e=h("#"+a.dimensionKey+"_"+a.dimValueIndex).parent().parent().parent(),
a=h("#"+a.dimensionKey+"_"+a.dimValueIndex+"_price");b.length>0&&(b.removeClass("swatchSelect"),b.addClass("swatchAvailable"));c.length>0&&(c.removeClass("a-color-price"),c.addClass("a-color-secondary"));e.addClass("swatchSelect");e.removeClass("swatchAvailable");a.addClass("a-color-price");a.removeClass("a-color-secondary")}});f.on.ready(function(){if(f.state("twisterComparator")!==void 0&&f.state("twisterComparator").enabled&&(K(),f.on("scroll",K),!navigator.userAgent.match(/(iPad|iPod|iPhone)/g))){var a=
h(".twisterCarousel .a-carousel-viewport"),b=h("<div>",{id:"twisterLeftFade"}),c=h("<div>",{id:"twisterRightFade"}),d=h(".twisterCarousel .a-carousel-viewport").first().height();b.height(d).hide();c.height(d).hide();a.prepend(b);a.append(c);L();h(".a-carousel-viewport").bind("scroll",L)}});f.on("a:pageUpdate",function(){if(y&&n){var a=f.state("twister-selection-state");a&&a.currentAsin&&n.saveTwisterState(a.currentAsin,y)}});d.isRequired("vertical-scroll")&&h(window).bind("scroll",function(){O.offset({top:window.scrollY>
v?window.scrollY:v,left:0});b&&(clearTimeout(h.data(this,"scrollTimer")),h.data(this,"scrollTimer",setTimeout(function(){J(E,C)},500)))});if(d.hasTwisterTilesOnMobile()){if(i=f.state("mobile-twister"))i=h.extend({},i.selectedDimensions)||{},d.setSelectedDims(i);ha=d.isRequired("partial-refresh-workflow");d.setup(k,null,j);d.setAdditionalDimensionValueLoader(Aa)}else za();f.on("a:popover:navigate",function(){S=0;oa[pa]=!1;d.hasTwisterTilesOnMobile()||(m={});X={};b=0;h(window).unbind("scroll.twisterDimScope");
na=0});f.on.orientationchange(function(){if(d.hasTwisterTilesOnMobile()){for(var a in o)if(o.hasOwnProperty(a)){var b=h("#"+o[a]+"-list");if(b.length){var c=b.html();b.hide().html(c).fadeIn("fast")}}h.each(m,function(a,b){d.scrollToValueView(a,parseInt(b,10))})}});f.on.ready(function(){var b=f.state("mobile-twister");if(b)y=h.extend({},b.selectedDimensions)||{},aa=b.dimensionDisplayText,l=b.ajaxUrlParams,s=b.parentAsin,a=b.twisterDimensionsEndpoint,r=b.primeBadgeHtml,F=b.freshBadgeHtml,ya=b.addOnItemBadgeHtml,
wa=b.notAvailableGenericText,va=b.notAvailableInText,Q=f.state("mobile-twister-dims-to-asin-list"),o=f.state("mobile-twister-dim-list").key,B=f.state("mobile-twister-dim-val-list"),e(),Y=f.state("mobile-twister-dimensions-workflow"),Y!==void 0&&Y!==null&&(ga=Y.iterateThroughAllWorkflow),d.hasTwisterTilesOnMobile()&&(ga=!1,h.each(y,function(a,b){var c=parseInt(b,10);d.scrollToValueViewWithSwish(a,c,B[a].length)}))});f.declarative("mobile-twister",["click"],function(c){var e=window.ue;e&&e.count&&e.count("dpmobiletwisterclickOndimval",
(e.count("dpmobiletwisterclickOndimval")||0)+1);var g=c.data;if(d.hasTwisterTilesOnMobile()&&(d.logDimensionTouch(g.dimension),e=d.getSelectedDims()||{},(e[g.dimension]!==void 0?e[g.dimension].toString():void 0)===g.value.toString())){d.logAlreadySelectedVariation();return}var k=!1;if(d.hasTwisterTilesOnMobile())g.available=d.getAvailableInDimensionValueActionParamsMap(g.dimension,g.value);(g.available==="0"||g.available===0)&&d.logUnavailableVariationSelection();if(d.handleUnavailableSelection(g)){var k=
!0,e=g.dimension,j=y[e];y={};j!==void 0&&(y[e]=j);m={};d.setSelectedDims(h.extend({},y))}g.dimension&&(X[g.dimension]=g);var i=t.get("mobile-twister_"+pa);oa[pa]=!1;e=c.$target.closest(".a-touch-link");G.setDimensionState(c);d.changeInSelection(g);h("a.a-active",e.closest("ul")).removeClass("a-active");e.addClass("a-active");f.delay(function(){var c=new Date;if(g.available==="0"||g.available===0)m={},R.length=0,k||(ha=!1);if(k){var e=d.getOtherDim(g.dimension);if(!d.isRequiredDim(e)){var f=g.dimension,
j=m;j[f]=g.value;f=p(f,g.value,e);f!==!1&&(j[e]=f,d.hasTwisterTilesOnMobile()&&d.scrollToValueView(e,parseInt(f,10)));d.setSelectedDims(h.extend({},j))}}R.length>0&&(e=R.indexOf(g.dimension),e>=0&&R.splice(e,1));m[g.dimension]=g.value;h(window).unbind("scroll.twisterDimScope");b=0;e=sa(m);na=0;e.type==="FULL_REFRESH"&&e.asin&&(ea("twisterscope_"+e.asin,c,!0),da(e.asin),d.setCanRemoveSpinner(!0),D(e.asin,l,0));if(e.type==="FULL_REFRESH"&&e.asin)d.hasTwisterTilesOnMobile()?(y=h.extend({},m),g.allValueList=
B,g.dimsToASIN=Q,g.dimensionDisplayText=aa,d.fullRefresh(g)):(M(),t.hide(i.id));else if(e.type==="PARTIAL_REFRESH"){e=ra[g.dimension][g.value];if(d.hasTwisterTilesOnMobile()){var e=g.dimension,j=g.value,f=f=null,r;for(r in o)if(o.hasOwnProperty(r)){var v=o[r];if(v!==e){f=v;break}}f===null?f=ra[e][j]:(r=p(e,j,f),v={},v[e]=j,v[f]=r,r=U(v).join(":"),f=Q[r]);e=f}ea("twisterscope_"+e,c,!0);da(e);D(e,l,1);d.hasTwisterTilesOnMobile()?(D(s,l,1),d.setCanRemoveSpinner(!0),y=h.extend({},m),g.allValueList=B,
g.dimsToASIN=Q,g.dimensionDisplayText=aa,d.partialRefresh(g)):(d.setCanRemoveSpinner(!0),M(),t.hide(i.id))}else e.type==="NXT_DIM"&&e.dimensionToDisplay?d.hasTwisterTilesOnMobile()?(y[g.dimension]=g.value,d.partialRefresh(g),r=d.getActionParamDataList(),c=g.dimension,e=r[c],r=a+h.param(m)+(l?l:""),q(e,r,c,!1)):(C=r=a+h.param(m)+(l?l:""),E=e.dimensionToDisplay,q(i,r,e.dimensionToDisplay,!0)):d.hasTwisterTilesOnMobile()||t.hide(i.id)},150)});f.declarative("go-to-twister",["click"],function(a){d.partialSelectionBuyBoxError(a)})});
u.when("A","a-state","mobile-twister-data").register("mobile-udp-twister-view-controller-base",function(f){var t,i,qa,W,d,G,n,C,E,J,I,fa,ia,K,L,M,N,T,ja,ka,la,U,ba;function ma(d){var f="",i=D(window),k={"vertical-scroll":!0},j={},n=!1;this.logUnavailableVariationSelection=function(){H(t)};this.hasTwisterTilesOnMobile=function(){return!1};this.isRequired=function(e){return k[e]};this.setCanRemoveSpinner=function(e){n=e};this.canRemoveSpinner=function(){return n};this.setAdditionalDimensionValueLoader=
function(){};this.setListUpdateData=function(e,d){j[e]=d};this.getListUpdateData=function(e){return j[e]};this.setCurrentSecViewId=function(e,d){f=d};this.getCurrentSecViewId=function(){return f};this.updateDimensionView=function(e,d,f){e.update(f)};this.getState=function(){return d.state("mobile-twister")};this.handleUnavailableSelection=function(){return!1};this.createDimensionListDomSelector=function(e){return"#"+e+" ul"};this.appendDimensionValueView=function(e,d,f){D(this.createDimensionListDomSelector(d)).append(f)};
this.onDimensionValueViewsAppendDone=function(){};this.constructHTML=function(e,d,f,k,j,i,q,n,a,c){e=f.replace("label###",j);e=e.replace("price###",a&&a.price?a.price:"");e=e.replace("addOnItemBadge###",a&&a.addOnItemBadge?a.addOnItemBadge:"");e=e.replace("primeBadge###",a&&a.primeBadge?a.primeBadge:"");e=e.replace("selectedBadge###",a&&a.selectedBadge?a.selectedBadge:"");e=e.replace("br###",a&&a.price?"<br>":"");e=e.replace("available###",d.isAvailable);e=e.replace("availability###",d.availabilityText);
f='<span class="a-color-secondary">'+this.getState().loadingDetailsText+'</span><br /><span class="a-price-color">&nbsp;</span>';e=e.replace("loadingHTML###",c&&typeof a==="undefined"&&d.isAvailable?f:"");e=e.replace("active###",q?"a-active":"");i&&(e=e.replace("dimSum","dimSum_"+i));return e};this.updateResponseData=function(e,d,f,k,j){D("#dimSum_"+e).html("<span class='a-color-price'>"+d+"</span> "+f+" "+k+"<br><span class='a-color-secondary'>"+j+"</span>")};this.changeInSelection=function(){};
this.calculateViewPortRange=function(d){var d=d.dimName,f=i.scrollTop(),h=i.height(),k=f+h,j=0,q=-1,n=-1;i.scrollTop();D(this.getCurrentSecViewId(d)+" "+fa).filter(":visible").each(function(){var d=D(this).offset().top;d>=f&&q<0&&(q=j);d>=k&&n<0&&(n=j-1);j++});q<0&&(q=0);n=n<0?j>0?j-1:0:n;return{start:q,end:n}};this.partialSelectionBuyBoxError=function(){}}function sa(f){var ea={},t={},k=this,j=f.$,u=null,e=null,p={},h=null,y=!1,m=null,S=!1,X={"vertical-scroll":!1,"partial-refresh-workflow":!0},aa=
{};this.isRequired=function(a){return X[a]};this.logScrollUpToVisualDimension=function(){H(i)};this.logUnavailableVariationSelection=function(){H(qa)};this.showUnavailableMessage=function(a){if(a){var c=j("#"+K+a).attr("data-dim-unavailable-msg");if(a&&c){var b=D("#"+K+a),d=b.html();b.html(c);z[a]||(z[a]={});z[a].active=!0;z[a].originalHtml=d;z[a].dimName=a;z[a].timeOutId=setTimeout(ca,4E3,a)}}};this.logDimensionTouch=function(a){var c=null,c=this.isRequiredDim(a)?W:d;c+=da[a]?G:n;H(c)};this.logDimensionSwipe=
function(a){da[a]=!0;this.isRequiredDim(a)?H(C):H(E)};this.logAlreadySelectedVariation=function(){H(J)};this.getOtherDim=function(a){if(m===null){var c=this.getDimList();m={};m[c[0]]=c[1];m[c[1]]=c[0]}return m[a]};this.hasTwisterTilesOnMobile=function(){return!0};this.useExpander=function(a){S=a};this.setCanRemoveSpinner=function(a){y=a};this.canRemoveSpinner=function(){return y};this.setAdditionalDimensionValueLoader=function(a){h=a};this.getAdditionalDimensionValueLoader=function(){return h};this.setListUpdateData=
function(a,c){aa[a]=c};this.getListUpdateData=function(a){return aa[a]};this.setup=function(a,c,b){e=a;S&&(f.on("a:expander:twister_select_expander_button:toggle:expand",function(){k.onExpand(e)}),f.on("a:expander:twister_select_expander_button:toggle:collapse",function(){k.onCollapse(e)}));b!==void 0&&(u=b);if(!S)k.onExpand(e);return!0};this.setCurrentSecViewId=function(a,c){ea[a]=c};this.getCurrentSecViewId=function(a){return ea[a]};this.getCarouselDOM=function(a){return j("#"+a+"-list ol")};this.createDimensionListDomSelector=
function(a){return"#"+a+" ol"};this.getCarouselViewPortDOM=function(a){return j("#"+a+"-list .a-carousel-viewport")};this.isRequiredDim=function(a){return(a=this.getActionParamDataList()[a])&&a.isRequired};this.setAvailableInDimensionValueActionParamsMap=function(a,c,b){a="#decl_action_"+k.getDimensionValueViewId(a,c);a=j(a);c=a.attr("data-mobile-twister");c=j.parseJSON(c);c.available=b;a.attr("data-mobile-twister",JSON.stringify(c))};this.getAvailableInDimensionValueActionParamsMap=function(a,c){var b=
"#decl_action_"+k.getDimensionValueViewId(a,c),b=j(b).attr("data-mobile-twister");return j.parseJSON(b).available?1:0};this.onExpand=function(a,c){var b=this.getDimList(),d=this.getActionParamDataList();if(c){var e=this.getSelectedDims(),f=c.allValueList,h=c.dimsToASIN;V(c.dimension);V(k.getOtherDim(c.dimension));var i=Object.keys(e),q=0,m;if(i)q=i.length,q>0&&(m=i[0]);q===1&&!k.isRequiredDim(m)&&j.each(b,function(a,b){if(e.hasOwnProperty(b)){var c=Array(f[b].length);Object.keys(h);j.each(h,function(a){a=
a.split(":")[1];c[a]=!0});var d=f[b];j.each(d,function(a){var d="#"+k.getDimensionValueViewId(b,a)+" "+L,d=j(d);c[a]?(d.removeClass(M),k.setAvailableInDimensionValueActionParamsMap(b,a,1)):(d.addClass(M),k.setAvailableInDimensionValueActionParamsMap(b,a,0))})}else k.changeInSelection({dimension:b},!0),d=f[b],j.each(d,function(a){var c="#"+k.getDimensionValueViewId(b,a)+" "+L,c=j(c),a=j("#wedge_"+k.getDimensionValueViewId(b,a));a.length&&(a.addClass("aok-hidden"),c.removeClass(N),c.addClass(T))})});
j.each(b,function(a,c){if(e.hasOwnProperty(b[a])){var d=b[a],l=parseInt(e[d],10);k.scrollToValueView(d,l);var i,q;j.each(b,function(a,b){if(b!==d)return i=b,q=a,!1});k.changeInSelection({dimension:c,value:l,label:f[d][l]},!0);for(var m=0;m<f[d].length;++m){var n="#"+k.getDimensionValueViewId(d,m)+" "+L,n=j(n),p=j("#wedge_"+k.getDimensionValueViewId(d,m));p.length&&(l===m?(p.removeClass("aok-hidden"),n.addClass(N),n.removeClass(T)):(p.addClass("aok-hidden"),n.removeClass(N),n.addClass(T)))}for(m=0;m<
f[i].length;++m)n="#"+k.getDimensionValueViewId(i,m)+" "+L,n=j(n),n.length&&(p=m+":"+l,a<q&&(p=l+":"+m),h[p]?n.removeClass(M):n.addClass(M),k.setAvailableInDimensionValueActionParamsMap(i,m,h[p]?1:0))}});if(q===1){i=k.getOtherDim(c.dimension);m=parseInt(e[c.dimension],10);for(var n=-1,p=0;p<f[i].length;++p)if(h[p+":"+m]&&n===-1){n=p;break}n!==-1&&k.scrollToValueView(i,n)}if((c.available===0||c.available==="0")&&(q===1&&!k.isRequiredDim(c.dimension)||q===2))i=k.getOtherDim(c.dimension),k.showUnavailableMessage(i)}a(b,
d)};this.onCollapse=function(a){var c=this.getDimList(),b=this.getActionParamDataList();a(c,b)};this.getDimList=function(){return f.state("mobile-twister-dim-list").key};this.getDimensionDisplayTexts=function(){return f.state("mobile-twister").dimensionDisplayText};this.getActionParamDataList=function(){return f.state(ja)};this.getSelectedDims=function(){return t};this.setSelectedDims=function(a){t=a};this.fullRefresh=function(a){if(e!==null)k.onExpand(e,a)};this.partialRefresh=function(a){if(e!==
null)k.onExpand(e,a)};this.getDimensionValueViewId=function(a,c){return"twister_glance_dim_label_"+a+"_"+c};this.highlightCurrentSelection=function(a,c){if(c!==void 0){var b="#"+this.getDimensionValueViewId(a,c)+" "+L,b=j(b);b!==null&&b.length&&(b.removeClass(N),b.addClass(T),b=j("#wedge_"+k.getDimensionValueViewId(a,c)),b.length&&b.addClass("aok-hidden"))}b=this.getSelectedDims()[a];if(!(b===void 0||b===null)){var d="#"+this.getDimensionValueViewId(a,b)+" "+L,d=j(d);d!==null&&d.length&&(d.addClass(N),
d.removeClass(T),b=j("#wedge_"+k.getDimensionValueViewId(a,b)),b.length&&b.removeClass("aok-hidden"))}};this.updateDimensionView=function(a,c,b){var d=f.$("#"+a.container),e=a.data;this.hideError(e);var h=null,h=typeof b==="string"?b:b.content,h=h.replace("dimensionKey###",e);d.html(h);a=a.data;this.setViewPortShiftCallback(a,c,u);a===ia&&j("#sizechart_url_in_twister_"+ia).removeClass("a-hidden")};this.constructHTML=function(a,c,b,d,e,f,h){if(p[a]&&h)p[a].label=e;a=b.replace("label###",e);b="";c.isAvailable||
(b=M);a=a.replace("#available#",b);a=a.replace("available###",c.isAvailable);c="";h?(c=N,a=a.replace("#show-wedge#","twister-mobile-selected-down-arrow-left")):a=a.replace("#show-wedge#","");return a=a.replace("#selected#",c)};this.appendDimensionValueView=function(a,c,b){j(this.createDimensionListDomSelector(c)).append(b)};this.onDimensionValueViewsAppendDone=function(a,c,b,d){b=j(this.createDimensionListDomSelector(c));c=!1;if(b){var e=b.find(".twister-mobile-tiles-swatch-image");e&&e.length&&(c=
!0)}b=b.closest(".twister-tiles-content-wrapper");c?b.find(".twister-mobile-tiles-carousel-footer-hr").addClass("a-hidden"):b.find(".twister-mobile-tiles-carousel-footer-hr").removeClass("a-hidden");c=this.getSelectedDims()[a];p[a]&&(this.changeInSelection({dimension:a,label:p[a].label}),p[a]=void 0);b=j("#"+this.getDimensionValueViewId(a,c));if(b===null||!b.length)(b=this.getAdditionalDimensionValueLoader())&&b(a,d);this.scrollToValueView(a,c)};this.scrollToValueView=function(a,c){var b="#"+this.getDimensionValueViewId(a,
c),d=j(b);if(d!==null&&d.length){var b=this.getCarouselViewPortDOM(a),e=b.width(),d=b.scrollLeft()+d.offset().left-e/2;d<=0&&(d=0);b.animate({scrollLeft:d},ka,"swing")}};this.scrollToValueViewWithSwish=function(a,c,b){var d=c+la;d>=b&&(d=b-la,d<0&&(d=0));k.scrollToValueView(a,d);f.delay(function(){k.scrollToValueView(a,c)},U)};this.updateResponseData=function(a,c,b,d,e){j("#dimSum_"+a).html("<span class='a-color-price'>"+c+"</span> "+b+" "+d+"<br><span class='a-color-secondary'>"+e+"</span>")};this.calculateViewPortRange=
function(a){var c=a.carousel;if(c===void 0||c===null)c=this.getCarouselViewPortDOM(a.dimName);var b=c.scrollLeft(),a=c.width(),d=b+a,e=0,f=-1,h=-1;c.find("li").each(function(){var a=j(this).offset().left;a>=b&&f<0&&(f=e);if(a>=d&&(h<0||h>=e))h=e-1;e++});f<0&&(f=0);h<0&&(h=e>0?e-1:0);return{start:f,end:h}};this.setViewPortShiftCallback=function(a,c,b){if(!(b===null||b===void 0)){var d=this.getCarouselViewPortDOM(a),e=this,f=0,h=0;d.bind("scroll",function(){e.hideError(a);var i=e.calculateViewPortRange({carousel:d}),
j=i.start,i=i.end;(f!==j||h!==i)&&b(a,c,f,h,j,i);f=j;h=i})}};this.clearAllSelection=function(a,c){for(var b in a)if(a.hasOwnProperty(b)&&(c===void 0||c!==b))a[b]=void 0};this.handleUnavailableSelection=function(a){var c=a.available==="0"||a.available===0;p={};if(c)if(this.isRequiredDim(a.dimension)){var b=this.getDimList(),d;for(d in b)if(b.hasOwnProperty(d)){var e=b[d];a.dimension!==e&&(p[e]={dimIndex:0})}}else for(d in b=this.getDimList(),b)b.hasOwnProperty(d)&&(e=b[d],e!==a.dimension&&(p[e]={dimIndex:ba}));
return c};this.changeInSelection=function(a,c){var b=a.dimension;this.hideError();var d=t[b];if(a.value!==void 0)t[b]=a.value;var e=j("#twister_dim_name_label_"+b),f="";a.label?(f=e.attr("data-dim-name"),e.attr("data-dim-label-mode",1)):(f=e.attr("data-dim-prompt"),e.attr("data-dim-label-mode",0));var h=j("#twister_dim_label_"+b);a.label?(e.html(f+": "),h.html(a.label),h.removeClass("a-hidden"),e.addClass("a-color-secondary"),e.removeClass("a-color-base")):(e.html(f),h.addClass("a-hidden"),e.addClass("a-color-base"),
e.removeClass("a-color-secondary"));c||this.highlightCurrentSelection(b,d)};this.hideError=function(a){if(a!==void 0){j("#twister_dim_error_msg_"+a).addClass("a-hidden");j("#twister_dimension_content_"+a+" .divider").removeClass("a-alert-error");var c=j("#twister_dim_name_label_"+a);c.removeClass("a-hidden");parseInt(c.attr("data-dim-label-mode"),0)&&j("#twister_dim_label_"+a).removeClass("a-hidden")}else for(c in a=this.getDimList(),a)a.hasOwnProperty(c)&&this.hideError(a[c])};this.showError=function(a){V(a);
H(I);j("#twister_dim_name_label_"+a).addClass("a-hidden");j("#twister_dim_label_"+a).addClass("a-hidden");j("#twister_dim_error_msg_"+a).removeClass("a-hidden");j("#twister_dimension_content_"+a+" .divider").addClass("a-alert-error");var c=j("#twister_dim_error_msg_"+a);if(c.length>0)a=c[0].getBoundingClientRect().top,c=c.offset().top,a<0&&j("html, body").delay(500).animate({scrollTop:c-5},1500)};this.partialSelectionBuyBoxError=function(){var a=this.getDimList(),c=this.getSelectedDims(),b;for(b in a)if(a.hasOwnProperty(b)){var d=
a[b];c.hasOwnProperty(d)||this.showError(d)}}}var D=f.$;ja="mobile-twister-tiles-view-param-data";fa=".aw-twister-row";ia="size_name";ba=-1;M="twister-mobile-tiles-swatch-unavailable";N="twister-mobile-tiles-swatch-selected";T="twister-mobile-tiles-swatch-unselected";L=".twister-mobile-tiles-swatch";la=4;U=500;ka=1E3;K="twister_dim_prompt_container_";var da={};G="AfterSwipe";n="BeforeSwipe";C="swatchSwipeRequiredDim";E="swatchSwipeNotRequiredDim";I="errorShownAfterAddToCart";W="touchRequiredDimensionSwatch";
d="touchNotRequiredDimensionSwatch";J="alreadySelectedVariation";qa="unavailableVariationTouchInGlanceView";t="unavailableVariationTouchInSecondaryView";i="scrollUpToVisualDimension";var H=function(d){if(d){var d="MobileTwister:"+d,f=window.ue;f&&f.count&&f.count(d,(f.count(d)||0)+1)}},z={},ca=function(d){var f=D("#"+K+d);f.fadeOut(700,function(){z[d].active===!0&&f.html(z[d].originalHtml).fadeIn(700,function(){if(z[d].active===!0)z[d].active=!1})})},V=function(d){if(z[d]&&z[d].active===!0){z[d].active=
!1;clearTimeout(z[d].timeOutId);var f=D("#"+K+d);f.stop(!1,!0);f.html(z[d].originalHtml);f.show()}};(function(d){var f=null,i=D("#twister_tiles_enabled");i&&i.length?(f=new sa(d),u.when("ready").register("mobile-udp-twister-view-controller",function(){return f})):(f=new ma(d),u.when("A").register("mobile-udp-twister-view-controller",function(){return f}))})(f)});u.when("A","mobile-udp-twister-view-controller").execute("mobile-udp-twister-view-controller-logger",function(f,t){if(t.hasTwisterTilesOnMobile()){var i=
t.getDimList();f.each(i,function(f){t.getCarouselDOM(f).bind("touchmove",function(){t.logDimensionSwipe(f)})})}});u.when("A","jQuery","atf").execute(function(f){f.loadDescendantImagesManually(".twister-tiles")});u.when("jQuery").register("twister-swatch-click-state",function(){var f=["color_name","metal_type","lens_color"],t;return{setDimensionState:function(i){t=!1;if(i=i.data){var i=i.dimension,u=!1;i&&(i=i.toLowerCase(),u=f.indexOf(i)>=0);t=u}},getDimensionState:function(){return t}}});u.when("A").register("twister-history",
function(f){function t(f){var i="",i=$.map(f,function(d,f){return f+"="+d}).join("&");return"?"+i}var i=this;i.$=f.$;i.mobileTwisterState="mobile-twister";i.mobileTwisterDimListState="mobile-twister-dim-list";i.reminisceDataState="reminisce-data";i.twisterSelectionState="twister-selection-state";i.twisterHistoryParam="th";i.twisterPSCParam="psc";return{saveTwisterState:function(u,W){var d,G=f.state(i.reminisceDataState);if(window.history&&window.history.replaceState&&u&&W&&G&&"reminisceEnabled"in
G){var n=!1;f.state(i.mobileTwisterState);d=f.state(i.mobileTwisterDimListState);if(W!==void 0&&d.key!==void 0){n=0;d=d.key.length;for(var C in W)W.hasOwnProperty(C)&&n++;n=n<d}d=n;if(u){C="";for(var E=window.location.search,n={},E=E.substring(E.indexOf("?")+1).split("&"),J=0;J<E.length;J++){var I=E[J].split("=");I[0]&&I[0].length>=0&&(n[decodeURIComponent(I[0])]=decodeURIComponent(I[1]))}G.reminisceEnabled?(n[i.twisterHistoryParam]=1,C=u,d||(n[i.twisterPSCParam]=1),d=t(n),n=G.asinInURL,n=window.location.pathname.replace(RegExp(n,
"i"),C)):(n[i.twisterHistoryParam]=0,d=t(n),n=window.location.pathname);if(d&&n)window.history.replaceState(window.history.state,document.title,n+d),G.asinInURL=C,f.state(i.reminisceDataState,G)}}}}})})})(function(){var u=window.AmazonUIPageJS||P,f=u.attributeErrors;return f?f("DetailPagePhoneTwisterAssets"):u}());
/* ******** */
(function(k){k.execute(function(){k.when("A").execute(function(a){k.now().register("postMetric",function(){return{startLatencyMetric:function(){},postLatencyMetric:function(){},postCountMetric:function(b,a){if(typeof b!=="undefined"){var c=window.ue;if(c)if(typeof a!=="undefined")c.count(b,a);else{var f=c.count(b)||0;c.count(b,f+1)}}},postLatencyCounter:function(b){window.ue&&typeof window.ue_t0!=="undefined"&&window.ue.count(b,a.now()-window.ue_t0)}}})});k.when("A","jQuery","airy-image-block","image-block-exp-weblab",
"postMetric","atf").execute(function(a,b,E,c,f){function m(){g=b("#image-block");(z=g.length?!1:!0)&&(g=b("#single-image-block"));l=g.find("img");u=g.height()}function j(){function v(){a.loadDynamicImage(b("#main-image"));a.executeDeferred();a.loadImageManually(b("#image-block .carousel-img-manual-load"))}w==="T1"?(a.loadDynamicImage(b("#main-image")),a.loadImageManually(b("#image-block .carousel-img-manual-load")),a.executeDeferred()):w==="T2"?(a.loadHiResImage(b("#main-image")),a.loadImageManually(b("#image-block .carousel-img-manual-load")),
a.executeDeferred()):(a.delay(v,600),a.delay(v,1500),a.delay(v,3E3));var e=document.getElementsByClassName("fp-video-wrapper");e!==null&&e.length>0&&f.postCountMetric("dpmob_videoAvailable",e.length)}function i(){function a(b,e){var v=b[0].pageX-e.left,d=b[0].pageY-e.top,x=b[1].pageX-e.left,c=b[1].pageY-e.top;return{midX:(v+x)/2,midY:(d+c)/2,distance:Math.sqrt(Math.pow(v-x,2)+Math.pow(d-c,2))}}var e,d=0,c=!1,h=!0;l.bind("touchstart",function(d){var x=d.originalEvent.targetTouches;x.length===2&&(e=
a(x,b(d.target).offset()))});l.bind("touchmove",function(p){var g=p.originalEvent.targetTouches;g.length===2&&(p=a(g,b(p.target).offset()),e&&(c=!0,p=p.distance-e.distance,d+=Math.abs(p),d>4&&!h&&p>0&&(h=!0,f.postCountMetric("dpmob_pinchZoomInPV",void 0))))});l.bind("touchend touchleave touchcancel",function(b){c&&b.originalEvent.targetTouches.length===0&&(d=0,h=c=!1)})}function s(a){var e=b("#image-block-pagination-dots li");e.length>0&&(e.removeClass("a-selected"),e.eq(a-1).addClass("a-selected"));
E.updateStateForAction(b("#image-block"),a,{embeddedCallback:r,instance:y})}function r(b){y=b}function D(){var d=0,e;b("#image-block .image-size-wrapper img").click(function(x){x.stopPropagation();var c=b(this),x=a.now()-d;d=a.now();x>300&&(e=setTimeout(function(){c.parent().click()},400))});b("#image-block .image-size-wrapper img").bind("doubleTap",function(){clearTimeout(e)})}function t(){b("#loadingImages").hide();b("#image-block-pagination-dots").show();b("#pagination-badge-wrapper").show();s(1);
var a=c.atfRedesignEnabled&&c.atfRedesignEnabled()===!0,e=c.atfRedesignV2Enabled&&c.atfRedesignV2Enabled()===!0,d=c.isLimbEnabled&&c.isLimbEnabled()===!0,p=b("#landing-image-wrapper").data("imageSizes");if((d||a||e)&&p)if(d=b("#image-block"),d.length){a=window;e="inner";"innerWidth"in window||(e="client",a=document.documentElement||document.body);for(var a=a[e+"Width"]-20,e=d.css("max-height").replace("px",""),d=d.find(".image-size-wrapper"),h=1;h<p.length;h++){var f=p[h][1],g=p[h][0],f=g*(e/f)>=
a?g<a?f:f*(a/g):f<e?f:e;d[h]&&d[h].classList.contains("fp-image-wrapper")&&(b(d[h]).css("height",f+"px"),b(d[h]).find("img").css("max-height",e+"px"),b(d[h]).find("img").css("height",f+"px"))}}I&&D()}function o(){if(c.isSwitchLandingImageTwice&&c.isSwitchLandingImageTwice()===!0){n=b("#main-image");var a=n.data("hires-replacement"),e=A;if(!(a===null||a===void 0||typeof a!=="string")){var d=new Image;if(e!==null&&e!==void 0&&typeof e==="function")d.onload=e;d.src=a}}}function A(){if(c.isSwitchLandingImageTwice&&
c.isSwitchLandingImageTwice()===!0){var b=n.data("hires-replacement");n.attr("src").indexOf("data")===0?f.postCountMetric("dp-AuiReplacementAfterManualReplacement",1):f.postCountMetric("dp-AuiReplacementAfterManualReplacement",0);var a=n.clone();a.attr("src",b);n.replaceWith(a)}}var y,B=!1,w=c.getTreatment(),g,l=[],z,u,d=c.isLimbAnimationEnabled?c.isLimbAnimationEnabled():!1,p=!0,n,I=c.imageBlockPinchZoomEnabled;if(d){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)}}();var G=function(){if(g&&p)for(var a=g[0].getBoundingClientRect().top-10,d=Math.min(Math.max(g.height()+a,150),u),a=d/u,d=(u-d)/2,c=0;c<l.length;c++){var f="translate3d(0, "+d+"px, 0)",h=b(l[c]);h&&h.css("height")&&(parseInt(h.css("height").replace("px",""),10)>=150&&(f=f+" scale("+a+")"),h.css("transform",f),h.css("-webkit-transform",f))}window.requestAnimFrame(G)};window.requestAnimFrame(G)}j();var J=a.once(function(){f.postLatencyCounter("dpmob_carouselInitialized")}),
C=a.once(function(){f.postLatencyCounter("dpmob_mainImageReplaced")});a.on("a:image:load:mainImage",function(){C()});if(c.isCarouselFastInitLoaderEnabled)a.on("a:image:load",function(b){b=b.$imageElement;b.hasClass("carousel-img-manual-load")&&b.parent().find(".carousel-loader").remove()});b("#tapToSee3D").bind("click",function(){f.postCountMetric("imageBlock3DToastClicked",void 0)});m();z&&i();a.on("a:popover:afterHide:immersive-view",function(){B=!1});a.on("a:popover:beforeShow:immersive-view",
function(){B=!0;f.postCountMetric("dpmob_IVOpened",void 0)});a.on.load(function(){a.delay(function(){b("#image-block-pagination-dots").css("display")==="none"&&t()},2E3)});a.on.ready(o);a.on("image-block-refresh",function(){j();m();E.imageBlockRefresh&&E.imageBlockRefresh();z&&i();o()});k.when("a-carousel-framework","image-block-exp-weblab").execute(function(d,e){function c(){k.when("a-immersive-image").execute(function(d){var e=h.dom.$carousel.find("li");a.delay(function(){e.find(".a-immersive-image img").each(function(){d.zoomOut(b(this))})},
200)})}function g(){var a=n.getBoundingClientRect().top;a<0&&Math.abs(a)>l&&k.when("a-immersive-image").execute(function(a){h.dom.$carousel.find("li").find(".a-immersive-image img").each(function(){a.zoomOut(b(this))})})}var h;e.isCarouselFastInitEnabled&&(d.createAll(),d.initializeAll());d.onInit("image-block-carousel",function(d){typeof d!=="undefined"&&(h=d);J();t();m();i();k.when("a-popover-base").execute(function(){a.on("a:popover:afterSlideOut",function(){h.resize()})});b("#pagination-badge-wrapper").bind("click",
function(){f.postCountMetric("dpmob_tapOnAltImageBadge",void 0);var a=b("#pagination-badge #page-no").text(),d=b("#pagination-badge #total-pages").text();parseInt(a,10)===1&&f.postCountMetric("dpmob_tapOnFirstAltImageBadge",void 0);a!==d&&h.gotoNextPage()});b(".brick-pagination-clickable").delegate("li","click",function(){var a=b(this).index()+1;h.gotoPage(a)});b("#image-block-pagination").delegate("li","click",function(){f.postCountMetric("dp-mob-clickOnImageBlockPaginationElement",void 0)});b(".threeDPagination").delegate("li",
"click",function(){var a=b(this).index()+1;h.gotoPage(a)})});var j=b("#imageBlock_feature_div"),n=j[0],l=n.clientHeight;a.on("a:immersiveImage:zoomIn",function(a){b(window).bind("scroll",g);a=a.$image;typeof h!=="undefined"&&b.contains(j[0],a[0])&&(h.pause(),p=!1)});a.on("a:immersiveImage:zoomOut",function(d){b(window).unbind("scroll",g);d=d.$image;typeof h!=="undefined"&&b.contains(j[0],d[0])&&(p=!0,a.delay(function(){p&&h.resume()},700))});b(window).bind("orientationchange",function(){c()});a.on("a:carousel:image-block-carousel:change:pageNumber",
function(a){b("#pagination-badge #page-no").text(a.newValue);B||f.postCountMetric("dpmob_primaryViewImageChanged",void 0);y&&y.isFullScreen()?E.setShouldDetachOnExitFullScreen(!0):(E._detachAiryInstance(y),a.oldValue!==a.newValue&&s(a.newValue))});k.when("a-popover-base").execute(function(){a.on("a:popover:afterSlideOut",function(){var a=b("#a-page");a.length>0&&(a.css("-webkit-transition",""),a.css("-webkit-transform",""))})})});k.when("load-airy-assets").execute(function(a){k.load.css(a.cssUrl);
k.load.js(a.jsUrl)})});k.when("A","jQuery","a-carousel-framework","airy-image-block","postMetric","atf").execute(function(a,b,E,c,f){function m(){var a=r()-50;b("#immersive-main").css("height",a+"px")}function j(a){o=a}function i(a){var b=E.getCarouselByName(a);if(typeof b==="undefined")for(var c=E.getAllCarousels(),f=0;f<c.length;f++){var g=c[f];if(g.getAttr("name")===a){b=g;break}}return b}function s(a){if(A&&y){var c=i(w);typeof c!=="undefined"&&(c.resume(),c.gotoPage(a,{animationDuration:600}));
A&&y&&(c=b("#immersive-mini li.a-carousel-card"),c.length>0&&(c.removeClass("selected"),c.eq(a-1).addClass("selected")))}}function r(){var a=window,b="inner";"innerWidth"in window||(b="client",a=document.documentElement||document.body);return a[b+"Height"]}function D(){var a=b(".immersive-view-gallery").get(0);if(typeof a!=="undefined")a.ontouchmove=function(a){a.preventDefault()}}function t(){if(z)if(b("#immersive-main img").length>0){u=0;var a=r()-50;b("#immersive-main").css("height",a+"px");b("#immersive-main ol").css("height",
a+"px");b("#immersive-main div.a-carousel-viewport").each(function(){b(this).css("height",a+"px")});b("#immersive-main li.a-carousel-card").each(function(){b(this).css("height",a+"px")});b("#immersive-main img").each(function(){b(this).css("max-height",a+"px")});b("#immersive-main .slate-image-table img").each(function(){b(this).css("max-height",a-65+"px")})}else u<20?(setTimeout(t,50),u++):u=0}var o,A=!1,y=!1,B=!1,w="image-block-immersive-main-carousel",g=b("#landing-image-wrapper").data("includeInGallery")?
1:0,l=1+g,z=!1;m();b(window).bind("orientationchange",function(){a.delay(function(){m();z?f.postCountMetric("dpmob_orientationchangeIV",void 0):f.postCountMetric("dpmob_orientationchangePV",void 0);window.scroll(0,0)},200)});a.on("image-block-immersive-view-refresh",function(){g=b("#landing-image-wrapper").data("includeInGallery")?1:0;l=1+g;B=y=A=z=!1;m()});var u=0;a.on("a:carousel:image-block-immersive-main-carousel:init",function(d){function i(){k.when("a-immersive-image").execute(function(d){var c=
n.dom.$carousel.find("li");a.delay(function(){c.find(".a-immersive-image img").each(function(){d.zoomOut(b(this))})},200)});n.resume()}y=!0;c.updateStateForAction(b("#immersive-main"),l-g,{contextName:"ImmersiveView",embeddedCallback:j,instance:o});s(l-g);var n=d.carousel;a.on("a:popover:afterSlide:immersive-view",function(a){a.popover.getContent().css("display","");n.resize()});t();b(window).bind("orientationchange",function(){i();a.delay(function(){t()},200)});a.on("a:popover:beforeSlideOut:immersive-view",
function(){i()});k.when("a-immersive-image").execute(function(){a.on("a:immersiveImage:zoomIn",function(){z&&f.postCountMetric("dpmob_zoomInvokedIV",void 0);n.pause()});a.on("a:immersiveImage:zoomOut",function(){n.resume()})})});a.on("a:carousel:image-block-immersive-mini-carousel:init",function(d){A=!0;s(l-g);b(".mini_carousel").delegate("li","click",function(){f.postCountMetric("dpmob_thumbnailClicked",void 0);l=b(this).index()+1+g;s(l-g)});var c=d.carousel;a.on("a:popover:afterSlide:immersive-view",
function(a){a.popover.getContent().css("display","");c.resize()})});a.on("a:carousel:image-block-immersive-main-carousel:change:pageNumber",function(d){o&&o.isFullScreen()?c.setShouldDetachOnExitFullScreen(!0):(f.postCountMetric("dpmob_secondaryViewImageChanged",void 0),c._detachAiryInstance(o),d.oldValue!==d.newValue&&(l=d.newValue+g,s(l-g),c.updateStateForAction(b("#immersive-main"),l-g,{contextName:"ImmersiveView",embeddedCallback:j,instance:o}),k.when("a-immersive-image").execute(function(b){var c=
d.carousel.dom.$carousel.find("li").eq(d.oldValue-1).find(".a-immersive-image img");a.delay(function(){b.zoomOut(c)},200)})))});a.on("a:popover:beforeSlideOut:immersive-view",function(){z=!1;var a=i("image-block-carousel");typeof a!=="undefined"&&a.gotoPage(l)});a.on("a:popover:afterSlideOut:immersive-view",function(a){c._detachAiryInstance(o);a.popover.getContent().css("display","none")});a.on("a:popover:beforeSlide:immersive-view",function(b){b.popover.$popover.addClass("immersive-view-gallery");
z=!0;b=i("image-block-carousel");a.delay(function(){t()},200);typeof b!=="undefined"&&(l=Math.max(1+g,b.getAttr("pageNumber")));s(l-g)});a.on("a:popover:afterSlide:immersive-view",function(){E.initializeAll();D();B||(a.loadImageManually(b(".immersive-carousel-img-manual-load")),B=!0)})});k.when("A","jQuery","a-immersive-image").execute(function(a){a.on("a:immersiveImage:zoomIn",function(a){a.$image.closest(".a-gesture-horizontal").removeClass("a-gesture-horizontal")});a.on("a:immersiveImage:zoomOut",
function(a){a.$image.closest(".a-carousel-viewport").addClass("a-gesture-horizontal")})});k.when("A","jQuery","postMetric","atf").register("ImageBlock360",function(a,b,k){var c,f,m,j,i,s,r,D;function t(a,b,e,c){b=b?("transform"!==Q("transform")?"-webkit-":"")+"transform "+(e||0.5)+"s "+(c||"ease-out"):"none";a.css(Q("transition"),b);a.parent().css(Q("transition"),b)}function o(a,b,e,c){b="translate("+b+"px, "+e+"px)";a.css(Q("transform"),"scale("+c+")");a.parent().css(Q("transform"),b)}function A(a,
b,e,d){var g=a.innerWidth()/2,h=a.innerHeight()/2,b=y(a,(g-b)*d,(h-e)*d,d);c=b.x;f=b.y;m=d;o(a,c,f,d)}function y(a,b,e,c){var d=a.innerWidth()*(c-1)/2,a=a.innerHeight()*(c-1)/2,c=b&&b/Math.abs(b),f=e&&e/Math.abs(e),g=Math.abs(b)>d?d*c:b,h=Math.abs(e)>a?a*f:e;return{x:g,y:h,boundX:Math.abs(b)>d,boundY:Math.abs(e)>a,signX:c,signY:f}}function B(b,e,c){j&&(o(b,0,0,1),t(b,e,sa),i=!0,m=1,a.delay(function(){b.css("-webkit-backface-visibility","hidden");H.addClass("a-hidden");c&&(j=i=!1)},600))}function w(b,
e,c,d){if(!j){var f=G[""+S/5+",0"];H.attr("onload",ha);H.attr("src",f);b.css("-webkit-backface-visibility","visible");t(b,!0,ta);A(b,e,c,ua);i=!0;a.delay(function(){d&&(i=!1,j=!0)},600)}}function g(){var a=window,b="inner";"innerWidth"in window||(b="client",a=document.documentElement||document.body);return a[b+"Height"]}function l(){var a=g()-72;ia.css("height",a+"px")}function z(a,b){var e=a[0].pageX-b.left,c=a[0].pageY-b.top,d=a[1].pageX-b.left,f=a[1].pageY-b.top;return{midX:(e+d)/2,midY:(c+f)/
2,distance:Math.sqrt(Math.pow(e-d,2)+Math.pow(c-f,2))}}var u,d,p,n,I,G,J,C,v,e,x,F,h,R,L,Y,Z,ga,$,aa,ba,M,S,T,N=[],q,ia,ca,H,U,V,K;j=!1;c=0;f=0;m=1;s=0;r=!1;D=void 0;i=void 0;var ja=!1,ka=!1,ua=3,Q=a.prefixes.getStyle,ta=0.6,sa=0.3,la,da=function(){F=0;W();U.animate({top:"0px"},200,"easeInBack");V.animate({top:"0px"},200,"easeInBack");t(q,!0,0.2,"ease-in");o(q,0,0,1);q.animate({opacity:"1"},200,"easeInBack")},va=function(){ca.addClass("a-hidden");q.removeClass("a-hidden");ja=!0;ka&&da()},ha=function(){H.css({width:C+
"px",height:v+"px"});var a=ea(T);H.css({top:-1*a.top+"px",left:-1*a.left+"px"});H.removeClass("a-hidden")},ma=function(){var a=g()-72,b=window,e="inner";"innerWidth"in window||(e="client",b=document.documentElement||document.body);b=b[e+"Width"]-28;p/n/(b/a)>=1?(C=b,v=Math.round(n/p*C)):(v=a,C=Math.round(p/n*v));q.css({width:C+"px",height:v+"px"});K.css("width",C*I+"px")},wa=function(){b.extend(b.easing,{easeInBack:function(a,b,e,c,d,f){f===void 0&&(f=1.70158);return c*(b/=d)*b*((f+1)*b-f)+e}})},
xa=function(a,c){var d=b("<img />");K.append(d);d.get(0).onload=c;d.attr("src",e[a])},fa=function(a,b){a>0&&M<e.length?xa(M,function(){N=N.concat(x[M]);M++;fa(a-1,b)}):b!==null&&b!==void 0&&typeof b==="function"&&b()},ea=function(a){for(var b=0,e=0,c=0;c<x.length;c++){if(a<x[c].length){e=a;break}a-=x[c].length;b++}return{left:-1*e*C,top:-1*b*v}},na=function(a,b){K.css("-webkit-transform","translate3d("+b+"px, "+a+"px,0)");K.css("transform","translate3d("+b+"px, "+a+"px,0)")},W=function(){for(;F<0;)F+=
360;for(;F>360;)F-=360;for(var a,b=360,e=0;e<N.length;e++){var c=Math.abs(F-N[e]);c<b&&(b=c,a=e)}S=N[a];T=a;a=ea(a);na(a.top,a.left)},X=function(){H.attr("src",G[""+S/5+",0"])},pa=function(a,b,e){j||i||r?oa(a,b):(O(a,b),F-=b.deltaX/C*180,W(),b.ended&&!e&&X())},ya=function(a,b){j||i||r?oa(a,b):(O(a,b),pa(a,b,!0),h=b.touchDeltaX/b.touchDuration,R=Math.abs(h)*700,L=h*0.8,R=Math.min(R,2E3),L=h>0?Math.min(L,0.8):Math.max(L,-0.8),ba=0,ga=Z=Date.now(),$=window.setTimeout(qa,20))},qa=function(){var a=Date.now(),
b=a-Z;ba+=b;Z=a;a=ba/R;a=Math.min(a,1);h=(1-(1-Math.pow(1-a,2)))*L;F-=h*b/C*180;W();a<1?$=window.setTimeout(qa,20):X()},O=function(a){Date.now()-ga>100&&(L=0,window.clearTimeout($),a.type==="tap"&&X());clearTimeout(aa)},za=function(a,b){O(a,b);i||(j||(X(),k.postCountMetric("dpmob_zoomInvoked360")),j?B(q,!0,!0):w(q,b.targetX,b.targetY,!0))},oa=function(a,b){if(j&&!i){var e=q,d=b.ended,g=y(e,c+b.deltaX,f+b.deltaY,m);c=g.x;f=g.y;t(e,d);o(e,c,f,m)}},Aa=function(a){O(a);var b=a.originalEvent.targetTouches;
b.length===2&&(D=z(b,q.offset()),a.stopImmediatePropagation(),a.preventDefault())},Ba=function(a){var b=a.originalEvent.targetTouches;if(b.length===2&&(b=z(b,q.offset()),D)){r=!0;var e=b.distance-D.distance;s+=Math.abs(e);s>4&&!i&&(e<0?B(q,!0,!1):w(q,b.midX,b.midY,!1));a.stopImmediatePropagation();a.preventDefault()}},Ca=function(a){r&&a.originalEvent.targetTouches.length===0&&(s=0,r=!1,j=m>1,i=!1);a.preventDefault()},ra=function(){Y+=7.5;F-=7.5;W();Y<360&&(aa=setTimeout(ra,20))},Da=function(a,b){!j&&
!i&&!r&&(k.postCountMetric("dpmob_autoSpinInvoked"),O(a,b),Y=0,aa=setTimeout(ra,20))},Ea=function(){a.on("a:popover:beforeShow:view-360",function(){(j||i||r)&&B(q,!1,!0);fa(e.length-M);k.postCountMetric("dpmob_clickOn360Button")});b(window).bind("orientationchange",function(){a.delay(function(){l();ma();var a=ea(T);na(a.top,a.left);(j||i||r)&&ha();window.scroll(0,0)},400)});a.on("a:popover:afterSlide:view-360",function(){ka=!0;ja?J?a.delay(da,500):da():ca.removeClass("a-hidden")});a.on("a:popover:beforeHide:view-360",
function(){U.animate({top:"-60px"},200,"easeInBack");V.animate({top:"-60px"},200,"easeInBack");t(q,!0,0.2,"ease-in");o(q,0,0,0.8);q.animate({opacity:"0"},200,"easeInBack")})};return{init:function(a){u=a.spriteURLsFor360;d=a.dynamicImageLocationsFor360;p=a.image360Width;n=a.image360Height;I=a.imagesInSprite;G=a.fullImageURLs;q=b("#image-360");b("#image-block-360-button");ia=b("#main-360");K=b("#image-sprites");ca=b("#view-360-loader");U=b("#view-360-back");V=b("#view-360-icon-wrapper");J=U.length>
0?!1:!0;F=T=S=M=0;N=[];K.empty();K.append("<img id='zoom-360' class='a-hidden' />");H=b("#zoom-360");wa();ma();e=[];for(a=0;a<u.length;a++){var c=u[a],f=Math.round(1.5*C),g=Math.round(1.5*v),c=c.replace(/(\._SP)\d+(,)\d+/,"$1"+f+"$2"+g);e.push(c)}x=[];for(a=0;a<d.length;a++){c=d[a];f=[];for(g=0;g<c.length;g++){var h=parseInt(c[g].split(",")[0],10)*5;f.push(h)}x.push(f)}l();q.bind("swipe",ya);q.bind("pan",pa);q.bind("tap",O);q.bind("doubleTap",za);q.bind("touchstart",Aa);q.bind("touchmove",Ba);q.bind("touchend touchleave touchcancel",
Ca);V.bind("touchstart",Da);la||(la=!0,Ea());fa(1,va)}}});k.when("A","jQuery","atf").register("ImageBlock360Peek",function(a,b){function E(){var a=A.height();t.css("height",a+"px")}var c,f,m,j,i,s,r,D,t,o,A,y,B,w,g,l,z=function(){var a=Math.round(1.5*w),b=Math.round(1.5*g);f=c.replace(/(\._SP)\d+(,)\d+/,"$1"+a+"$2"+b)},u=function(){var a=A.height(),b=A.width();m/j/(b/a)>=1?(w=b,g=Math.round(j/m*w)):(g=a,w=Math.round(m/j*g));t.css({width:w+"px",height:g+"px"});o.css("width",w*i+"px")},d=function(a){var c=
b("<img />");c.get(0).onload=function(){b("#main-image").remove();o.append(c);a&&typeof a==="function"&&a()};c.attr("src",f)},p=function(a){var b=0,c=1;return function(){var d=b;return d>=0?(b===a&&(c=-1),b+=c,d):null}},n=function(b){r===null?(r=b,a.requestAnimationFrame(n)):b-r>70?(r=b,b=D(),b!==null&&(I(b),s=b,a.requestAnimationFrame(n))):a.requestAnimationFrame(n)},I=function(a){o.css("-webkit-transform","translate3d("+-1*a*w+"px,0,0)");o.css("transform","translate3d("+-1*a*w+"px,0,0)")},G=function(){a.delay(function(){E();
u();I(s)},400)},J=function(a){k.when("postMetric").execute(function(b){b.postCountMetric(a)})},C=function(){J("dpmob_touchEndOn360Badge")},v=function(){J("dpmob_touchEndOnViewGalleryButton")};return{init:function(e){c=e.spriteURLForPeek360;m=e.image360Width;j=e.image360Height;i=e.imagesInPeekSprite;t=b("#carousel-main-image-360");y=b("#badge360");B=b("#image-block-360-button");o=b("#carousel-main-image-sprites");A=b("#landing-image-wrapper");s=0;u();z();E();l||(l=!0,b(window).bind("orientationchange",
G),a.on("a:popover:afterHide:view-360",G),a.on("a:popover:afterHide:immersive-view",G));y.bind("touchend",C);B.bind("touchend",v);d(function(){r=null;D=p(i-1);setTimeout(function(){a.requestAnimationFrame(n)},300)})}}});k.when("A","a-carousel-framework","postMetric","image-block-exp-weblab").execute(function(a,b,k,c){a.on("a:carousel:image-block-carousel:init",function(b){var m=b.carousel,j=a.$("#image-arrow-left"),i=a.$("#image-arrow-right"),b=a.$("#video-play-circle");m.getAttr("set_size")>1&&i.removeClass("image-arrow-invisible");
var s=function(a){return typeof a!=="undefined"},r=s(c.isEnhancedAltImageDiscoveryTreatmentTwo)&&c.isEnhancedAltImageDiscoveryTreatmentTwo(),D=function(a){var a=a.newValue,b=m.getAttr("set_size");r===!0&&(a===1?(j.addClass("image-arrow-invisible"),i.removeClass("image-arrow-invisible")):a===b?(j.removeClass("image-arrow-invisible"),i.addClass("image-arrow-invisible")):(j.removeClass("image-arrow-invisible"),i.removeClass("image-arrow-invisible")))},t=function(a){m.gotoNextPage();a.$event.preventDefault();
k.postCountMetric("AltImageRightArrowClick")},o=function(a){m.gotoPrevPage();a.$event.preventDefault();k.postCountMetric("AltImageLeftArrowClick")},A=function(a){var b=a.data.firstVideoIndex;s(b)&&m.gotoIndex(b);a.$event.preventDefault();k.postCountMetric("AltImageVideoIndicatorClick")};s(b)&&b.removeClass("image-arrow-invisible");r===!0&&(a.declarative("image-block-arrow-left-touch",["touchstart"],o),a.declarative("image-block-arrow-right-touch",["touchstart"],t),a.declarative("image-block-video-indicator-touch",
["touchstart"],A),a.on("a:carousel:image-block-carousel:change:pageNumber",D))})})})})(function(){var k=window.AmazonUIPageJS||P,a=k.attributeErrors;return a?a("DetailPagePhoneImageBlockAssets"):k}());
/* ******** */
(function(e){e.execute(function(){e.when("jQuery","A").execute(function(d){function b(){var b=d("#aboutThisItem_boxGroup > div"),a,g;d.each(b,function(d,f){var b;b=f.firstChild.firstChild;b=!b||!b.innerHTML||/^\s*$/.test(b.innerHTML)?!0:!1;f.className=c+" a-hidden";if(!b)f.className=c,a||(a=f),g=f});if(a&&g)a===g?g.className=c+" a-first a-last":(a.className=c+" a-first",g.className=c+" a-last")}var c="a-box a-spacing-none a-feature";e.register("aboutThisItemDecorator",function(){return{decorate:function(){b()}}})});
e.when("atf").execute(function(){var d=window.document,b=d.getElementById("main-image"),d=d.getElementById("aplus-glance-img");b&&d&&d.setAttribute("src",b.getAttribute("src"))});e.when("jQuery","A","a-popover-base","a-popover-ajax").execute(function(d,b){function c(b,a){b&&a&&a.find("a").each(function(a,d){var f=d.href;if(f&&f.match(/.*\/[A-Z0-9]{10}\/.*/)){var f=f.split(/\/[A-Z0-9]{10}\//),f=f[0]+"/"+b+"/"+f[1],c=/([?|&])vs=.*?(&|$)/i,e=f.indexOf("?")!==-1?"&":"?",f=f.match(c)?f.replace(c,"$1vs=1$2"):
f+e+"vs=1";d.href=f}})}b.on("a:popover:beforeShow:dpSecondaryViewAction",function(c){var c=c.popover,a=c.data,g=a.secViewId,a=a.useStateData?b.state(g).data:d("#"+g).html();c.update(a)});e.register("updateSecondaryViewLinks",function(){return{updateLinks:function(){var e=b.state("twister-selection-state").currentAsin;c(e,d("#tellAFriendBox_feature_div"));c(e,d("#customerReviews_feature_Div"))}}})});e.when("jQuery","jumpLink").execute(function(d,b){window.isACRJumpLinkEnabled===1?b.bind("#acrCustomerReviewLink",
10,0):window.isACRJumpLinkEnabled===2?b.bind("#acrCustomerReviewLink",600,0):window.isACRJumpLinkEnabled===3?b.bind("#acrCustomerReviewLink",850,0):window.isACRJumpLinkEnabled===4&&b.bind("#acrCustomerReviewLink",1100,0)});e.when("A","jQuery").register("dpmob-sec-view-instrumentation",function(d,b){var c={},e=function(a){var b;a in c&&(b="dpmob-sec-"+a+c[a]);return b};return{recordClickTime:function(a){if(typeof a!=="undefined"){var b=1;a in c&&(b=c[a]+1);c[a]=b;typeof window.uet==="function"&&window.uet("tc",
"dpmob-sec-"+a+b)}},recordEndTime:function(a){typeof a!=="undefined"&&(a=e(a),typeof a!=="undefined"&&typeof window.ues==="function"&&(window.ues("t0",a,new Date),window.ues("ctb",a,"1")))},postMetrics:function(a){if(typeof a!=="undefined"){var c=e(a);typeof c!=="undefined"&&(b.ajax({url:"/gp/product/mobile/secondary-view/ajax-measurement.html?featureName="+a,dataType:"text",timeout:4E4,error:function(){},success:function(a){typeof window.ues==="function"&&typeof window.uet==="function"&&typeof window.uex===
"function"&&(window.ues("id",c,a),window.uet("be",c),window.uex("ld",c))}}),this.addCount("dpmob-sec-"+a,1),this.addCount(c,1))}},addCount:function(a,b){var c=window.ue,d=c.count(a)||0;c.count(a,d+b)}}})})})(function(){var e=window.AmazonUIPageJS||P,d=e.attributeErrors;return d?d("DetailPagePhoneProductInfoAssets"):e}());
/* ******** */
(function(a){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("HLCXDetailPageAssets"):a}(),window);
/* ******** */
(function(b){b.execute(function(){b.when("A","preventMulticlick:forceFormSubmit","ready").execute(function(a,c){var b=function(b){var e=a.$(document),f=!1;e&&e.delegate(b,"click",function(){var d=a.$(b);return!d?!0:f?(d.attr("disabled",!0),!1):(c(d),f=!0,setTimeout(function(){f=!1;d.attr("disabled",!1)},3E4),!0)})};b("#one-click-button");b("#oneClickBuyButton");b("#prime-toggle-main")});b.when("A","ready").register("preventMulticlick:forceFormSubmit",function(){return function(a){a&&a.jquery&&a.closest("form").submit()}})})})(function(){var b=
window.AmazonUIPageJS||P,a=b.attributeErrors;return a?a("DetailPageOffersMulticlickAssets"):b}());
(function(b){b.execute(function(){b.when("A","ready").execute(function(a){function c(){d?f?window.location="amznapp://page/?app-action=refresh":d.navstack.begin().back().forward(window.location.href,"GET",{}).end():window.location.replace(h)}var e=a.state("emwaData");if(e)var h=e.detailPageUrl,g=e.subscriptionUrl,f=e.isRefresh==="true";var d;b.when("aw-mash").execute(function(a){d=a});a.declarative("emwa-sign-up",["click"],function(b){e&&a.get(g,{params:b.data,success:c,error:c})})})})})(function(){var b=
window.AmazonUIPageJS||P,a=b.attributeErrors;return a?a("DetailPageOffersEmwaAssets"):b}());
(function(b){b.execute(function(){b.when("A").execute(function(a){a.$(window).load(function(){var c;c=a.$(document.body);c!=="undefined"&&c.attr("expandPage")==="pullPageUp"&&c.css("marginBottom","60px")})});b.when("A","ready").execute(function(a){a.on("a:accordion:buybox-accordion:select",function(c){a.$("#buyBoxAccordion").find(".accordion-header span.header-price").removeClass("a-color-price").addClass("a-color-secondary");a.$(c.selectedRow.$row).find(".accordion-header span.header-price").removeClass("a-color-secondary").addClass("a-color-price");
a.$("#buyBoxAccordion").find(".accordion-header i.header-prime-logo").addClass("opacity-50");a.$(c.selectedRow.$row).find(".accordion-header i.header-prime-logo").removeClass("opacity-50")})});b.when("A","mash").execute(function(a,c){function b(a){function d(a){c.houdini.cart.addItem({asin:a.inputs.a,offerId:a.inputs.oid,qid:a.inputs["log-qid"],sr:a.inputs["log-sr"],ref:"mw_pa_dp_buy_crt"})}a.requiresSignIn?c.showLoginDialog({successCallback:function(){d(a)}}):d(a)}var h=a.$;h("body");var g={"add-to-cart":function(a){b(a)}};
a.declarative("aw-mash-asap",["click"],function(a){typeof a==="object"&&typeof a.data==="object"&&typeof a.data.buttonID==="string"&&typeof g[a.data.buttonID]==="function"&&g[a.data.buttonID](a.data)})});b.when("A").execute(function(a){var b=window.ue;a.declarative("web-atc","click",function(){typeof b!=="undefined"&&typeof b.count!=="undefined"&&b.count("mobWebATCButtonClickCount",(b.count("mobWebATCButtonClickCount")||0)+1)});a.declarative("app-atc","click",function(){typeof b!=="undefined"&&typeof b.count!==
"undefined"&&b.count("mobAppATCButtonClickCount",(b.count("mobAppATCButtonClickCount")||0)+1)});a.declarative("web-bnb","click",function(){typeof b!=="undefined"&&typeof b.count!=="undefined"&&b.count("mobWebBuyNowButtonClickCount",(b.count("mobWebBuyNowButtonClickCount")||0)+1)});a.declarative("app-bnb","click",function(){typeof b!=="undefined"&&typeof b.count!=="undefined"&&b.count("mobAppBuyNowCButtonClickCount",(b.count("mobAppBuyNowButtonClickCount")||0)+1)})})})})(function(){var b=window.AmazonUIPageJS||
P,a=b.attributeErrors;return a?a("DetailPagePhoneOffersAssets"):b}());
/* ******** */
(function(h,n,i){h.execute(function(){h.when("A","a-secondary-view","cf").register("atwl",function(b,c){function d(a){a===null||a.detail===null||a.detail.sheetMenu===null||a.detail.sheetMenu.wishlistID===null||a.detail.sheetMenu.wishlistType===null||document.hidden||q(a.detail.sheetMenu.wishlistID,a.detail.sheetMenu.wishlistType,!0)}function f(a){a.addEventListener!==i&&a.addEventListener("wishlist.AddToListFromNativeBottomSheet",d)}function g(a){b.state("atwl",e.extend(b.state("atwl")||{},a))}function m(){var a=
b.state("atwl")||{};if(a&&a.isResponseSuccess&&a.registryId&&a.registryType){e("#atwl-error-message").closest(".a-alert-inline-error").addClass("a-hidden").hide();e("#atwl-changeover").show();e("#atwl-listtype").val(a.registryType);e("#atwl-privacy").css({"padding-left":"5px"}).text(a.registryPrivacy);var c="",c=o?"&registryID=":"&lid=",l=e("#wishlistButtonViewStack").attr("href");l!==i&&l.match(/lid=/)===null&&l.match(/ty=/)===null&&(l=l+c+a.registryId+"&ty="+a.registryType,e("#wishlistButtonViewStack").attr("href",
l));e("#wishlistButtonStack").addClass("a-hidden");e("#wishlistButtonViewStack").removeClass("a-hidden");l=e("#persistentShellWishlistButtonViewStack").find("a").attr("href");l!==i&&l.match(/lid=/)===null&&l.match(/ty=/)===null&&(l=l+c+a.registryId+"&ty="+a.registryType,e("#persistentShellWishlistButtonViewStack").attr("href",l));e("#persistentShellWishListButtonStack").addClass("a-hidden");e("#persistentShellWishlistButtonViewStack").removeClass("a-hidden");b.trigger("atwl:mash:dispatchEvent",{eventType:"wishlist.ListUpdated",
listId:a.registryId})}}function j(a){a&&a.message&&a.message.length>0&&e("#atwl-error-message").text(a.message);!o&&c&&c.get("atwl_secondary_view")?c.get("atwl_secondary_view").hide():b.trigger("atwl:mash:goback");e("#atwl-error-message").closest(".a-alert-inline-error").removeClass("a-hidden").show()}function h(a){var c={},a=a.find(":input");b.each(a,function(a){var m=b.$(a);a.name&&(c[a.name]=m.val())});return c}function r(){k=!0;setTimeout(function(){k=!1},1E4)}function q(a,f,l){var d=e("#atwl-content"),
d=h(d.find("#atwl-form"));d.type=f;d.registryID=a;d.pcomp=0;d.action="add";e("#atwl-html").hide();e(".a-popover-loading").show();r();b.ajax("/gp/registry/atwl/add.html",{method:"post",params:d,timeout:5E3,success:function(a){k=!1;a&&a.isValid?(e("#atwl-error-message").closest(".a-alert-inline-error").addClass("a-hidden").hide(),g({isResponseSuccess:a.isValid,registryId:a.registryID,registryType:a.registryType,registryPrivacy:a.registryPrivacy}),o?l?m():b.trigger("atwl:mash:goback"):c.get("atwl_secondary_view").hide()):
j(a)},error:function(a){k=!1;j(a)}})}var e=b.$,o=!1;b.on("atwl:mashPresent",function(a){o=!0;f(a.mash);a.mash.addEventListener!==i&&(a.mash.addEventListener("appPause",function(){var b=a.mash;b.removeEventListener!==i&&b.removeEventListener("wishlist.AddToListFromNativeBottomSheet",d)}),a.mash.addEventListener("appResume",function(){f(a.mash)}))});b.on("a:popover:afterHide:atwl_secondary_view",function(){m()});b.on("a:popover:show:atwl_secondary_view",function(a){var c=a.popover.$popover,a=e("#atwl-content"),
a=h(a?a.find("#atwl-form"):{}).sourceVendorId||"other";b.ajax("/gp/registry/atwl/popover.html",{method:"post",params:{type:"wishlist",isMobile:1,ellipsize:20,displayHeader:1,modalView:0,sourceVendorId:a},success:function(a){a&&a.html?(e("#atwl-error-message").closest(".a-alert-inline-error").addClass("a-hidden").hide(),c.find(".a-popover-loading").hide(),c.find("#atwl-css").html(a.css),c.find("#atwl-html").html(a.html).show()):j(a)},error:function(a){j(a)}})});var k=!1;b.declarative("atwl-native-bottom-sheet",
"click",function(){b.trigger("atwl:mash:dispatchEvent",{eventType:"wishlist.ShowNativeBottomSheet"})});b.declarative("atwl-option","click",function(a){a=a.data;a.type===null||a.id===null||k||q(a.id,a.type,!1)});b.declarative("atwl-add-item","click",function(){if(!k){e("#atwl-html").hide();e(".a-popover-loading").show();var a=h(e("#atwl-form"));a.pcomp=0;a.action="add";a.registryID="new";a.type="wishlist";r();b.ajax("/gp/registry/atwl/add.html",{method:"post",params:a,timeout:5E3,success:function(a){k=
!1;a&&a.isValid?(g({isResponseSuccess:a.isValid,registryId:a.registryID,registryType:a.registryType,registryPrivacy:a.registryPrivacy}),m()):j(a)},error:function(a){k=!1;j(a)}})}})});h.when("A","mash","atwl","mash-capabilities").execute(function(b,c,d,f){b.trigger("atwl:mashPresent",{mash:c});b.on("atwl:mash:goback",function(){c.goBack()});b.on("atwl:mash:dispatchEvent",function(b){f.isDispatchEventAvailable()&&c.dispatchEvent({type:b.eventType,detail:{listId:b.listId}})})});h.register("mash-capabilities",
function(){var b;return{isDispatchEventAvailable:function(){if(b!==i)return b;var c;a:{c=document.cookie.split(";");for(var d=0;d<c.length;d++){for(var f=c[d];f.charAt(0)===" ";)f=f.substring(1,f.length);if(f.indexOf("amzn-app-ctxt=")===0){c=f.substring(14,f.length);break a}}c=null}d=0;if(c!==null)try{var g=c.match(/"cp":[0-9]*/);g===null&&(g=decodeURIComponent(c).match(/"cp":[0-9]*/));if(g!==null&&g.length>0){var m=g[0].split(/:/);if(m!==null&&m.length===2){var j=parseInt(m[1],10);d=typeof j==="number"?
j&2048:0}}}catch(h){}return b=d!==0}}});h.when("A","atwr-toast-lib").execute(function(b,c){b.declarative("atwr-action","click",function(b){var g=b.data.atwrAsin,m=b.data.atwrSessionId;if(g&&m&&b.data.atwrHasRegistry)b={},b["asin."+g]="",b.appAction="add",b["session-id"]=m,c.toast(d,b)});var d="/gp/aw/share-reg/ref=app_dp_add_wr"});h.when("A").register("atwr-toast-lib",function(b){function c(b){var c=g("body").width()-f*2,d=b.height(),h=parseInt(b.css("line-height").replace("px",""),10)-1,b=Math.floor(d/
h)*b.width();return b>c?c:b}function d(b){g("#atwrToast").animate({width:c(b)},200,function(){g("#atwrSpinner").hide();b.show();n.setTimeout(function(){g("#atwrToast").fadeOut(200,function(){b.hide();g("#atwrToastCover").hide();g(this).css("width","").removeClass("atwr-message-box-size-spinner").addClass("atwr-message-box-size").show();g("#atwrSpinner").removeClass("atwr-spinner-progress").show()})},1E3)})}var f=30,g=b.$;return{toast:function(c,f){g("#atwrToastCover").show();g("#atwrToast").removeClass("atwr-message-box-size").addClass("atwr-message-box-size-spinner");
g("#atwrSpinner").addClass("atwr-spinner-progress");b.ajax(c,{method:"post",params:f,timeout:5E3,success:function(){d(g("#atwrSuccess"))},failure:function(){d(g("#atwrFailure"))}})}}});h.when("A","b2b-lists-detail-mobile").execute(function(b,c){c.isEnabled()&&(b.on("a:dropdown:selected:quantity",function(b){c.updateQuantity(b.value)}),b.on("a:pageUpdate",function(){c.updateQuantityAndAsin(b.$("#mobileQuantityDropDown").val(),b.$("#a").val())}))});h.when("A","a-secondary-view","ready").register("b2b-lists-detail-mobile",
function(b,c){function d(){return c.get(b.$(g))}function f(b,c,d){var g=RegExp("([?&])"+c+"=.*?(&|$)","i"),f=b;b.match(g)&&(f=b.replace(g,"$1"+c+"="+d+"$2"));return f}var g="#business-list-secondary-view";return{updateQuantity:function(c){b.$(g).length>0&&(c=f(d().attrs("url"),"quantity",c),d().update({url:c}))},updateQuantityAndAsin:function(c,h){if(b.$(g).length>0){var p=f(d().attrs("url"),"quantity",c),p=f(p,"asin",h);d().update({url:p})}},isEnabled:function(){return b.$("#add-business-list-button").length>
0}}})})})(function(){var h=window.AmazonUIPageJS||window.P,n=h._namespace||h.attributeErrors;return n?n("RegistryDPMobileAssets"):h}(),window);
/* ******** */
/*

 build: `node build.js modules=ALL exclude=gestures,cufon,json minifier=uglifyjs
 Fabric.js Copyright 2008-2014, Printio (Juriy Zaytsev, Maxim Chernyak)
*/
(function(D,F,E){D.execute(function(){D.when("A").register("fabric-js",function(l){var j=j||{};if(!l.capabilities.canvas)return{};var f=f||{version:"1.4.12"};if(typeof j!=="undefined")j.fabric=f;typeof document!=="undefined"&&typeof F!=="undefined"?(f.document=document,f.window=F):(f.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),f.window=f.document.createWindow());f.isTouchSupported="ontouchstart"in f.document.documentElement;f.isLikelyNode=typeof Buffer!==
"undefined"&&typeof F==="undefined";f.SHARED_ATTRIBUTES="display,transform,fill,fill-opacity,fill-rule,opacity,stroke,stroke-dasharray,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width".split(",");f.DPI=96;(function(){function e(c,a){if(this.__eventListeners[c])a?f.util.removeFromArray(this.__eventListeners[c],a):this.__eventListeners[c].length=0}function a(c,a){if(!this.__eventListeners)this.__eventListeners={};if(arguments.length===1)for(var g in c)this.on(g,c[g]);else this.__eventListeners[c]||
(this.__eventListeners[c]=[]),this.__eventListeners[c].push(a);return this}function d(c,a){if(this.__eventListeners){if(arguments.length===0)this.__eventListeners={};else if(arguments.length===1&&typeof arguments[0]==="object")for(var g in c)e.call(this,g,c[g]);else e.call(this,c,a);return this}}function b(c,a){if(this.__eventListeners){var g=this.__eventListeners[c];if(g){for(var b=0,d=g.length;b<d;b++)g[b].call(this,a||{});return this}}}f.Observable={observe:a,stopObserving:d,fire:b,on:a,off:d,
trigger:b}})();f.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var e=0,a=arguments.length;e<a;e++)this._onObjectAdded(arguments[e]);this.renderOnAddRemove&&this.renderAll();return this},insertAt:function(e,a,d){var b=this.getObjects();d?b[a]=e:b.splice(a,0,e);this._onObjectAdded(e);this.renderOnAddRemove&&this.renderAll();return this},remove:function(){for(var e=this.getObjects(),a,d=0,b=arguments.length;d<b;d++)a=e.indexOf(arguments[d]),a!==-1&&(e.splice(a,1),this._onObjectRemoved(arguments[d]));
this.renderOnAddRemove&&this.renderAll();return this},forEachObject:function(e,a){for(var d=this.getObjects(),b=d.length;b--;)e.call(a,d[b],b,d);return this},getObjects:function(e){return typeof e==="undefined"?this._objects:this._objects.filter(function(a){return a.type===e})},item:function(e){return this.getObjects()[e]},isEmpty:function(){return this.getObjects().length===0},size:function(){return this.getObjects().length},contains:function(e){return this.getObjects().indexOf(e)>-1},complexity:function(){return this.getObjects().reduce(function(e,
a){e+=a.complexity?a.complexity():0;return e},0)}};(function(e){var a=Math.sqrt,d=Math.atan2,b=Math.PI/180;f.util={removeFromArray:function(c,a){var g=c.indexOf(a);g!==-1&&c.splice(g,1);return c},getRandomInt:function(c,a){return Math.floor(Math.random()*(a-c+1))+c},degreesToRadians:function(c){return c*b},radiansToDegrees:function(c){return c/b},rotatePoint:function(c,a,g){var b=Math.sin(g),g=Math.cos(g);c.subtractEquals(a);return(new f.Point(c.x*g-c.y*b,c.x*b+c.y*g)).addEquals(a)},transformPoint:function(c,
a,g){return g?new f.Point(a[0]*c.x+a[1]*c.y,a[2]*c.x+a[3]*c.y):new f.Point(a[0]*c.x+a[1]*c.y+a[4],a[2]*c.x+a[3]*c.y+a[5])},invertTransform:function(c){var a=c.slice(),a=1/(c[0]*c[3]-c[1]*c[2]),a=[a*c[3],-a*c[1],-a*c[2],a*c[0],0,0],c=f.util.transformPoint({x:c[4],y:c[5]},a);a[4]=-c.x;a[5]=-c.y;return a},toFixed:function(c,a){return parseFloat(Number(c).toFixed(a))},parseUnit:function(c){var a=/\D{0,2}$/.exec(c),c=parseFloat(c);switch(a[0]){case "mm":return c*f.DPI/25.4;case "cm":return c*f.DPI/2.54;
case "in":return c*f.DPI;case "pt":return c*f.DPI/72;case "pc":return c*f.DPI/72*12;default:return c}},falseFunction:function(){return!1},getKlass:function(c,a){c=f.util.string.camelize(c.charAt(0).toUpperCase()+c.slice(1));return f.util.resolveNamespace(a)[c]},resolveNamespace:function(c){if(!c)return f;for(var c=c.split("."),a=c.length,g=e||f.window,b=0;b<a;++b)g=g[c[b]];return g},loadImage:function(c,a,g,b){if(c){var d=f.util.createImage();d.onload=function(){var h;a&&a.call(g,d);h=d.onload=d.onerror=
null,d=h};d.onerror=function(){var h;f.log("Error loading "+d.src);a&&a.call(g,null,!0);h=d.onload=d.onerror=null,d=h};if(c.indexOf("data")!==0&&typeof b!=="undefined")d.crossOrigin=b;d.src=c}else a&&a.call(g,c)},enlivenObjects:function(c,a,g,b){function d(){++n===o&&a&&a(e)}var c=c||[],e=[],n=0,o=c.length;o?c.forEach(function(c,a){if(!c||!c.type)d();else{var h=f.util.getKlass(c.type,g);h.async?h.fromObject(c,function(g,h){h||(e[a]=g,b&&b(c,e[a]));d()}):(e[a]=h.fromObject(c),b&&b(c,e[a]),d())}}):
a&&a(e)},groupSVGElements:function(c,a,g){c=new f.PathGroup(c,a);typeof g!=="undefined"&&c.setSourcePath(g);return c},populateWithProperties:function(c,a,g){if(g&&Object.prototype.toString.call(g)==="[object Array]")for(var b=0,d=g.length;b<d;b++)g[b]in c&&(a[g[b]]=c[g[b]])},drawDashedLine:function(c,b,g,i,e,m){i-=b;var f=e-g,e=a(i*i+f*f),i=d(f,i),f=m.length,o=0,p=!0;c.save();c.translate(b,g);c.moveTo(0,0);c.rotate(i);for(b=0;e>b;)b+=m[o++%f],b>e&&(b=e),c[p?"lineTo":"moveTo"](b,0),p=!p;c.restore()},
createCanvasElement:function(c){c||(c=f.document.createElement("canvas"));!c.getContext&&typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(c);return c},createImage:function(){return f.isLikelyNode?new (require("canvas").Image):f.document.createElement("img")},createAccessors:function(c){for(var c=c.prototype,a=c.stateProperties.length;a--;){var g=c.stateProperties[a],b=g.charAt(0).toUpperCase()+g.slice(1),d="set"+b,b="get"+b;c[b]||(c[b]=new Function('return this.get("'+g+'")'));
c[d]||(c[d]=new Function("value",'return this.set("'+g+'", value)'))}},clipContext:function(c,a){a.save();a.beginPath();c.clipTo(a);a.clip()},multiplyTransformMatrices:function(c,a){for(var g=[[c[0],c[2],c[4]],[c[1],c[3],c[5]],[0,0,1]],b=[[a[0],a[2],a[4]],[a[1],a[3],a[5]],[0,0,1]],d=[],e=0;e<3;e++){d[e]=[];for(var f=0;f<3;f++){for(var o=0,p=0;p<3;p++)o+=g[e][p]*b[p][f];d[e][f]=o}}return[d[0][0],d[1][0],d[0][1],d[1][1],d[0][2],d[1][2]]},getFunctionBody:function(c){return(String(c).match(/function[^{]*\{([\s\S]*)\}/)||
{})[1]},isTransparent:function(c,a,g,b){b>0&&(a>b?a-=b:a=0,g>b?g-=b:g=0);for(var d=!0,c=c.getImageData(a,g,b*2||1,b*2||1),a=3,g=c.data.length;a<g;a+=4)if(d=c.data[a]<=0,d===!1)break;return d}}})(typeof j!=="undefined"?j:this);(function(){function e(g,b,h,e,f,q,x){var G=i.call(arguments);if(c[G])return c[G];var t=Math.PI,C=x*t/180,j=Math.sin(C),C=Math.cos(C),v=0,l=0,h=Math.abs(h),e=Math.abs(e),z=-C*g*0.5-j*b*0.5,s=-C*b*0.5+j*g*0.5,r=h*h,u=e*e,B=s*s,w=z*z,H=r*u-r*B-u*w,I=0;H<0?(r=Math.sqrt(1-H/(r*u)),
h*=r,e*=r):I=(f===q?-1:1)*Math.sqrt(H/(r*B+u*w));B=I*h*s/e;w=-I*e*z/h;I=C*B-j*w+g*0.5;r=j*B+C*w+b*0.5;u=d(1,0,(z-B)/h,(s-w)/e);s=d((z-B)/h,(s-w)/e,(-z-B)/h,(-s-w)/e);q===0&&s>0?s-=2*t:q===1&&s<0&&(s+=2*t);t=Math.ceil(Math.abs(s/t*2));z=[];s/=t;B=8/3*Math.sin(s/4)*Math.sin(s/4)/Math.sin(s/2);w=u+s;for(H=0;H<t;H++)z[H]=a(u,w,C,j,h,e,I,r,B,v,l),v=z[H][4],l=z[H][5],u=w,w+=s;return c[G]=z}function a(c,g,a,b,d,e,f,G,t,C,j){var v=i.call(arguments);if(h[v])return h[v];var l=Math.cos(c),z=Math.sin(c),s=Math.cos(g),
r=Math.sin(g),u=a*d*s-b*e*r+f,B=b*d*s+a*e*r+G;h[v]=[C+t*(-a*d*z-b*e*l),j+t*(-b*d*z+a*e*l),u+t*(a*d*r+b*e*s),B+t*(b*d*r-a*e*s),u,B];return h[v]}function d(c,g,a,b){c=Math.atan2(g,c);a=Math.atan2(b,a);return a>=c?a-c:2*Math.PI-(c-a)}function b(c,a,b,d,h,e,f,G){var t=i.call(arguments);if(g[t])return g[t];var C=Math.sqrt,j=Math.min,v=Math.max,l=Math.abs,z=[],s=[[],[]],r,u,B,w,H;u=6*c-12*b+6*h;r=-3*c+9*b-9*h+3*f;B=3*b-3*c;for(var I=0;I<2;++I)I>0&&(u=6*a-12*d+6*e,r=-3*a+9*d-9*e+3*G,B=3*d-3*a),l(r)<1.0E-12?
l(u)<1.0E-12||(w=-B/u,0<w&&w<1&&z.push(w)):(w=u*u-4*B*r,w<0||(H=C(w),w=(-u+H)/(2*r),0<w&&w<1&&z.push(w),w=(-u-H)/(2*r),0<w&&w<1&&z.push(w)));for(l=C=z.length;C--;)w=z[C],u=1-w,r=u*u*u*c+3*u*u*w*b+3*u*w*w*h+w*w*w*f,s[0][C]=r,r=u*u*u*a+3*u*u*w*d+3*u*w*w*e+w*w*w*G,s[1][C]=r;s[0][l]=c;s[1][l]=a;s[0][l+1]=f;s[1][l+1]=G;j=[{x:j.apply(null,s[0]),y:j.apply(null,s[1])},{x:v.apply(null,s[0]),y:v.apply(null,s[1])}];return g[t]=j}var c={},h={},g={},i=Array.prototype.join;f.util.drawArc=function(c,g,a,b){for(var d=
[[],[],[],[]],b=e(b[5]-g,b[6]-a,b[0],b[1],b[3],b[4],b[2]),h=0,i=b.length;h<i;h++)d[h][0]=b[h][0]+g,d[h][1]=b[h][1]+a,d[h][2]=b[h][2]+g,d[h][3]=b[h][3]+a,d[h][4]=b[h][4]+g,d[h][5]=b[h][5]+a,c.bezierCurveTo.apply(c,d[h])};f.util.getBoundsOfArc=function(c,g,a,d,h,i,f,G,t){for(var C=0,j=0,v=[],l=[],a=e(G-c,t-g,a,d,i,f,h),d=0,h=a.length;d<h;d++)v=b(C,j,a[d][0],a[d][1],a[d][2],a[d][3],a[d][4],a[d][5]),v[0].x+=c,v[0].y+=g,v[1].x+=c,v[1].y+=g,l.push(v[0]),l.push(v[1]),C=a[d][4],j=a[d][5];return l};f.util.getBoundsOfCurve=
b})();(function(){function e(a,b,c){if(a&&a.length!==0){var h=a.length-1,g=b?a[h][b]:a[h];if(b)for(;h--;)c(a[h][b],g)&&(g=a[h][b]);else for(;h--;)c(a[h],g)&&(g=a[h]);return g}}var a=Array.prototype.slice;if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){if(this===void 0||this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(c===0)return-1;var h=0;arguments.length>0&&(h=Number(arguments[1]),h!==h?h=0:h!==0&&h!==Number.POSITIVE_INFINITY&&h!==Number.NEGATIVE_INFINITY&&(h=
(h>0||-1)*Math.floor(Math.abs(h))));if(h>=c)return-1;for(h=h>=0?h:Math.max(c-Math.abs(h),0);h<c;h++)if(h in b&&b[h]===a)return h;return-1};if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){for(var c=0,h=this.length>>>0;c<h;c++)c in this&&a.call(b,this[c],c,this)};if(!Array.prototype.map)Array.prototype.map=function(a,b){for(var c=[],h=0,g=this.length>>>0;h<g;h++)h in this&&(c[h]=a.call(b,this[h],h,this));return c};if(!Array.prototype.every)Array.prototype.every=function(a,b){for(var c=
0,h=this.length>>>0;c<h;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0};if(!Array.prototype.some)Array.prototype.some=function(a,b){for(var c=0,h=this.length>>>0;c<h;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1};if(!Array.prototype.filter)Array.prototype.filter=function(a,b){for(var c=[],h,g=0,i=this.length>>>0;g<i;g++)g in this&&(h=this[g],a.call(b,h,g,this)&&c.push(h));return c};if(!Array.prototype.reduce)Array.prototype.reduce=function(a){var b=this.length>>>0,c=
0,h;if(arguments.length>1)h=arguments[1];else{do{if(c in this){h=this[c++];break}if(++c>=b)throw new TypeError;}while(1)}for(;c<b;c++)c in this&&(h=a.call(null,h,this[c],c,this));return h};f.util.array={invoke:function(d,b){for(var c=a.call(arguments,2),h=[],g=0,i=d.length;g<i;g++)h[g]=c.length?d[g][b].apply(d[g],c):d[g][b].call(d[g]);return h},min:function(a,b){return e(a,b,function(c,a){return c<a})},max:function(a,b){return e(a,b,function(c,a){return c>=a})}}})();(function(){function e(a,d){for(var b in d)a[b]=
d[b];return a}f.util.object={extend:e,clone:function(a){return e({},a)}}})();(function(){if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")};f.util.string={camelize:function(e){return e.replace(/-+(.)?/g,function(a,d){return d?d.toUpperCase():""})},capitalize:function(e,a){return e.charAt(0).toUpperCase()+(a?e.slice(1):e.slice(1).toLowerCase())},escapeXml:function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,
"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})();(function(){var e=Array.prototype.slice,a=Function.prototype.apply,d=function(){};if(!Function.prototype.bind)Function.prototype.bind=function(b){var c=this,h=e.call(arguments,1),g;g=h.length?function(){return a.call(c,this instanceof d?this:b,h.concat(e.call(arguments)))}:function(){return a.call(c,this instanceof d?this:b,arguments)};d.prototype=this.prototype;g.prototype=new d;return g}})();(function(){function e(){}function a(c){var a=
this.constructor.superclass.prototype[c];return arguments.length>1?a.apply(this,d.call(arguments,1)):a.call(this)}var d=Array.prototype.slice,b=function(){},c=function(){for(var c in{toString:1})if(c==="toString")return!1;return!0}(),h=function(g,a,b){for(var d in a)if(g.prototype[d]=d in g.prototype&&typeof g.prototype[d]==="function"&&(a[d]+"").indexOf("callSuper")>-1?function(c){return function(){var g=this.constructor.superclass;this.constructor.superclass=b;var d=a[c].apply(this,arguments);this.constructor.superclass=
g;if(c!=="initialize")return d}}(d):a[d],c){if(a.toString!==Object.prototype.toString)g.prototype.toString=a.toString;if(a.valueOf!==Object.prototype.valueOf)g.prototype.valueOf=a.valueOf}};f.util.createClass=function(){function c(){this.initialize.apply(this,arguments)}var i=null,k=d.call(arguments,0);typeof k[0]==="function"&&(i=k.shift());c.superclass=i;c.subclasses=[];if(i)e.prototype=i.prototype,c.prototype=new e,i.subclasses.push(c);for(var m=0,f=k.length;m<f;m++)h(c,k[m],i);if(!c.prototype.initialize)c.prototype.initialize=
b;c.prototype.constructor=c;c.prototype.callSuper=a;return c}})();(function(){function e(c){var g=Array.prototype.slice.call(arguments,1),a,b,d=g.length;for(b=0;b<d;b++)if(a=typeof c[g[b]],!/^(?:function|object|unknown)$/.test(a))return!1;return!0}function a(g,a){return function(b){a.call(c(g),b||f.window.event)}}function d(c,g){return function(a){if(n[c]&&n[c][g])for(var b=n[c][g],d=0,h=b.length;d<h;d++)b[d].call(this,a||f.window.event)}}function b(c,g,a){var b=c.type==="touchend"?"changedTouches":
"touches";return c[b]&&c[b][0]?c[b][0][g]-(c[b][0][g]-c[b][0][a])||c[a]:c[a]}var c,h,g=function(){var c=0;return function(g){return g.__uniqueID||(g.__uniqueID="uniqueID__"+c++)}}();(function(){var g={};c=function(c){return g[c]};h=function(c,a){g[c]=a}})();var i=e(f.document.documentElement,"addEventListener","removeEventListener")&&e(f.window,"addEventListener","removeEventListener"),k=e(f.document.documentElement,"attachEvent","detachEvent")&&e(f.window,"attachEvent","detachEvent"),m={},n={};i?
(i=function(c,g,a){c.addEventListener(g,a,!1)},k=function(c,g,a){c.removeEventListener(g,a,!1)}):k?(i=function(c,b,d){var i=g(c);h(i,c);m[i]||(m[i]={});m[i][b]||(m[i][b]=[]);d={handler:d,wrappedHandler:a(i,d)};m[i][b].push(d);c.attachEvent("on"+b,d.wrappedHandler)},k=function(c,a,b){var d=g(c),h;if(m[d]&&m[d][a])for(var i=0,e=m[d][a].length;i<e;i++)if((h=m[d][a][i])&&h.handler===b)c.detachEvent("on"+a,h.wrappedHandler),m[d][a][i]=null}):(i=function(c,a,b){var h=g(c);n[h]||(n[h]={});if(!n[h][a]){n[h][a]=
[];var i=c["on"+a];i&&n[h][a].push(i);c["on"+a]=d(h,a)}n[h][a].push(b)},k=function(c,a,b){c=g(c);if(n[c]&&n[c][a])for(var a=n[c][a],c=0,d=a.length;c<d;c++)a[c]===b&&a.splice(c,1)});f.util.addListener=i;f.util.removeListener=k;var o=function(c){return typeof c.clientX!=="unknown"?c.clientX:0},p=function(c){return typeof c.clientY!=="unknown"?c.clientY:0};f.isTouchSupported&&(o=function(c){return b(c,"pageX","clientX")},p=function(c){return b(c,"pageY","clientY")});f.util.getPointer=function(c,g){c||
(c=f.window.event);var a=f.util.getScrollLeftTop(c.target||(typeof c.srcElement!=="unknown"?c.srcElement:null),g);return{x:o(c)+a.left,y:p(c)+a.top}};f.util.object.extend(f.util,f.Observable)})();(function(){var e=f.document.createElement("div"),a=typeof e.style.filter==="string",d=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,b=function(c){return c};typeof e.style.opacity==="string"?b=function(c,a){c.style.opacity=a;return c}:a&&(b=function(c,a){var g=c.style;if(c.currentStyle&&!c.currentStyle.hasLayout)g.zoom=
1;d.test(g.filter)?g.filter=g.filter.replace(d,a>=0.9999?"":"alpha(opacity="+a*100+")"):g.filter+=" alpha(opacity="+a*100+")";return c});f.util.setStyle=function(c,a){var g=c.style;if(!g)return c;if(typeof a==="string")return c.style.cssText+=";"+a,a.indexOf("opacity")>-1?b(c,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):c;for(var d in a)d==="opacity"?b(c,a[d]):g[d==="float"||d==="cssFloat"?typeof g.styleFloat==="undefined"?"cssFloat":"styleFloat":d]=a[d];return c}})();(function(){function e(c,a){var b=f.document.createElement(c),
d;for(d in a)d==="class"?b.className=a[d]:d==="for"?b.htmlFor=a[d]:b.setAttribute(d,a[d]);return b}var a=Array.prototype.slice,d,b=function(c){return a.call(c,0)};try{d=b(f.document.childNodes)instanceof Array}catch(c){}d||(b=function(c){for(var a=Array(c.length),b=c.length;b--;)a[b]=c[b];return a});var h;h=f.document.defaultView&&f.document.defaultView.getComputedStyle?function(c,a){var b=f.document.defaultView.getComputedStyle(c,null);return b?b[a]:E}:function(c,a){var b=c.style[a];!b&&c.currentStyle&&
(b=c.currentStyle[a]);return b};(function(){var c=f.document.documentElement.style,a="userSelect"in c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in c?"KhtmlUserSelect":"";f.util.makeElementUnselectable=function(c){if(typeof c.onselectstart!=="undefined")c.onselectstart=f.util.falseFunction;if(a)c.style[a]="none";else if(typeof c.unselectable==="string")c.unselectable="on";return c};f.util.makeElementSelectable=function(c){if(typeof c.onselectstart!==
"undefined")c.onselectstart=null;if(a)c.style[a]="";else if(typeof c.unselectable==="string")c.unselectable="";return c}})();(function(){f.util.getScript=function(c,a){var b=f.document.getElementsByTagName("head")[0],d=f.document.createElement("script"),h=!0;d.onload=d.onreadystatechange=function(c){var g;if(h&&!(typeof this.readyState==="string"&&this.readyState!=="loaded"&&this.readyState!=="complete"))h=!1,a(c||f.window.event),g=d.onload=d.onreadystatechange=null,d=g};d.src=c;b.appendChild(d)}})();
f.util.getById=function(c){return typeof c==="string"?f.document.getElementById(c):c};f.util.toArray=b;f.util.makeElement=e;f.util.addClass=function(c,a){c&&(" "+c.className+" ").indexOf(" "+a+" ")===-1&&(c.className+=(c.className?" ":"")+a)};f.util.wrapElement=function(c,a,b){typeof a==="string"&&(a=e(a,b));c.parentNode&&c.parentNode.replaceChild(a,c);a.appendChild(c);return a};f.util.getScrollLeftTop=function(c,a){var b,d,h=0,e=0,p=f.document.documentElement,q=f.document.body||{scrollLeft:0,scrollTop:0};
for(d=c;c&&c.parentNode&&!b;)c=c.parentNode,c.nodeType===1&&f.util.getElementStyle(c,"position")==="fixed"&&(b=c),c.nodeType===1&&d!==a&&f.util.getElementStyle(c,"position")==="absolute"?e=h=0:c===f.document?(h=q.scrollLeft||p.scrollLeft||0,e=q.scrollTop||p.scrollTop||0):(h+=c.scrollLeft||0,e+=c.scrollTop||0);return{left:h,top:e}};f.util.getElementOffset=function(c){var a;a=c&&c.ownerDocument;var b={left:0,top:0},d={left:0,top:0},e={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};
if(!a)return{left:0,top:0};for(var o in e)d[e[o]]+=parseInt(h(c,o),10)||0;a=a.documentElement;typeof c.getBoundingClientRect!=="undefined"&&(b=c.getBoundingClientRect());c=f.util.getScrollLeftTop(c,null);return{left:b.left+c.left-(a.clientLeft||0)+d.left,top:b.top+c.top-(a.clientTop||0)+d.top}};f.util.getElementStyle=h})();(function(){function e(){}var a=function(){for(var a=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},
function(){return new XMLHttpRequest}],b=a.length;b--;)try{if(a[b]())return a[b]}catch(c){}}();f.util.request=function(d,b){b||(b={});var c=b.method?b.method.toUpperCase():"GET",h=b.onComplete||function(){},g=a(),i;g.onreadystatechange=function(){if(g.readyState===4)h(g),g.onreadystatechange=e};c==="GET"&&(i=null,typeof b.parameters==="string"&&(d=d+(/\?/.test(d)?"&":"?")+b.parameters));g.open(c,d,!0);(c==="POST"||c==="PUT")&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
g.send(i);return g}})();f.log=function(){};f.warn=function(){};typeof console!=="undefined"&&["log","warn"].forEach(function(e){typeof console[e]!=="undefined"&&console[e].apply&&(f[e]=function(){return console[e].apply(console,arguments)})});(function(){function e(){return a.apply(f.window,arguments)}var a=f.window.requestAnimationFrame||f.window.webkitRequestAnimationFrame||f.window.mozRequestAnimationFrame||f.window.oRequestAnimationFrame||f.window.msRequestAnimationFrame||function(a){f.window.setTimeout(a,
1E3/60)};f.util.animate=function(a){e(function(b){a||(a={});var c=b||+new Date,h=a.duration||500,g=c+h,i,k=a.onChange||function(){},m=a.abort||function(){return!1},f=a.easing||function(c,a,g,b){return-g*Math.cos(c/b*(Math.PI/2))+g+a},o="startValue"in a?a.startValue:0,b="endValue"in a?a.endValue:100,p=a.byValue||b-o;a.onStart&&a.onStart();(function x(b){i=b||+new Date;b=i>g?h:i-c;m()?a.onComplete&&a.onComplete():(k(f(b,o,p,h)),i>g?a.onComplete&&a.onComplete():e(x))})(c)})};f.util.requestAnimFrame=
e})();(function(){function e(c,a,g,b){c<Math.abs(a)?(c=a,b=g/4):b=g/(2*Math.PI)*Math.asin(a/c);return{a:c,c:a,p:g,s:b}}function a(c,a,g){return c.a*Math.pow(2,10*(a-=1))*Math.sin((a*g-c.s)*2*Math.PI/c.p)}function d(c,a,g,d){return g-b(d-c,0,g,d)+a}function b(c,a,g,b){return(c/=b)<1/2.75?g*7.5625*c*c+a:c<2/2.75?g*(7.5625*(c-=1.5/2.75)*c+0.75)+a:c<2.5/2.75?g*(7.5625*(c-=2.25/2.75)*c+0.9375)+a:g*(7.5625*(c-=2.625/2.75)*c+0.984375)+a}f.util.ease={easeInQuad:function(c,a,g,b){return g*(c/=b)*c+a},easeOutQuad:function(c,
a,g,b){return-g*(c/=b)*(c-2)+a},easeInOutQuad:function(c,a,g,b){c/=b/2;return c<1?g/2*c*c+a:-g/2*(--c*(c-2)-1)+a},easeInCubic:function(c,a,g,b){return g*(c/=b)*c*c+a},easeOutCubic:function(c,a,g,b){return g*((c=c/b-1)*c*c+1)+a},easeInOutCubic:function(c,a,g,b){c/=b/2;return c<1?g/2*c*c*c+a:g/2*((c-=2)*c*c+2)+a},easeInQuart:function(c,a,g,b){return g*(c/=b)*c*c*c+a},easeOutQuart:function(c,a,g,b){return-g*((c=c/b-1)*c*c*c-1)+a},easeInOutQuart:function(c,a,g,b){c/=b/2;return c<1?g/2*c*c*c*c+a:-g/2*
((c-=2)*c*c*c-2)+a},easeInQuint:function(c,a,g,b){return g*(c/=b)*c*c*c*c+a},easeOutQuint:function(c,a,g,b){return g*((c=c/b-1)*c*c*c*c+1)+a},easeInOutQuint:function(c,a,g,b){c/=b/2;return c<1?g/2*c*c*c*c*c+a:g/2*((c-=2)*c*c*c*c+2)+a},easeInSine:function(c,a,g,b){return-g*Math.cos(c/b*(Math.PI/2))+g+a},easeOutSine:function(c,a,g,b){return g*Math.sin(c/b*(Math.PI/2))+a},easeInOutSine:function(c,a,g,b){return-g/2*(Math.cos(Math.PI*c/b)-1)+a},easeInExpo:function(c,a,g,b){return c===0?a:g*Math.pow(2,
10*(c/b-1))+a},easeOutExpo:function(c,a,g,b){return c===b?a+g:g*(-Math.pow(2,-10*c/b)+1)+a},easeInOutExpo:function(c,a,g,b){if(c===0)return a;if(c===b)return a+g;c/=b/2;return c<1?g/2*Math.pow(2,10*(c-1))+a:g/2*(-Math.pow(2,-10*--c)+2)+a},easeInCirc:function(c,a,g,b){return-g*(Math.sqrt(1-(c/=b)*c)-1)+a},easeOutCirc:function(c,a,g,b){return g*Math.sqrt(1-(c=c/b-1)*c)+a},easeInOutCirc:function(c,a,g,b){c/=b/2;return c<1?-g/2*(Math.sqrt(1-c*c)-1)+a:g/2*(Math.sqrt(1-(c-=2)*c)+1)+a},easeInElastic:function(c,
b,g,d){var k=0;if(c===0)return b;c/=d;if(c===1)return b+g;k||(k=d*0.3);g=e(g,g,k,1.70158);return-a(g,c,d)+b},easeOutElastic:function(c,a,g,b){var d=0;if(c===0)return a;c/=b;if(c===1)return a+g;d||(d=b*0.3);g=e(g,g,d,1.70158);return g.a*Math.pow(2,-10*c)*Math.sin((c*b-g.s)*2*Math.PI/g.p)+g.c+a},easeInOutElastic:function(c,b,g,d){var k=0;if(c===0)return b;c/=d/2;if(c===2)return b+g;k||(k=d*0.3*1.5);g=e(g,g,k,1.70158);return c<1?-0.5*a(g,c,d)+b:g.a*Math.pow(2,-10*(c-=1))*Math.sin((c*d-g.s)*2*Math.PI/
g.p)*0.5+g.c+b},easeInBack:function(c,a,g,b,d){d===E&&(d=1.70158);return g*(c/=b)*c*((d+1)*c-d)+a},easeOutBack:function(c,a,g,b,d){d===E&&(d=1.70158);return g*((c=c/b-1)*c*((d+1)*c+d)+1)+a},easeInOutBack:function(c,a,g,b,d){d===E&&(d=1.70158);c/=b/2;return c<1?g/2*c*c*(((d*=1.525)+1)*c-d)+a:g/2*((c-=2)*c*(((d*=1.525)+1)*c+d)+2)+a},easeInBounce:d,easeOutBounce:b,easeInOutBounce:function(c,a,g,i){return c<i/2?d(c*2,0,g,i)*0.5+a:b(c*2-i,0,g,i)*0.5+g*0.5+a}}})();(function(e){function a(c){return c in
l?l[c]:c}function d(c,a,g){var b=Object.prototype.toString.call(a)==="[object Array]",d;(c==="fill"||c==="stroke")&&a==="none"?a="":c==="strokeDashArray"?a=a.replace(/,/g," ").split(/\s+/).map(function(c){return parseFloat(c)}):c==="transformMatrix"?a=g&&g.transformMatrix?j(g.transformMatrix,p.parseTransformAttribute(a)):p.parseTransformAttribute(a):c==="visible"?(a=a==="none"||a==="hidden"?!1:!0,g&&g.visible===!1&&(a=!1)):c==="originX"?a=a==="start"?"left":a==="end"?"right":"center":d=b?a.map(C):
C(a);return!b&&isNaN(d)?a:d}function b(c){for(var a in y)if(c[a]&&typeof c[y[a]]!=="undefined"&&c[a].indexOf("url(")!==0){var g=new p.Color(c[a]);c[a]=g.setAlpha(t(g.getAlpha()*c[y[a]],2)).toRgba()}return c}function c(c,a){var g=c.match(/(normal|italic)?\s*(normal|small-caps)?\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\s*(\d+)px(?:\/(normal|[\d\.]+))?\s+(.*)/);if(g){var b=g[1],d=g[3],h=g[4],i=g[5],g=g[6];if(b)a.fontStyle=b;if(d)a.fontWeight=isNaN(parseFloat(d))?d:parseFloat(d);
if(h)a.fontSize=parseFloat(h);if(g)a.fontFamily=g;if(i)a.lineHeight=i==="normal"?1:i}}function h(g,b){var h,i;g.replace(/;$/,"").split(";").forEach(function(g){g=g.split(":");h=a(g[0].trim().toLowerCase());i=d(h,g[1].trim());h==="font"?c(i,b):b[h]=i})}function g(c,a){var g={},b;for(b in p.cssRules[a]){var d=c,h=b.split(" "),e=void 0,k=!0;if((e=i(d,h.pop()))&&h.length){for(var k=h,m=void 0,f=!0;d.parentNode&&d.parentNode.nodeType===1&&k.length;)f&&(m=k.pop()),d=d.parentNode,f=i(d,m);k=k.length===0}if(e&&
k&&h.length===0)for(var n in p.cssRules[a][b])g[n]=p.cssRules[a][b][n]}return g}function i(c,a){var g=c.nodeName,b=c.getAttribute("class"),d=c.getAttribute("id"),a=a.replace(RegExp("^"+g,"i"),"");d&&a.length&&(a=a.replace(RegExp("#"+d+"(?![a-zA-Z\\-]+)","i"),""));if(b&&a.length){b=b.split(" ");for(d=b.length;d--;)g=RegExp("\\."+b[d]+"(?![a-zA-Z\\-]+)","i"),a=a.replace(g,"")}return a.length===0}function k(c){for(var a=c.getElementsByTagName("use");a.length;){for(var g=a[0],b=g.getAttribute("xlink:href").substr(1),
d=g.getAttribute("x")||0,h=g.getAttribute("y")||0,b=c.getElementById(b).cloneNode(!0),d=(g.getAttribute("transform")||"")+" translate("+d+", "+h+")",h=0,i=g.attributes,e=i.length;h<e;h++){var k=i.item(h);k.nodeName==="x"||k.nodeName==="y"||k.nodeName==="xlink:href"||(k.nodeName==="transform"?d=d+" "+k.nodeValue:b.setAttribute(k.nodeName,k.nodeValue))}b.setAttribute("transform",d);b.removeAttribute("id");g.parentNode.replaceChild(b,g)}}function m(c,a){a[3]=a[0]=a[0]>a[3]?a[3]:a[0];if(a[0]!==1||a[3]!==
1||a[4]!==0||a[5]!==0){for(var g=c.ownerDocument.createElement("g");c.firstChild!=null;)g.appendChild(c.firstChild);g.setAttribute("transform","matrix("+a[0]+" "+a[1]+" "+a[2]+" "+a[3]+" "+a[4]+" "+a[5]+")");c.appendChild(g)}}function f(c){var a=c.objects,c=c.options,a=a.map(function(c){return p[x(c.type)].fromObject(c)});return{objects:a,options:c}}function o(c,a,g){a[g]&&a[g].toSVG&&c.push('<pattern x="0" y="0" id="',g,'Pattern" ','width="',a[g].source.width,'" height="',a[g].source.height,'" patternUnits="userSpaceOnUse">',
'<image x="0" y="0" ','width="',a[g].source.width,'" height="',a[g].source.height,'" xlink:href="',a[g].source.src,'"></image></pattern>')}var p=e.fabric||(e.fabric={}),q=p.util.object.extend,x=p.util.string.capitalize,G=p.util.object.clone,t=p.util.toFixed,C=p.util.parseUnit,j=p.util.multiplyTransformMatrices,l={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily",
"font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},y={stroke:"strokeOpacity",fill:"fillOpacity"};p.cssRules={};p.gradientDefs={};p.parseTransformAttribute=function(){function c(a,g){var b=g[0];a[0]=Math.cos(b);a[1]=
Math.sin(b);a[2]=-Math.sin(b);a[3]=Math.cos(b)}function a(c,g){var b=g.length===2?g[1]:g[0];c[0]=g[0];c[3]=b}function g(c,a){c[4]=a[0];a.length===2&&(c[5]=a[1])}var b=[1,0,0,1,0,0],d=RegExp("^\\s*(?:(?:(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\)))(?:(?:\\s+,?\\s*|,\\s*)(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))))*)?)\\s*$"),
h=RegExp("(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\)))",
"g");return function(i){var e=b.concat(),k=[];if(!i||i&&!d.test(i))return e;i.replace(h,function(d){var h=RegExp("(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?))\\s*\\)))").exec(d).filter(function(c){return c!==
""&&c!=null}),d=h[1],h=h.slice(2).map(parseFloat);switch(d){case "translate":g(e,h);break;case "rotate":h[0]=p.util.degreesToRadians(h[0]);c(e,h);break;case "scale":a(e,h);break;case "skewX":e[2]=Math.tan(p.util.degreesToRadians(h[0]));break;case "skewY":e[1]=Math.tan(p.util.degreesToRadians(h[0]));break;case "matrix":e=h}k.push(e.concat());e=b.concat()});for(i=k[0];k.length>1;)k.shift(),i=p.util.multiplyTransformMatrices(i,k[0]);return i}}();p.parseSVGDocument=function(){var c=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,
a=RegExp("^\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)+)\\s*,?\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)+)\\s*,?\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)+)\\s*,?\\s*((?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)+)\\s*$");return function(g,b,d){if(g){var h=new Date,i=p.Object.__uid++;k(g);var e=g.getAttribute("viewBox"),f=C(g.getAttribute("width")||"100%"),n=C(g.getAttribute("height")||"100%"),o,q;if(e&&(e=e.match(a))){var x=parseFloat(e[1]),t=parseFloat(e[2]),j=1,A=1;o=parseFloat(e[3]);
q=parseFloat(e[4]);f&&f!==o&&(j=f/o);n&&n!==q&&(A=n/q);m(g,[j,0,0,A,j*-x,A*-t])}e=p.util.toArray(g.getElementsByTagName("*"));if(e.length===0&&p.isLikelyNode){e=g.selectNodes('//*[name(.)!="svg"]');x=[];t=0;for(j=e.length;t<j;t++)x[t]=e[t];e=x}e=e.filter(function(a){var g;if(g=c.test(a.tagName)){a:{for(g=/^(?:pattern|defs)$/;a&&(a=a.parentNode);)if(g.test(a.nodeName)){a=!0;break a}a=!1}g=!a}return g});if(!e||e&&!e.length)b&&b([],{});else{var l={width:f?f:o,height:n?n:q,widthAttr:f,heightAttr:n,svgUid:i};
p.gradientDefs[i]=p.getGradientDefs(g);p.cssRules[i]=p.getCSSRules(g);p.parseElements(e,function(c){p.documentParsingTime=new Date-h;b&&b(c,l)},G(l),d)}}}}();var z={has:function(c,a){a(!1)},get:function(){},set:function(){}};q(p,{getGradientDefs:function(c){var a=c.getElementsByTagName("linearGradient"),g=c.getElementsByTagName("radialGradient"),b,d=0,h,i=[],c={},e={};i.length=a.length+g.length;for(b=a.length;b--;)i[d++]=a[b];for(b=g.length;b--;)i[d++]=g[b];for(;d--;)a=i[d],g=a.getAttribute("xlink:href"),
h=a.getAttribute("id"),g&&(e[h]=g.substr(1)),c[h]=a;for(h in e){d=c[e[h]].cloneNode(!0);for(a=c[h];d.firstChild;)a.appendChild(d.firstChild)}return c},parseAttributes:function(c,h,i){if(c){var e,k={};typeof i==="undefined"&&(i=c.getAttribute("svgUid"));c.parentNode&&/^symbol|[g|a]$/i.test(c.parentNode.nodeName)&&(k=p.parseAttributes(c.parentNode,h,i));h=h.reduce(function(g,b){if(e=c.getAttribute(b))b=a(b),e=d(b,e,k),g[b]=e;return g},{});h=q(h,q(g(c,i),p.parseStyleAttribute(c)));return b(q(k,h))}},
parseElements:function(c,a,g,b){(new p.ElementsParser(c,a,g,b)).parse()},parseStyleAttribute:function(g){var b={},g=g.getAttribute("style");if(!g)return b;if(typeof g==="string")h(g,b);else{var i,e,k;for(k in g)typeof g[k]!=="undefined"&&(i=a(k.toLowerCase()),e=d(i,g[k]),i==="font"?c(e,b):b[i]=e)}return b},parsePointsAttribute:function(c){if(!c)return null;var c=c.replace(/,/g," ").trim(),c=c.split(/\s+/),a=[],g,b;g=0;for(b=c.length;g<b;g+=2)a.push({x:parseFloat(c[g]),y:parseFloat(c[g+1])});return a},
getCSSRules:function(c){for(var c=c.getElementsByTagName("style"),g={},b,h=0,i=c.length;h<i;h++)b=c[h].textContent,b=b.replace(/\/\*[\s\S]*?\*\//g,""),b.trim()!==""&&(b=b.match(/[^{]*\{[\s\S]*?\}/g),b=b.map(function(c){return c.trim()}),b.forEach(function(c){for(var c=c.match(/([\s\S]*?)\s*\{([^}]*)\}/),b={},h=c[2].trim().replace(/;$/,"").split(/\s*;\s*/),i=0,e=h.length;i<e;i++){var k=h[i].split(/\s*:\s*/),m=a(k[0]),k=d(m,k[1],k[0]);b[m]=k}c=c[1];c.split(",").forEach(function(c){g[c.trim()]=p.util.object.clone(b)})}));
return g},loadSVGFromURL:function(c,a,g){function b(d){var h=d.responseXML;if(h&&!h.documentElement&&p.window.ActiveXObject&&d.responseText)h=new ActiveXObject("Microsoft.XMLDOM"),h.async="false",h.loadXML(d.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""));h&&h.documentElement&&p.parseSVGDocument(h.documentElement,function(g,b){z.set(c,{objects:p.util.array.invoke(g,"toObject"),options:b});a(g,b)},g)}c=c.replace(/^\n\s*/,"").trim();z.has(c,function(g){g?z.get(c,function(c){c=f(c);a(c.objects,
c.options)}):new p.util.request(c,{method:"get",onComplete:b})})},loadSVGFromString:function(c,a,g){var c=c.trim(),b;if(typeof DOMParser!=="undefined"){var d=new DOMParser;d&&d.parseFromString&&(b=d.parseFromString(c,"text/xml"))}else if(p.window.ActiveXObject)b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(c.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""));p.parseSVGDocument(b.documentElement,function(c,g){a(c,g)},g)},createSVGFontFacesMarkup:function(c){for(var a="",g=0,b=c.length;g<
b;g++)c[g].type==="text"&&c[g].path&&(a+=["@font-face {font-family: ",c[g].fontFamily,"; src: url('",c[g].path,"')}"].join(""));a&&(a=['<style type="text/css"><![CDATA[',a,"]]\></style>"].join(""));return a},createSVGRefElementsMarkup:function(c){var a=[];o(a,c,"backgroundColor");o(a,c,"overlayColor");return a.join("")}})})(typeof j!=="undefined"?j:this);f.ElementsParser=function(e,a,d,b){this.elements=e;this.callback=a;this.options=d;this.reviver=b;this.svgUid=d&&d.svgUid||0};f.ElementsParser.prototype.parse=
function(){this.instances=Array(this.elements.length);this.numElements=this.elements.length;this.createObjects()};f.ElementsParser.prototype.createObjects=function(){for(var e=0,a=this.elements.length;e<a;e++)this.elements[e].setAttribute("svgUid",this.svgUid),function(a,b){setTimeout(function(){a.createObject(a.elements[b],b)},0)}(this,e)};f.ElementsParser.prototype.createObject=function(e,a){var d=f[f.util.string.capitalize(e.tagName)];if(d&&d.fromElement)try{this._createObject(d,e,a)}catch(b){f.log(b)}else this.checkIfDone()};
f.ElementsParser.prototype._createObject=function(e,a,d){e.async?e.fromElement(a,this.createCallback(d,a),this.options):(e=e.fromElement(a,this.options),this.resolveGradient(e,"fill"),this.resolveGradient(e,"stroke"),this.reviver&&this.reviver(a,e),this.instances[d]=e,this.checkIfDone())};f.ElementsParser.prototype.createCallback=function(e,a){var d=this;return function(b){d.resolveGradient(b,"fill");d.resolveGradient(b,"stroke");d.reviver&&d.reviver(a,b);d.instances[e]=b;d.checkIfDone()}};f.ElementsParser.prototype.resolveGradient=
function(e,a){var d=e.get(a);/^url\(/.test(d)&&(d=d.slice(5,d.length-1),f.gradientDefs[this.svgUid][d]&&e.set(a,f.Gradient.fromElement(f.gradientDefs[this.svgUid][d],e)))};f.ElementsParser.prototype.checkIfDone=function(){if(--this.numElements===0)this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances)};(function(e){function a(a,b){this.x=a;this.y=b}e=e.fabric||(e.fabric={});e.Point?e.warn("fabric.Point is already defined"):(e.Point=a,a.prototype={constructor:a,
add:function(d){return new a(this.x+d.x,this.y+d.y)},addEquals:function(a){this.x+=a.x;this.y+=a.y;return this},scalarAdd:function(d){return new a(this.x+d,this.y+d)},scalarAddEquals:function(a){this.x+=a;this.y+=a;return this},subtract:function(d){return new a(this.x-d.x,this.y-d.y)},subtractEquals:function(a){this.x-=a.x;this.y-=a.y;return this},scalarSubtract:function(d){return new a(this.x-d,this.y-d)},scalarSubtractEquals:function(a){this.x-=a;this.y-=a;return this},multiply:function(d){return new a(this.x*
d,this.y*d)},multiplyEquals:function(a){this.x*=a;this.y*=a;return this},divide:function(d){return new a(this.x/d,this.y/d)},divideEquals:function(a){this.x/=a;this.y/=a;return this},eq:function(a){return this.x===a.x&&this.y===a.y},lt:function(a){return this.x<a.x&&this.y<a.y},lte:function(a){return this.x<=a.x&&this.y<=a.y},gt:function(a){return this.x>a.x&&this.y>a.y},gte:function(a){return this.x>=a.x&&this.y>=a.y},lerp:function(d,b){return new a(this.x+(d.x-this.x)*b,this.y+(d.y-this.y)*b)},
distanceFrom:function(a){var b=this.x-a.x,a=this.y-a.y;return Math.sqrt(b*b+a*a)},midPointFrom:function(d){return new a(this.x+(d.x-this.x)/2,this.y+(d.y-this.y)/2)},min:function(d){return new a(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new a(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(a,b){this.x=a;this.y=b},setFromPoint:function(a){this.x=a.x;this.y=a.y},swap:function(a){var b=this.x,c=this.y;this.x=a.x;this.y=
a.y;a.x=b;a.y=c}})})(typeof j!=="undefined"?j:this);(function(e){function a(a){this.status=a;this.points=[]}var d=e.fabric||(e.fabric={});d.Intersection?d.warn("fabric.Intersection is already defined"):(d.Intersection=a,d.Intersection.prototype={appendPoint:function(a){this.points.push(a)},appendPoints:function(a){this.points=this.points.concat(a)}},d.Intersection.intersectLineLine=function(b,c,h,g){var i,e=(g.x-h.x)*(b.y-h.y)-(g.y-h.y)*(b.x-h.x);i=(c.x-b.x)*(b.y-h.y)-(c.y-b.y)*(b.x-h.x);h=(g.y-h.y)*
(c.x-b.x)-(g.x-h.x)*(c.y-b.y);h!==0?(e/=h,i/=h,0<=e&&e<=1&&0<=i&&i<=1?(i=new a("Intersection"),i.points.push(new d.Point(b.x+e*(c.x-b.x),b.y+e*(c.y-b.y)))):i=new a):i=e===0||i===0?new a("Coincident"):new a("Parallel");return i},d.Intersection.intersectLinePolygon=function(b,c,d){for(var g=new a,i=d.length,e=0;e<i;e++){var m=a.intersectLineLine(b,c,d[e],d[(e+1)%i]);g.appendPoints(m.points)}if(g.points.length>0)g.status="Intersection";return g},d.Intersection.intersectPolygonPolygon=function(b,c){for(var d=
new a,g=b.length,i=0;i<g;i++){var e=a.intersectLinePolygon(b[i],b[(i+1)%g],c);d.appendPoints(e.points)}if(d.points.length>0)d.status="Intersection";return d},d.Intersection.intersectPolygonRectangle=function(b,c,h){var g=c.min(h),i=c.max(h),h=new d.Point(i.x,g.y),e=new d.Point(g.x,i.y),c=a.intersectLinePolygon(g,h,b),h=a.intersectLinePolygon(h,i,b),i=a.intersectLinePolygon(i,e,b),b=a.intersectLinePolygon(e,g,b),g=new a;g.appendPoints(c.points);g.appendPoints(h.points);g.appendPoints(i.points);g.appendPoints(b.points);
if(g.points.length>0)g.status="Intersection";return g})})(typeof j!=="undefined"?j:this);(function(e){function a(c){c?this._tryParsingColor(c):this.setSource([0,0,0,1])}function d(c,a,g){g<0&&(g+=1);g>1&&(g-=1);return g<1/6?c+(a-c)*6*g:g<0.5?a:g<2/3?c+(a-c)*(2/3-g)*6:c}var b=e.fabric||(e.fabric={});b.Color?b.warn("fabric.Color is already defined."):(b.Color=a,b.Color.prototype={_tryParsingColor:function(c){var b;c in a.colorNameMap&&(c=a.colorNameMap[c]);c==="transparent"?this.setSource([255,255,
255,0]):((b=a.sourceFromHex(c))||(b=a.sourceFromRgb(c)),b||(b=a.sourceFromHsl(c)),b&&this.setSource(b))},_rgbToHsl:function(c,a,g){c/=255;a/=255;g/=255;var d,e,m,f=b.util.array.max([c,a,g]);e=b.util.array.min([c,a,g]);m=(f+e)/2;if(f===e)d=e=0;else{var o=f-e;e=m>0.5?o/(2-f-e):o/(f+e);switch(f){case c:d=(a-g)/o+(a<g?6:0);break;case a:d=(g-c)/o+2;break;case g:d=(c-a)/o+4}d/=6}return[Math.round(d*360),Math.round(e*100),Math.round(m*100)]},getSource:function(){return this._source},setSource:function(c){this._source=
c},toRgb:function(){var c=this.getSource();return"rgb("+c[0]+","+c[1]+","+c[2]+")"},toRgba:function(){var c=this.getSource();return"rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")"},toHsl:function(){var c=this.getSource(),c=this._rgbToHsl(c[0],c[1],c[2]);return"hsl("+c[0]+","+c[1]+"%,"+c[2]+"%)"},toHsla:function(){var c=this.getSource(),a=this._rgbToHsl(c[0],c[1],c[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+c[3]+")"},toHex:function(){var c=this.getSource(),a,g;a=c[0].toString(16);a=a.length===1?"0"+
a:a;g=c[1].toString(16);g=g.length===1?"0"+g:g;c=c[2].toString(16);c=c.length===1?"0"+c:c;return a.toUpperCase()+g.toUpperCase()+c.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(c){var a=this.getSource();a[3]=c;this.setSource(a);return this},toGrayscale:function(){var c=this.getSource(),a=parseInt((c[0]*0.3+c[1]*0.59+c[2]*0.11).toFixed(0),10);this.setSource([a,a,a,c[3]]);return this},toBlackWhite:function(c){var a=this.getSource(),g=(a[0]*0.3+a[1]*0.59+a[2]*0.11).toFixed(0),
a=a[3],g=Number(g)<Number(c||127)?0:255;this.setSource([g,g,g,a]);return this},overlayWith:function(c){c instanceof a||(c=new a(c));for(var b=[],g=this.getAlpha(),d=this.getSource(),c=c.getSource(),e=0;e<3;e++)b.push(Math.round(d[e]*0.5+c[e]*0.5));b[3]=g;this.setSource(b);return this}},b.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,b.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,
b.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,b.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},b.Color.fromRgb=function(c){return a.fromSource(a.sourceFromRgb(c))},b.Color.sourceFromRgb=function(c){if(c=c.match(a.reRGBa)){var b=parseInt(c[1],10)/(/%$/.test(c[1])?
100:1)*(/%$/.test(c[1])?255:1),g=parseInt(c[2],10)/(/%$/.test(c[2])?100:1)*(/%$/.test(c[2])?255:1),d=parseInt(c[3],10)/(/%$/.test(c[3])?100:1)*(/%$/.test(c[3])?255:1);return[parseInt(b,10),parseInt(g,10),parseInt(d,10),c[4]?parseFloat(c[4]):1]}},b.Color.fromRgba=a.fromRgb,b.Color.fromHsl=function(c){return a.fromSource(a.sourceFromHsl(c))},b.Color.sourceFromHsl=function(c){if(c=c.match(a.reHSLa)){var b=(parseFloat(c[1])%360+360)%360/360,g=parseFloat(c[2])/(/%$/.test(c[2])?100:1),i=parseFloat(c[3])/
(/%$/.test(c[3])?100:1);if(g===0)i=g=b=i;else var e=i<=0.5?i*(g+1):i+g-i*g,m=i*2-e,i=d(m,e,b+1/3),g=d(m,e,b),b=d(m,e,b-1/3);return[Math.round(i*255),Math.round(g*255),Math.round(b*255),c[4]?parseFloat(c[4]):1]}},b.Color.fromHsla=a.fromHsl,b.Color.fromHex=function(c){return a.fromSource(a.sourceFromHex(c))},b.Color.sourceFromHex=function(c){if(c.match(a.reHex)){var b=c.slice(c.indexOf("#")+1),g=b.length===3,c=g?b.charAt(0)+b.charAt(0):b.substring(0,2),d=g?b.charAt(1)+b.charAt(1):b.substring(2,4),b=
g?b.charAt(2)+b.charAt(2):b.substring(4,6);return[parseInt(c,16),parseInt(d,16),parseInt(b,16),1]}},b.Color.fromSource=function(c){var b=new a;b.setSource(c);return b})})(typeof j!=="undefined"?j:this);(function(){function e(a){var b=a.getAttribute("style"),c=a.getAttribute("offset"),h,g,c=parseFloat(c)/(/%$/.test(c)?100:1),c=c<0?0:c>1?1:c;if(b){b=b.split(/\s*;\s*/);b[b.length-1]===""&&b.pop();for(var i=b.length;i--;){var e=b[i].split(/\s*:\s*/),m=e[0].trim(),e=e[1].trim();m==="stop-color"?h=e:m===
"stop-opacity"&&(g=e)}}h||(h=a.getAttribute("stop-color")||"rgb(0,0,0)");g||(g=a.getAttribute("stop-opacity"));h=new f.Color(h);a=h.getAlpha();g=isNaN(parseFloat(g))?1:parseFloat(g);g*=a;return{offset:c,color:h.toRgb(),opacity:g}}function a(a,b,c){var h,g=0,i=1,e="",m;for(m in b){h=parseFloat(b[m],10);i=typeof b[m]==="string"&&/^\d+%$/.test(b[m])?0.01:1;if(m==="x1"||m==="x2"||m==="r2")i*=c==="objectBoundingBox"?a.width:1,g=c==="objectBoundingBox"?a.left||0:0;else if(m==="y1"||m==="y2")i*=c==="objectBoundingBox"?
a.height:1,g=c==="objectBoundingBox"?a.top||0:0;b[m]=h*i+g}a.type==="ellipse"&&b.r2!==null&&c==="objectBoundingBox"&&a.rx!==a.ry&&(a=a.ry/a.rx,e=" scale(1, "+a+")",b.y1&&(b.y1/=a),b.y2&&(b.y2/=a));return e}f.Gradient=f.util.createClass({offsetX:0,offsetY:0,initialize:function(a){a||(a={});var b={};this.id=f.Object.__uid++;this.type=a.type||"linear";b={x1:a.coords.x1||0,y1:a.coords.y1||0,x2:a.coords.x2||0,y2:a.coords.y2||0};if(this.type==="radial")b.r1=a.coords.r1||0,b.r2=a.coords.r2||0;this.coords=
b;this.colorStops=a.colorStops.slice();if(a.gradientTransform)this.gradientTransform=a.gradientTransform;this.offsetX=a.offsetX||this.offsetX;this.offsetY=a.offsetY||this.offsetY},addColorStop:function(a){for(var b in a){var c=new f.Color(a[b]);this.colorStops.push({offset:b,color:c.toRgb(),opacity:c.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(a){var b=f.util.object.clone(this.coords),
c;this.colorStops.sort(function(c,a){return c.offset-a.offset});if(!(a.group&&a.group.type==="path-group"))for(var h in b)if(h==="x1"||h==="x2"||h==="r2")b[h]+=this.offsetX-a.width/2;else if(h==="y1"||h==="y2")b[h]+=this.offsetY-a.height/2;a='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"';this.gradientTransform&&(a+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" ');this.type==="linear"?c=["<linearGradient ",a,' x1="',b.x1,'" y1="',b.y1,'" x2="',b.x2,'" y2="',b.y2,'">\n']:
this.type==="radial"&&(c=["<radialGradient ",a,' cx="',b.x2,'" cy="',b.y2,'" r="',b.r2,'" fx="',b.x1,'" fy="',b.y1,'">\n']);for(b=0;b<this.colorStops.length;b++)c.push("<stop ",'offset="',this.colorStops[b].offset*100+"%",'" style="stop-color:',this.colorStops[b].color,this.colorStops[b].opacity!=null?";stop-opacity: "+this.colorStops[b].opacity:";",'"/>\n');c.push(this.type==="linear"?"</linearGradient>\n":"</radialGradient>\n");return c.join("")},toLive:function(a,b){var c,h=f.util.object.clone(this.coords);
if(this.type){if(b.group&&b.group.type==="path-group")for(var g in h)if(g==="x1"||g==="x2")h[g]+=-this.offsetX+b.width/2;else if(g==="y1"||g==="y2")h[g]+=-this.offsetY+b.height/2;this.type==="linear"?c=a.createLinearGradient(h.x1,h.y1,h.x2,h.y2):this.type==="radial"&&(c=a.createRadialGradient(h.x1,h.y1,h.r1,h.x2,h.y2,h.r2));h=0;for(g=this.colorStops.length;h<g;h++){var i=this.colorStops[h].color,e=this.colorStops[h].opacity,m=this.colorStops[h].offset;typeof e!=="undefined"&&(i=(new f.Color(i)).setAlpha(e).toRgba());
c.addColorStop(parseFloat(m),i)}return c}}});f.util.object.extend(f.Gradient,{fromElement:function(d,b){var c=d.getElementsByTagName("stop"),h=d.nodeName==="linearGradient"?"linear":"radial",g=d.getAttribute("gradientUnits")||"objectBoundingBox",i=d.getAttribute("gradientTransform"),k=[],m={};h==="linear"?m={x1:d.getAttribute("x1")||0,y1:d.getAttribute("y1")||0,x2:d.getAttribute("x2")||"100%",y2:d.getAttribute("y2")||0}:h==="radial"&&(m={x1:d.getAttribute("fx")||d.getAttribute("cx")||"50%",y1:d.getAttribute("fy")||
d.getAttribute("cy")||"50%",r1:0,x2:d.getAttribute("cx")||"50%",y2:d.getAttribute("cy")||"50%",r2:d.getAttribute("r")||"50%"});for(var n=c.length;n--;)k.push(e(c[n]));c=a(b,m,g);h=new f.Gradient({type:h,coords:m,colorStops:k,offsetX:-b.left,offsetY:-b.top});if(i||c!=="")h.gradientTransform=f.parseTransformAttribute((i||"")+c);return h},forObject:function(d,b){b||(b={});a(d,b.coords,"userSpaceOnUse");return new f.Gradient(b)}})})();f.Pattern=f.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,
initialize:function(e){e||(e={});this.id=f.Object.__uid++;if(e.source)if(typeof e.source==="string")if(typeof f.util.getFunctionBody(e.source)!=="undefined")this.source=new Function(f.util.getFunctionBody(e.source));else{var a=this;this.source=f.util.createImage();f.util.loadImage(e.source,function(d){a.source=d})}else this.source=e.source;if(e.repeat)this.repeat=e.repeat;if(e.offsetX)this.offsetX=e.offsetX;if(e.offsetY)this.offsetY=e.offsetY},toObject:function(){var e;if(typeof this.source==="function")e=
String(this.source);else if(typeof this.source.src==="string")e=this.source.src;return{source:e,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(e){var a=typeof this.source==="function"?this.source():this.source,d=a.width/e.getWidth(),e=a.height/e.getHeight(),b="";a.src?b=a.src:a.toDataURL&&(b=a.toDataURL());return'<pattern id="SVGID_'+this.id+'" x="'+this.offsetX+'" y="'+this.offsetY+'" width="'+d+'" height="'+e+'"><image x="0" y="0" width="'+a.width+'" height="'+a.height+
'" xlink:href="'+b+'"></image></pattern>'},toLive:function(e){var a=typeof this.source==="function"?this.source():this.source;if(!a)return"";if(typeof a.src!=="undefined"){if(!a.complete)return"";if(a.naturalWidth===0||a.naturalHeight===0)return""}return e.createPattern(a,this.repeat)}});(function(e){var a=e.fabric||(e.fabric={});a.Shadow?a.warn("fabric.Shadow is already defined."):(a.Shadow=a.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,
initialize:function(d){typeof d==="string"&&(d=this._parseShadow(d));for(var b in d)this[b]=d[b];this.id=a.Object.__uid++},_parseShadow:function(d){var d=d.trim(),b=a.Shadow.reOffsetsAndBlur.exec(d)||[];return{color:(d.replace(a.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(b[1],10)||0,offsetY:parseInt(b[2],10)||0,blur:parseInt(b[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(a){var b="SourceAlpha";if(a&&(a.fill===
this.color||a.stroke===this.color))b="SourceGraphic";return'<filter id="SVGID_'+this.id+'" y="-40%" height="180%"><feGaussianBlur in="'+b+'" stdDeviation="'+(this.blur?this.blur/3:0)+'"></feGaussianBlur><feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset><feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter>'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};
var d={},b=a.Shadow.prototype;if(this.color!==b.color)d.color=this.color;if(this.blur!==b.blur)d.blur=this.blur;if(this.offsetX!==b.offsetX)d.offsetX=this.offsetX;if(this.offsetY!==b.offsetY)d.offsetY=this.offsetY;return d}}),a.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)})(typeof j!=="undefined"?j:this);(function(){if(f.StaticCanvas)f.warn("fabric.StaticCanvas is already defined.");else{var e=f.util.object.extend,a=f.util.getElementOffset,
d=f.util.removeFromArray,b=Error("Could not initialize `canvas` element");f.StaticCanvas=f.util.createClass({initialize:function(c,a){a||(a={});this._initStatic(c,a);f.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},
_initStatic:function(c,a){this._objects=[];this._createLowerCanvas(c);this._initOptions(a);this._setImageSmoothing();a.overlayImage&&this.setOverlayImage(a.overlayImage,this.renderAll.bind(this));a.backgroundImage&&this.setBackgroundImage(a.backgroundImage,this.renderAll.bind(this));a.backgroundColor&&this.setBackgroundColor(a.backgroundColor,this.renderAll.bind(this));a.overlayColor&&this.setOverlayColor(a.overlayColor,this.renderAll.bind(this));this.calcOffset()},calcOffset:function(){this._offset=
a(this.lowerCanvasEl);return this},setOverlayImage:function(c,a,g){return this.__setBgOverlayImage("overlayImage",c,a,g)},setBackgroundImage:function(c,a,g){return this.__setBgOverlayImage("backgroundImage",c,a,g)},setOverlayColor:function(c,a){return this.__setBgOverlayColor("overlayColor",c,a)},setBackgroundColor:function(c,a){return this.__setBgOverlayColor("backgroundColor",c,a)},_setImageSmoothing:function(){var c=this.getContext();c.imageSmoothingEnabled=this.imageSmoothingEnabled;c.webkitImageSmoothingEnabled=
this.imageSmoothingEnabled;c.mozImageSmoothingEnabled=this.imageSmoothingEnabled;c.msImageSmoothingEnabled=this.imageSmoothingEnabled;c.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(c,a,g,b){typeof a==="string"?f.util.loadImage(a,function(a){this[c]=new f.Image(a,b);g&&g()},this):(this[c]=a,g&&g());return this},__setBgOverlayColor:function(c,a,g){if(a&&a.source){var b=this;f.util.loadImage(a.source,function(d){b[c]=new f.Pattern({source:d,repeat:a.repeat,offsetX:a.offsetX,
offsetY:a.offsetY});g&&g()})}else this[c]=a,g&&g();return this},_createCanvasElement:function(){var c=f.document.createElement("canvas");if(!c.style)c.style={};if(!c)throw b;this._initCanvasElement(c);return c},_initCanvasElement:function(c){f.util.createCanvasElement(c);if(typeof c.getContext==="undefined")throw b;},_initOptions:function(c){for(var a in c)this[a]=c[a];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0;this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||
0;if(this.lowerCanvasEl.style)this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice()},_createLowerCanvas:function(c){this.lowerCanvasEl=f.util.getById(c)||this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);f.util.addClass(this.lowerCanvasEl,"lower-canvas");this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl);
this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(c,a){return this.setDimensions({width:c},a)},setHeight:function(c,a){return this.setDimensions({height:c},a)},setDimensions:function(c,a){var g,a=a||{},b;for(b in c)g=c[b],a.cssOnly||(this._setBackstoreDimension(b,c[b]),g+="px"),a.backstoreOnly||this._setCssDimension(b,g);a.cssOnly||this.renderAll();this.calcOffset();return this},_setBackstoreDimension:function(a,
b){this.lowerCanvasEl[a]=b;this.upperCanvasEl&&(this.upperCanvasEl[a]=b);this.cacheCanvasEl&&(this.cacheCanvasEl[a]=b);this[a]=b;return this},_setCssDimension:function(a,b){this.lowerCanvasEl.style[a]=b;this.upperCanvasEl&&(this.upperCanvasEl.style[a]=b);this.wrapperEl&&(this.wrapperEl.style[a]=b);return this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(a){this.viewportTransform=a;this.renderAll();for(var a=0,b=this._objects.length;a<
b;a++)this._objects[a].setCoords();return this},zoomToPoint:function(a,b){var g=a,a=f.util.transformPoint(a,f.util.invertTransform(this.viewportTransform));this.viewportTransform[0]=b;this.viewportTransform[3]=b;var d=f.util.transformPoint(a,this.viewportTransform);this.viewportTransform[4]+=g.x-d.x;this.viewportTransform[5]+=g.y-d.y;this.renderAll();g=0;for(d=this._objects.length;g<d;g++)this._objects[g].setCoords();return this},setZoom:function(a){this.zoomToPoint(new f.Point(0,0),a);return this},
absolutePan:function(a){this.viewportTransform[4]=-a.x;this.viewportTransform[5]=-a.y;this.renderAll();for(var a=0,b=this._objects.length;a<b;a++)this._objects[a].setCoords();return this},relativePan:function(a){return this.absolutePan(new f.Point(-a.x-this.viewportTransform[4],-a.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(a,b){if(b){a.save();var g=this.viewportTransform;
a.transform(g[0],g[1],g[2],g[3],g[4],g[5]);this._shouldRenderObject(b)&&b.render(a);a.restore();this.controlsAboveOverlay||b._renderControls(a)}},_shouldRenderObject:function(a){return!a?!1:a!==this.getActiveGroup()||!this.preserveObjectStacking},_onObjectAdded:function(a){this.stateful&&a.setupState();a.canvas=this;a.setCoords();this.fire("object:added",{target:a});a.fire("added")},_onObjectRemoved:function(a){this.getActiveObject()===a&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),
this.fire("selection:cleared"));this.fire("object:removed",{target:a});a.fire("removed")},clearContext:function(a){a.clearRect(0,0,this.width,this.height);return this},getContext:function(){return this.contextContainer},clear:function(){this._objects.length=0;this.discardActiveGroup&&this.discardActiveGroup();this.discardActiveObject&&this.discardActiveObject();this.clearContext(this.contextContainer);this.contextTop&&this.clearContext(this.contextTop);this.fire("canvas:cleared");this.renderAll();
return this},renderAll:function(a){var b=this[a===!0&&this.interactive?"contextTop":"contextContainer"],g=this.getActiveGroup();this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop);a||this.clearContext(b);this.fire("before:render");this.clipTo&&f.util.clipContext(this,b);this._renderBackground(b);this._renderObjects(b,g);this._renderActiveGroup(b,g);this.clipTo&&b.restore();this._renderOverlay(b);this.controlsAboveOverlay&&this.interactive&&this.drawControls(b);
this.fire("after:render");return this},_renderObjects:function(a,b){var g,d;if(!b||this.preserveObjectStacking)for(g=0,d=this._objects.length;g<d;++g)this._draw(a,this._objects[g]);else for(g=0,d=this._objects.length;g<d;++g)this._objects[g]&&!b.contains(this._objects[g])&&this._draw(a,this._objects[g])},_renderActiveGroup:function(a,b){if(b){var g=[];this.forEachObject(function(a){b.contains(a)&&g.push(a)});b._set("objects",g);this._draw(a,b)}},_renderBackground:function(a){if(this.backgroundColor)a.fillStyle=
this.backgroundColor.toLive?this.backgroundColor.toLive(a):this.backgroundColor,a.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height);this.backgroundImage&&this._draw(a,this.backgroundImage)},_renderOverlay:function(a){if(this.overlayColor)a.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(a):this.overlayColor,a.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height);this.overlayImage&&this._draw(a,this.overlayImage)},
renderTop:function(){var a=this.contextTop||this.contextContainer;this.clearContext(a);this.selection&&this._groupSelector&&this._drawSelection();var b=this.getActiveGroup();b&&b.render(a);this._renderOverlay(a);this.fire("after:render");return this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(a){this._centerObject(a,new f.Point(this.getCenter().left,a.getCenterPoint().y));this.renderAll();return this},centerObjectV:function(a){this._centerObject(a,
new f.Point(a.getCenterPoint().x,this.getCenter().top));this.renderAll();return this},centerObject:function(a){var b=this.getCenter();this._centerObject(a,new f.Point(b.left,b.top));this.renderAll();return this},_centerObject:function(a,b){a.setPositionByOrigin(b,"center","center");return this},toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(a,
b){var g=this.getActiveGroup();g&&this.discardActiveGroup();var d={objects:this._toObjects(a,b)};e(d,this.__serializeBgOverlay());f.util.populateWithProperties(this,d,b);if(g&&(this.setActiveGroup(new f.Group(g.getObjects(),{originX:"center",originY:"center"})),g.forEachObject(function(a){a.set("active",!0)}),this._currentTransform))this._currentTransform.target=this.getActiveGroup();return d},_toObjects:function(a,b){return this.getObjects().map(function(g){return this._toObject(g,a,b)},this)},_toObject:function(a,
b,g){var d;if(!this.includeDefaultValues)d=a.includeDefaultValues,a.includeDefaultValues=!1;b=a[b](g);if(!this.includeDefaultValues)a.includeDefaultValues=d;return b},__serializeBgOverlay:function(){var a={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};if(this.overlayColor)a.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor;if(this.backgroundImage)a.backgroundImage=this.backgroundImage.toObject();
if(this.overlayImage)a.overlayImage=this.overlayImage.toObject();return a},svgViewportTransformation:!0,toSVG:function(a,b){a||(a={});var g=[];this._setSVGPreamble(g,a);this._setSVGHeader(g,a);this._setSVGBgOverlayColor(g,"backgroundColor");this._setSVGBgOverlayImage(g,"backgroundImage");this._setSVGObjects(g,b);this._setSVGBgOverlayColor(g,"overlayColor");this._setSVGBgOverlayImage(g,"overlayImage");g.push("</svg>");return g.join("")},_setSVGPreamble:function(a,b){b.suppressPreamble||a.push('<?xml version="1.0" encoding="',
b.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(a,b){var g,d,e;if(b.viewBox)g=b.viewBox.width,d=b.viewBox.height;else if(g=this.width,d=this.height,!this.svgViewportTransformation)e=this.viewportTransform,g/=e[0],d/=e[3];a.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',g,'" ','height="',d,'" ',this.backgroundColor&&
!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,b.viewBox?'viewBox="'+b.viewBox.x+" "+b.viewBox.y+" "+b.viewBox.width+" "+b.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",f.version,"</desc>","<defs>",f.createSVGFontFacesMarkup(this.getObjects()),f.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(a,b){var g=this.getActiveGroup();g&&this.discardActiveGroup();for(var d=0,e=this.getObjects(),m=e.length;d<m;d++)a.push(e[d].toSVG(b));
g&&(this.setActiveGroup(new f.Group(g.getObjects())),g.forEachObject(function(a){a.set("active",!0)}))},_setSVGBgOverlayImage:function(a,b){this[b]&&this[b].toSVG&&a.push(this[b].toSVG())},_setSVGBgOverlayColor:function(a,b){this[b]&&this[b].source?a.push('<rect x="',this[b].offsetX,'" y="',this[b].offsetY,'" ','width="',this[b].repeat==="repeat-y"||this[b].repeat==="no-repeat"?this[b].source.width:this.width,'" height="',this[b].repeat==="repeat-x"||this[b].repeat==="no-repeat"?this[b].source.height:
this.height,'" fill="url(#'+b+'Pattern)"',"></rect>"):this[b]&&b==="overlayColor"&&a.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[b],'"',"></rect>")},sendToBack:function(a){d(this._objects,a);this._objects.unshift(a);return this.renderAll&&this.renderAll()},bringToFront:function(a){d(this._objects,a);this._objects.push(a);return this.renderAll&&this.renderAll()},sendBackwards:function(a,b){var g=this._objects.indexOf(a);g!==0&&(g=this._findNewLowerIndex(a,
g,b),d(this._objects,a),this._objects.splice(g,0,a),this.renderAll&&this.renderAll());return this},_findNewLowerIndex:function(a,b,g){if(g){g=b;for(b-=1;b>=0;--b)if(a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){g=b;break}}else g=b-1;return g},bringForward:function(a,b){var g=this._objects.indexOf(a);g!==this._objects.length-1&&(g=this._findNewUpperIndex(a,g,b),d(this._objects,a),this._objects.splice(g,0,a),this.renderAll&&
this.renderAll());return this},_findNewUpperIndex:function(a,b,g){if(g){g=b;for(b+=1;b<this._objects.length;++b)if(a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){g=b;break}}else g=b+1;return g},moveTo:function(a,b){d(this._objects,a);this._objects.splice(b,0,a);return this.renderAll&&this.renderAll()},dispose:function(){this.clear();this.interactive&&this.removeListeners();return this},toString:function(){return"#<fabric.Canvas ("+
this.complexity()+"): { objects: "+this.getObjects().length+" }>"}});e(f.StaticCanvas.prototype,f.Observable);e(f.StaticCanvas.prototype,f.Collection);e(f.StaticCanvas.prototype,f.DataURLExporter);e(f.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(a){var b=f.util.createCanvasElement();if(!b||!b.getContext)return null;var g=b.getContext("2d");if(!g)return null;switch(a){case "getImageData":return typeof g.getImageData!=="undefined";case "setLineDash":return typeof g.setLineDash!==
"undefined";case "toDataURL":return typeof b.toDataURL!=="undefined";case "toDataURLWithQuality":try{return b.toDataURL("image/jpeg",0),!0}catch(d){}return!1;default:return null}}});f.StaticCanvas.prototype.toJSON=f.StaticCanvas.prototype.toObject}})();f.BaseBrush=f.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",setShadow:function(e){this.shadow=new f.Shadow(e);return this},_setBrushStyles:function(){var e=this.canvas.contextTop;e.strokeStyle=
this.color;e.lineWidth=this.width;e.lineCap=this.strokeLineCap;e.lineJoin=this.strokeLineJoin},_setShadow:function(){if(this.shadow){var e=this.canvas.contextTop;e.shadowColor=this.shadow.color;e.shadowBlur=this.shadow.blur;e.shadowOffsetX=this.shadow.offsetX;e.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="";e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}});(function(){f.PencilBrush=f.util.createClass(f.BaseBrush,{initialize:function(e){this.canvas=
e;this._points=[]},onMouseDown:function(e){this._prepareForDrawing(e);this._captureDrawingPath(e);this._render()},onMouseMove:function(e){this._captureDrawingPath(e);this.canvas.clearContext(this.canvas.contextTop);this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(e){e=new f.Point(e.x,e.y);this._reset();this._addPoint(e);this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(e){this._points.push(e)},_reset:function(){this._points.length=0;this._setBrushStyles();
this._setShadow()},_captureDrawingPath:function(e){this._addPoint(new f.Point(e.x,e.y))},_render:function(){var e=this.canvas.contextTop,a=this.canvas.viewportTransform,d=this._points[0],b=this._points[1];e.save();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]);e.beginPath();this._points.length===2&&d.x===b.x&&d.y===b.y&&(d.x-=0.5,b.x+=0.5);e.moveTo(d.x,d.y);for(var a=1,c=this._points.length;a<c;a++)b=d.midPointFrom(b),e.quadraticCurveTo(d.x,d.y,b.x,b.y),d=this._points[a],b=this._points[a+1];e.lineTo(d.x,
d.y);e.stroke();e.restore()},convertPointsToSVGPath:function(e){var a=[],d=new f.Point(e[0].x,e[0].y),b=new f.Point(e[1].x,e[1].y);a.push("M ",e[0].x," ",e[0].y," ");for(var c=1,h=e.length;c<h;c++){var g=d.midPointFrom(b);a.push("Q ",d.x," ",d.y," ",g.x," ",g.y," ");d=new f.Point(e[c].x,e[c].y);c+1<e.length&&(b=new f.Point(e[c+1].x,e[c+1].y))}a.push("L ",d.x," ",d.y," ");return a},createPath:function(e){e=new f.Path(e);e.fill=null;e.stroke=this.color;e.strokeWidth=this.width;e.strokeLineCap=this.strokeLineCap;
e.strokeLineJoin=this.strokeLineJoin;if(this.shadow)this.shadow.affectStroke=!0,e.setShadow(this.shadow);return e},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath();var e=this.convertPointsToSVGPath(this._points).join("");e==="M 0 0 Q 0 0 0 0 L 0 0"?this.canvas.renderAll():(e=this.createPath(e),this.canvas.add(e),e.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:e}))}})})();f.CircleBrush=
f.util.createClass(f.BaseBrush,{width:10,initialize:function(e){this.canvas=e;this.points=[]},drawDot:function(e){var e=this.addPoint(e),a=this.canvas.contextTop,d=this.canvas.viewportTransform;a.save();a.transform(d[0],d[1],d[2],d[3],d[4],d[5]);a.fillStyle=e.fill;a.beginPath();a.arc(e.x,e.y,e.radius,0,Math.PI*2,!1);a.closePath();a.fill();a.restore()},onMouseDown:function(e){this.points.length=0;this.canvas.clearContext(this.canvas.contextTop);this._setShadow();this.drawDot(e)},onMouseMove:function(e){this.drawDot(e)},
onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],d=0,b=this.points.length;d<b;d++){var c=this.points[d],c=new f.Circle({radius:c.radius,left:c.x,top:c.y,originX:"center",originY:"center",fill:c.fill});this.shadow&&c.setShadow(this.shadow);a.push(c)}a=new f.Group(a,{originX:"center",originY:"center"});a.canvas=this.canvas;this.canvas.add(a);this.canvas.fire("path:created",{path:a});this.canvas.clearContext(this.canvas.contextTop);this._resetShadow();
this.canvas.renderOnAddRemove=e;this.canvas.renderAll()},addPoint:function(e){var e=new f.Point(e.x,e.y),a=f.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=(new f.Color(this.color)).setAlpha(f.util.getRandomInt(0,100)/100).toRgba();e.radius=a;e.fill=d;this.points.push(e);return e}});f.SprayBrush=f.util.createClass(f.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e;this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=
0;this.canvas.clearContext(this.canvas.contextTop);this._setShadow();this.addSprayChunk(e);this.render()},onMouseMove:function(e){this.addSprayChunk(e);this.render()},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],d=0,b=this.sprayChunks.length;d<b;d++)for(var c=this.sprayChunks[d],h=0,g=c.length;h<g;h++){var i=new f.Rect({width:c[h].width,height:c[h].width,left:c[h].x+1,top:c[h].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&
i.setShadow(this.shadow);a.push(i)}this.optimizeOverlapping&&(a=this._getOptimizedRects(a));a=new f.Group(a,{originX:"center",originY:"center"});a.canvas=this.canvas;this.canvas.add(a);this.canvas.fire("path:created",{path:a});this.canvas.clearContext(this.canvas.contextTop);this._resetShadow();this.canvas.renderOnAddRemove=e;this.canvas.renderAll()},_getOptimizedRects:function(e){for(var a={},d,b=0,c=e.length;b<c;b++)d=e[b].left+""+e[b].top,a[d]||(a[d]=e[b]);e=[];for(d in a)e.push(a[d]);return e},
render:function(){var e=this.canvas.contextTop;e.fillStyle=this.color;var a=this.canvas.viewportTransform;e.save();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]);for(var a=0,d=this.sprayChunkPoints.length;a<d;a++){var b=this.sprayChunkPoints[a];if(typeof b.opacity!=="undefined")e.globalAlpha=b.opacity;e.fillRect(b.x,b.y,b.width,b.width)}e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];for(var a,d,b,c=this.width/2,h=0;h<this.density;h++){a=f.util.getRandomInt(e.x-c,e.x+c);d=f.util.getRandomInt(e.y-
c,e.y+c);b=this.dotWidthVariance?f.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;a=new f.Point(a,d);a.width=b;if(this.randomOpacity)a.opacity=f.util.getRandomInt(0,100)/100;this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}});f.PatternBrush=f.util.createClass(f.PencilBrush,{getPatternSrc:function(){var e=f.document.createElement("canvas"),a=e.getContext("2d");e.width=e.height=25;a.fillStyle=this.color;
a.beginPath();a.arc(10,10,10,0,Math.PI*2,!1);a.closePath();a.fill();return e},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles");this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(e){e=this.callSuper("createPath",e);e.stroke=new f.Pattern({source:this.source||
this.getPatternSrcFunction()});return e}});(function(){var e=f.util.getPointer,a=f.util.degreesToRadians,d=f.util.radiansToDegrees,b=Math.atan2,c=Math.abs;f.Canvas=f.util.createClass(f.StaticCanvas,{initialize:function(a,c){c||(c={});this._initStatic(a,c);this._initInteractive();this._createCacheCanvas();f.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",
selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._groupSelector=this._currentTransform=null;this._initWrapperElement();this._createUpperCanvas();this._initEventListeners();this.freeDrawingBrush=f.PencilBrush&&new f.PencilBrush(this);this.calcOffset()},_resetCurrentTransform:function(a){var c=
this._currentTransform;c.target.set({scaleX:c.original.scaleX,scaleY:c.original.scaleY,left:c.original.left,top:c.original.top});if(this._shouldCenterTransform(a,c.target))if(c.action==="rotate")this._setOriginToCenter(c.target);else{if(c.originX!=="center")c.mouseXSign=c.originX==="right"?-1:1;if(c.originY!=="center")c.mouseYSign=c.originY==="bottom"?-1:1;c.originX="center";c.originY="center"}else c.originX=c.original.originX,c.originY=c.original.originY},containsPoint:function(a,c){var b=this.getPointer(a,
!0),d=this._normalizePointer(c,b);return c.containsPoint(d)||c._findTargetCorner(b)},_normalizePointer:function(a,c){var b=this.getActiveGroup(),d=c.x,h=c.y;b&&a.type!=="group"&&b.contains(a)&&(b=new f.Point(b.left,b.top),b=f.util.transformPoint(b,this.viewportTransform,!0),d-=b.x,h-=b.y);return{x:d,y:h}},isTargetTransparent:function(a,c,b){var d=a.hasBorders,h=a.transparentCorners;a.hasBorders=a.transparentCorners=!1;this._draw(this.contextCache,a);a.hasBorders=d;a.transparentCorners=h;a=f.util.isTransparent(this.contextCache,
c,b,this.targetFindTolerance);this.clearContext(this.contextCache);return a},_shouldClearSelection:function(a,c){var b=this.getActiveGroup(),d=this.getActiveObject();return!c||c&&b&&!b.contains(c)&&b!==c&&!a.shiftKey||c&&!c.evented||c&&!c.selectable&&d&&d!==c},_shouldCenterTransform:function(a,c){if(c){var b=this._currentTransform,d;b.action==="scale"||b.action==="scaleX"||b.action==="scaleY"?d=this.centeredScaling||c.centeredScaling:b.action==="rotate"&&(d=this.centeredRotation||c.centeredRotation);
return d?!a.altKey:a.altKey}},_getOriginFromCorner:function(a,c){var b={x:a.originX,y:a.originY};if(c==="ml"||c==="tl"||c==="bl")b.x="right";else if(c==="mr"||c==="tr"||c==="br")b.x="left";if(c==="tl"||c==="mt"||c==="tr")b.y="bottom";else if(c==="bl"||c==="mb"||c==="br")b.y="top";return b},_getActionFromCorner:function(a,c){var b="drag";c&&(b=c==="ml"||c==="mr"?"scaleX":c==="mt"||c==="mb"?"scaleY":c==="mtr"?"rotate":"scale");return b},_setupCurrentTransform:function(c,b){if(b){var d=this.getPointer(c),
h=b._findTargetCorner(this.getPointer(c,!0)),e=this._getActionFromCorner(b,h),h=this._getOriginFromCorner(b,h);this._currentTransform={target:b,action:e,scaleX:b.scaleX,scaleY:b.scaleY,offsetX:d.x-b.left,offsetY:d.y-b.top,originX:h.x,originY:h.y,ex:d.x,ey:d.y,left:b.left,top:b.top,theta:a(b.angle),width:b.width*b.scaleX,mouseXSign:1,mouseYSign:1};this._currentTransform.original={left:b.left,top:b.top,scaleX:b.scaleX,scaleY:b.scaleY,originX:h.x,originY:h.y};this._resetCurrentTransform(c)}},_translateObject:function(a,
c){var b=this._currentTransform.target;b.get("lockMovementX")||b.set("left",a-this._currentTransform.offsetX);b.get("lockMovementY")||b.set("top",c-this._currentTransform.offsetY)},_scaleObject:function(a,c,b){var d=this._currentTransform,h=d.target,e=h.get("lockScalingX"),p=h.get("lockScalingY"),q=h.get("lockScalingFlip");if(!e||!p){var x=h.translateToOriginPoint(h.getCenterPoint(),d.originX,d.originY),a=h.toLocalPoint(new f.Point(a,c),d.originX,d.originY);this._setLocalMouse(a,d);this._setObjectScale(a,
d,e,p,b,q);h.setPositionByOrigin(x,d.originX,d.originY)}},_setObjectScale:function(a,c,b,d,h,e){var f=c.target,q=!1,x=!1;c.newScaleX=a.x/(f.width+f.strokeWidth);c.newScaleY=a.y/(f.height+f.strokeWidth);e&&c.newScaleX<=0&&c.newScaleX<f.scaleX&&(q=!0);e&&c.newScaleY<=0&&c.newScaleY<f.scaleY&&(x=!0);h==="equally"&&!b&&!d?q||x||this._scaleObjectEqually(a,f,c):h?h==="x"&&!f.get("lockUniScaling")?q||b||f.set("scaleX",c.newScaleX):h==="y"&&!f.get("lockUniScaling")&&(x||d||f.set("scaleY",c.newScaleY)):(q||
b||f.set("scaleX",c.newScaleX),x||d||f.set("scaleY",c.newScaleY));q||x||this._flipObject(c,h)},_scaleObjectEqually:function(a,c,b){var a=a.y+a.x,d=(c.height+c.strokeWidth)*b.original.scaleY+(c.width+c.strokeWidth)*b.original.scaleX;b.newScaleX=b.original.scaleX*a/d;b.newScaleY=b.original.scaleY*a/d;c.set("scaleX",b.newScaleX);c.set("scaleY",b.newScaleY)},_flipObject:function(a,c){if(a.newScaleX<0&&c!=="y")if(a.originX==="left")a.originX="right";else if(a.originX==="right")a.originX="left";if(a.newScaleY<
0&&c!=="x")if(a.originY==="top")a.originY="bottom";else if(a.originY==="bottom")a.originY="top"},_setLocalMouse:function(a,b){var d=b.target;if(b.originX==="right")a.x*=-1;else if(b.originX==="center"&&(a.x*=b.mouseXSign*2,a.x<0))b.mouseXSign=-b.mouseXSign;if(b.originY==="bottom")a.y*=-1;else if(b.originY==="center"&&(a.y*=b.mouseYSign*2,a.y<0))b.mouseYSign=-b.mouseYSign;c(a.x)>d.padding?a.x<0?a.x+=d.padding:a.x-=d.padding:a.x=0;c(a.y)>d.padding?a.y<0?a.y+=d.padding:a.y-=d.padding:a.y=0},_rotateObject:function(a,
c){var h=this._currentTransform;if(!h.target.get("lockRotation")){var e=b(h.ey-h.top,h.ex-h.left),f=b(c-h.top,a-h.left),e=d(f-e+h.theta);e<0&&(e=360+e);h.target.angle=e}},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=1;a.scaleY=1;a.setAngle(0)},_drawSelection:function(){var a=this.contextTop,b=this._groupSelector,d=b.left,h=b.top,e=c(d),o=c(h);a.fillStyle=this.selectionColor;a.fillRect(b.ex-(d>0?0:-d),b.ey-(h>0?0:-h),e,o);a.lineWidth=this.selectionLineWidth;
a.strokeStyle=this.selectionBorderColor;this.selectionDashArray.length>1?(d=b.ex+0.5-(d>0?0:e),b=b.ey+0.5-(h>0?0:o),a.beginPath(),f.util.drawDashedLine(a,d,b,d+e,b,this.selectionDashArray),f.util.drawDashedLine(a,d,b+o-1,d+e,b+o-1,this.selectionDashArray),f.util.drawDashedLine(a,d,b,d,b+o,this.selectionDashArray),f.util.drawDashedLine(a,d+e-1,b,d+e-1,b+o,this.selectionDashArray),a.closePath(),a.stroke()):a.strokeRect(b.ex+0.5-(d>0?0:e),b.ey+0.5-(h>0?0:o),e,o)},_isLastRenderedObject:function(a){return this.controlsAboveOverlay&&
this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(a,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(a,!0))},findTarget:function(a,c){if(!this.skipTargetFind){if(this._isLastRenderedObject(a))return this.lastRenderedObjectWithControlsAboveOverlay;var b=this.getActiveGroup();if(b&&!c&&this.containsPoint(a,b))return b;b=this._searchPossibleTargets(a);
this._fireOverOutEvents(b);return b}},_fireOverOutEvents:function(a){if(a){if(this._hoveredTarget!==a)this.fire("mouse:over",{target:a}),a.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=a}else if(this._hoveredTarget)this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null},_checkTarget:function(a,c,b){if(c&&c.visible&&c.evented&&this.containsPoint(a,
c))if((this.perPixelTargetFind||c.perPixelTargetFind)&&!c.isEditing){if(!this.isTargetTransparent(c,b.x,b.y))return!0}else return!0},_searchPossibleTargets:function(a){for(var c,b=this.getPointer(a,!0),d=this._objects.length;d--;)if(this._checkTarget(a,this._objects[d],b)){this.relatedTarget=this._objects[d];c=this._objects[d];break}return c},getPointer:function(a,c,b){var d,h;if(!b)b=this.upperCanvasEl;var a=e(a,b),o=b.getBoundingClientRect(),p=o.width||0,q=o.height||0;if(!p||!q)"top"in o&&"bottom"in
o&&(q=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(p=Math.abs(o.right-o.left));this.calcOffset();a.x-=this._offset.left;a.y-=this._offset.top;c||(a=f.util.transformPoint(a,f.util.invertTransform(this.viewportTransform)));p===0||q===0?(d=1,h=1):(d=b.width/p,h=b.height/q);return{x:a.x*d,y:a.y*h}},_createUpperCanvas:function(){var a=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement();f.util.addClass(this.upperCanvasEl,"upper-canvas "+a);
this.wrapperEl.appendChild(this.upperCanvasEl);this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl);this._applyCanvasStyle(this.upperCanvasEl);this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement();this.cacheCanvasEl.setAttribute("width",this.width);this.cacheCanvasEl.setAttribute("height",this.height);this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=f.util.wrapElement(this.lowerCanvasEl,
"div",{"class":this.containerClass});f.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});f.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(a){var c=this.getWidth()||a.width,b=this.getHeight()||a.height;f.util.setStyle(a,{position:"absolute",width:c+"px",height:b+"px",left:0,top:0});a.width=c;a.height=b;f.util.makeElementUnselectable(a)},_copyCanvasStyle:function(a,c){c.style.cssText=a.style.cssText},getSelectionContext:function(){return this.contextTop},
getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=a;a.set("active",!0)},setActiveObject:function(a,c){this._setActiveObject(a);this.renderAll();this.fire("object:selected",{target:a,e:c});a.fire("selected",{e:c});return this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=null},
discardActiveObject:function(a){this._discardActiveObject();this.renderAll();this.fire("selection:cleared",{e:a});return this},_setActiveGroup:function(a){(this._activeGroup=a)&&a.set("active",!0)},setActiveGroup:function(a,c){this._setActiveGroup(a);a&&(this.fire("object:selected",{target:a,e:c}),a.fire("selected",{e:c}));return this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var a=this.getActiveGroup();a&&a.destroy();this.setActiveGroup(null)},discardActiveGroup:function(a){this._discardActiveGroup();
this.fire("selection:cleared",{e:a});return this},deactivateAll:function(){for(var a=this.getObjects(),c=0,b=a.length;c<b;c++)a[c].set("active",!1);this._discardActiveGroup();this._discardActiveObject();return this},deactivateAllWithDispatch:function(a){var c=this.getActiveGroup()||this.getActiveObject();c&&this.fire("before:selection:cleared",{target:c,e:a});this.deactivateAll();c&&this.fire("selection:cleared",{e:a});return this},drawControls:function(a){var c=this.getActiveGroup();c?this._drawGroupControls(a,
c):this._drawObjectsControls(a)},_drawGroupControls:function(a,c){c._renderControls(a)},_drawObjectsControls:function(a){for(var c=0,b=this._objects.length;c<b;++c)if(this._objects[c]&&this._objects[c].active)this._objects[c]._renderControls(a),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[c]}});for(var h in f.StaticCanvas)h!=="prototype"&&(f.Canvas[h]=f.StaticCanvas[h]);if(f.isTouchSupported)f.Canvas.prototype._setCursorFromEvent=function(){};f.Element=f.Canvas})();(function(){var e=
{mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},a=f.util.addListener,d=f.util.removeListener;f.util.object.extend(f.Canvas.prototype,{cursorMap:"n-resize,ne-resize,e-resize,se-resize,s-resize,sw-resize,w-resize,nw-resize".split(","),_initEventListeners:function(){this._bindEvents();a(f.window,"resize",this._onResize);a(this.upperCanvasEl,"mousedown",this._onMouseDown);a(this.upperCanvasEl,"mousemove",this._onMouseMove);a(this.upperCanvasEl,"mousewheel",this._onMouseWheel);a(this.upperCanvasEl,"touchstart",
this._onMouseDown);a(this.upperCanvasEl,"touchmove",this._onMouseMove);typeof Event!=="undefined"&&"add"in Event&&(Event.add(this.upperCanvasEl,"gesture",this._onGesture),Event.add(this.upperCanvasEl,"drag",this._onDrag),Event.add(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.add(this.upperCanvasEl,"shake",this._onShake))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);
this._onResize=this._onResize.bind(this);this._onGesture=this._onGesture.bind(this);this._onDrag=this._onDrag.bind(this);this._onShake=this._onShake.bind(this);this._onOrientationChange=this._onOrientationChange.bind(this);this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){d(f.window,"resize",this._onResize);d(this.upperCanvasEl,"mousedown",this._onMouseDown);d(this.upperCanvasEl,"mousemove",this._onMouseMove);d(this.upperCanvasEl,"mousewheel",this._onMouseWheel);d(this.upperCanvasEl,
"touchstart",this._onMouseDown);d(this.upperCanvasEl,"touchmove",this._onMouseMove);typeof Event!=="undefined"&&"remove"in Event&&(Event.remove(this.upperCanvasEl,"gesture",this._onGesture),Event.remove(this.upperCanvasEl,"drag",this._onDrag),Event.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.remove(this.upperCanvasEl,"shake",this._onShake))},_onGesture:function(a,c){this.__onTransformGesture&&this.__onTransformGesture(a,c)},_onDrag:function(a,c){this.__onDrag&&this.__onDrag(a,
c)},_onMouseWheel:function(a,c){this.__onMouseWheel&&this.__onMouseWheel(a,c)},_onOrientationChange:function(a,c){this.__onOrientationChange&&this.__onOrientationChange(a,c)},_onShake:function(a,c){this.__onShake&&this.__onShake(a,c)},_onMouseDown:function(b){this.__onMouseDown(b);a(f.document,"touchend",this._onMouseUp);a(f.document,"touchmove",this._onMouseMove);d(this.upperCanvasEl,"mousemove",this._onMouseMove);d(this.upperCanvasEl,"touchmove",this._onMouseMove);b.type==="touchstart"?d(this.upperCanvasEl,
"mousedown",this._onMouseDown):(a(f.document,"mouseup",this._onMouseUp),a(f.document,"mousemove",this._onMouseMove))},_onMouseUp:function(b){this.__onMouseUp(b);d(f.document,"mouseup",this._onMouseUp);d(f.document,"touchend",this._onMouseUp);d(f.document,"mousemove",this._onMouseMove);d(f.document,"touchmove",this._onMouseMove);a(this.upperCanvasEl,"mousemove",this._onMouseMove);a(this.upperCanvasEl,"touchmove",this._onMouseMove);if(b.type==="touchend"){var c=this;setTimeout(function(){a(c.upperCanvasEl,
"mousedown",c._onMouseDown)},400)}},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault();this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a,c){var d=this.getActiveGroup()||this.getActiveObject();return!!(a&&(a.isMoving||a!==d)||!a&&d||!a&&!d&&!this._groupSelector||c&&this._previousPointer&&this.selection&&(c.x!==this._previousPointer.x||c.y!==this._previousPointer.y))},__onMouseUp:function(a){var c;if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(a);
else{this._currentTransform?(this._finalizeCurrentTransform(),c=this._currentTransform.target):c=this.findTarget(a,!0);var d=this._shouldRender(c,this.getPointer(a));this._maybeGroupObjects(a);if(c)c.isMoving=!1;d&&this.renderAll();this._handleCursorAndEvent(a,c)}},_handleCursorAndEvent:function(a,c){this._setCursorFromEvent(a,c);var d=this;setTimeout(function(){d._setCursorFromEvent(a,c)},50);this.fire("mouse:up",{target:c,e:a});c&&c.fire("mouseup",{e:a})},_finalizeCurrentTransform:function(){var a=
this._currentTransform.target;if(a._scaling)a._scaling=!1;a.setCoords();this.stateful&&a.hasStateChanged()&&(this.fire("object:modified",{target:a}),a.fire("modified"));this._restoreOriginXY(a)},_restoreOriginXY:function(a){if(this._previousOriginX&&this._previousOriginY){var c=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=c.x;a.top=c.y;this._previousOriginY=this._previousOriginX=null}},
_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0;this.discardActiveObject(a).renderAll();this.clipTo&&f.util.clipContext(this,this.contextTop);var c=f.util.invertTransform(this.viewportTransform);this.freeDrawingBrush.onMouseDown(f.util.transformPoint(this.getPointer(a,!0),c));this.fire("mouse:down",{e:a})},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var c=f.util.invertTransform(this.viewportTransform);this.freeDrawingBrush.onMouseMove(f.util.transformPoint(this.getPointer(a,
!0),c))}this.setCursor(this.freeDrawingCursor);this.fire("mouse:move",{e:a})},_onMouseUpInDrawingMode:function(a){this._isCurrentlyDrawing=!1;this.clipTo&&this.contextTop.restore();this.freeDrawingBrush.onMouseUp();this.fire("mouse:up",{e:a})},__onMouseDown:function(a){if(("which"in a?a.which===1:a.button===1)||f.isTouchSupported)if(this.isDrawingMode)this._onMouseDownInDrawingMode(a);else if(!this._currentTransform){var c=this.findTarget(a),d=this.getPointer(a,!0);this._previousPointer=d;var g=this._shouldRender(c,
d),i=this._shouldGroup(a,c);this._shouldClearSelection(a,c)?this._clearSelection(a,c,d):i&&(this._handleGrouping(a,c),c=this.getActiveGroup());c&&c.selectable&&!i&&(this._beforeTransform(a,c),this._setupCurrentTransform(a,c));g&&this.renderAll();this.fire("mouse:down",{target:c,e:a});c&&c.fire("mousedown",{e:a})}},_beforeTransform:function(a,c){this.stateful&&c.saveState();if(c._findTargetCorner(this.getPointer(a)))this.onBeforeScaleRotate(c);c!==this.getActiveGroup()&&c!==this.getActiveObject()&&
(this.deactivateAll(),this.setActiveObject(c,a))},_clearSelection:function(a,c,d){this.deactivateAllWithDispatch(a);if(c&&c.selectable)this.setActiveObject(c,a);else if(this.selection)this._groupSelector={ex:d.x,ey:d.y,top:0,left:0}},_setOriginToCenter:function(a){this._previousOriginX=this._currentTransform.target.originX;this._previousOriginY=this._currentTransform.target.originY;var c=a.getCenterPoint();a.originX="center";a.originY="center";a.left=c.x;a.top=c.y;this._currentTransform.left=a.left;
this._currentTransform.top=a.top},_setCenterToOrigin:function(a){var c=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=c.x;a.top=c.y;this._previousOriginY=this._previousOriginX=null},__onMouseMove:function(a){var c,d;if(this.isDrawingMode)this._onMouseMoveInDrawingMode(a);else{var g=this._groupSelector;g?(d=this.getPointer(a,!0),g.left=d.x-g.ex,g.top=d.y-g.ey,this.renderTop()):this._currentTransform?
this._transformObject(a):(c=this.findTarget(a),!c||c&&!c.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(a,c));this.fire("mouse:move",{target:c,e:a});c&&c.fire("mousemove",{e:a})}},_transformObject:function(a){var c=this.getPointer(a),d=this._currentTransform;d.reset=!1;d.target.isMoving=!0;this._beforeScaleTransform(a,d);this._performTransformAction(a,d,c);this.renderAll()},_performTransformAction:function(a,c,d){var g=d.x,d=d.y,i=c.target,e=c.action;e==="rotate"?(this._rotateObject(g,
d),this._fire("rotating",i,a)):e==="scale"?(this._onScale(a,c,g,d),this._fire("scaling",i,a)):e==="scaleX"?(this._scaleObject(g,d,"x"),this._fire("scaling",i,a)):e==="scaleY"?(this._scaleObject(g,d,"y"),this._fire("scaling",i,a)):(this._translateObject(g,d),this._fire("moving",i,a),this.setCursor(this.moveCursor))},_fire:function(a,c,d){this.fire("object:"+a,{target:c,e:d});c.fire(a,{e:d})},_beforeScaleTransform:function(a,c){if(c.action==="scale"||c.action==="scaleX"||c.action==="scaleY"){var d=
this._shouldCenterTransform(a,c.target);if(d&&(c.originX!=="center"||c.originY!=="center")||!d&&c.originX==="center"&&c.originY==="center")this._resetCurrentTransform(a),c.reset=!0}},_onScale:function(a,c,d,g){(a.shiftKey||this.uniScaleTransform)&&!c.target.get("lockUniScaling")?(c.currentAction="scale",this._scaleObject(d,g)):(!c.reset&&c.currentAction==="scale"&&this._resetCurrentTransform(a,c.target),c.currentAction="scaleEqually",this._scaleObject(d,g,"equally"))},_setCursorFromEvent:function(a,
c){if(!c||!c.selectable)return this.setCursor(this.defaultCursor),!1;else{var d=this.getActiveGroup();(d=c._findTargetCorner&&(!d||!d.contains(c))&&c._findTargetCorner(this.getPointer(a,!0)))?this._setCornerCursor(d,c):this.setCursor(c.hoverCursor||this.hoverCursor)}return!0},_setCornerCursor:function(a,c){if(a in e)this.setCursor(this._getRotatedCornerCursor(a,c));else if(a==="mtr"&&c.hasRotatingPoint)this.setCursor(this.rotationCursor);else return this.setCursor(this.defaultCursor),!1},_getRotatedCornerCursor:function(a,
c){var d=Math.round(c.getAngle()%360/45);d<0&&(d+=8);d+=e[a];d%=8;return this.cursorMap[d]}})})();(function(){var e=Math.min,a=Math.max;f.util.object.extend(f.Canvas.prototype,{_shouldGroup:function(a,b){var c=this.getActiveObject();return a.shiftKey&&(this.getActiveGroup()||c&&c!==b)&&this.selection},_handleGrouping:function(a,b){if(b===this.getActiveGroup()&&(b=this.findTarget(a,!0),!b||b.isType("group")))return;this.getActiveGroup()?this._updateActiveGroup(b,a):this._createActiveGroup(b,a);this._activeGroup&&
this._activeGroup.saveCoords()},_updateActiveGroup:function(a,b){var c=this.getActiveGroup();if(c.contains(a)){if(c.removeWithUpdate(a),this._resetObjectTransform(c),a.set("active",!1),c.size()===1){this.discardActiveGroup(b);this.setActiveObject(c.item(0));return}}else c.addWithUpdate(a),this._resetObjectTransform(c);this.fire("selection:created",{target:c,e:b});c.set("active",!0)},_createActiveGroup:function(a,b){if(this._activeObject&&a!==this._activeObject){var c=this._createGroup(a);c.addWithUpdate();
this.setActiveGroup(c);this._activeObject=null;this.fire("selection:created",{target:c,e:b})}a.set("active",!0)},_createGroup:function(a){var b=this.getObjects(),a=b.indexOf(this._activeObject)<b.indexOf(a)?[this._activeObject,a]:[a,this._activeObject];return new f.Group(a,{originX:"center",originY:"center",canvas:this})},_groupSelectedObjects:function(a){var b=this._collectObjects();b.length===1?this.setActiveObject(b[0],a):b.length>1&&(b=new f.Group(b.reverse(),{originX:"center",originY:"center",
canvas:this}),b.addWithUpdate(),this.setActiveGroup(b,a),b.saveCoords(),this.fire("selection:created",{target:b}),this.renderAll())},_collectObjects:function(){var d=[],b;b=this._groupSelector.ex;for(var c=this._groupSelector.ey,h=b+this._groupSelector.left,g=c+this._groupSelector.top,i=new f.Point(e(b,h),e(c,g)),k=new f.Point(a(b,h),a(c,g)),c=b===h&&c===g,h=this._objects.length;h--;)if((b=this._objects[h])&&b.selectable&&b.visible&&(b.intersectsWithRect(i,k)||b.isContainedWithinRect(i,k)||b.containsPoint(i)||
b.containsPoint(k)))if(b.set("active",!0),d.push(b),c)break;return d},_maybeGroupObjects:function(a){this.selection&&this._groupSelector&&this._groupSelectedObjects(a);if(a=this.getActiveGroup())a.setObjectsCoords().setCoords(),a.isMoving=!1,this.setCursor(this.defaultCursor);this._currentTransform=this._groupSelector=null}})})();f.util.object.extend(f.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var a=e.format||"png",d=e.quality||1,b=e.multiplier||1,e={left:e.left,top:e.top,width:e.width,
height:e.height};return b!==1?this.__toDataURLWithMultiplier(a,d,e,b):this.__toDataURL(a,d,e)},__toDataURL:function(e,a,d){this.renderAll(!0);var b=this.upperCanvasEl||this.lowerCanvasEl,d=this.__getCroppedCanvas(b,d);e==="jpg"&&(e="jpeg");e=f.StaticCanvas.supports("toDataURLWithQuality")?(d||b).toDataURL("image/"+e,a):(d||b).toDataURL("image/"+e);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return e},__getCroppedCanvas:function(e,a){var d,b;if("left"in a||"top"in a||"width"in
a||"height"in a)d=f.util.createCanvasElement(),b=d.getContext("2d"),d.width=a.width||this.width,d.height=a.height||this.height,b.drawImage(e,-a.left||0,-a.top||0);return d},__toDataURLWithMultiplier:function(e,a,d,b){var c=this.getWidth(),h=this.getHeight(),g=c*b,i=h*b,k=this.getActiveObject(),f=this.getActiveGroup(),n=this.contextTop||this.contextContainer;b>1&&this.setWidth(g).setHeight(i);n.scale(b,b);d.left&&(d.left*=b);d.top&&(d.top*=b);if(d.width)d.width*=b;else if(b<1)d.width=g;if(d.height)d.height*=
b;else if(b<1)d.height=i;f?this._tempRemoveBordersControlsFromGroup(f):k&&this.deactivateAll&&this.deactivateAll();this.renderAll(!0);e=this.__toDataURL(e,a,d);this.width=c;this.height=h;n.scale(1/b,1/b);this.setWidth(c).setHeight(h);f?this._restoreBordersControlsOnGroup(f):k&&this.setActiveObject&&this.setActiveObject(k);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return e},toDataURLWithMultiplier:function(e,a,d){return this.toDataURL({format:e,multiplier:a,quality:d})},
_tempRemoveBordersControlsFromGroup:function(e){e.origHasControls=e.hasControls;e.origBorderColor=e.borderColor;e.hasControls=!0;e.borderColor="rgba(0,0,0,0)";e.forEachObject(function(a){a.origBorderColor=a.borderColor;a.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(e){e.hideControls=e.origHideControls;e.borderColor=e.origBorderColor;e.forEachObject(function(a){a.borderColor=a.origBorderColor;delete a.origBorderColor})}});f.util.object.extend(f.StaticCanvas.prototype,{loadFromDatalessJSON:function(e,
a,d){return this.loadFromJSON(e,a,d)},loadFromJSON:function(e,a,d){if(e){var b=typeof e==="string"?JSON.parse(e):e;this.clear();var c=this;this._enlivenObjects(b.objects,function(){c._setBgOverlay(b,a)},d);return this}},_setBgOverlay:function(e,a){var d=this,b={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!e.backgroundImage&&!e.overlayImage&&!e.background&&!e.overlay)a&&a();else{var c=function(){b.backgroundImage&&b.overlayImage&&b.backgroundColor&&b.overlayColor&&(d.renderAll(),
a&&a())};this.__setBgOverlay("backgroundImage",e.backgroundImage,b,c);this.__setBgOverlay("overlayImage",e.overlayImage,b,c);this.__setBgOverlay("backgroundColor",e.background,b,c);this.__setBgOverlay("overlayColor",e.overlay,b,c);c()}},__setBgOverlay:function(e,a,d,b){var c=this;if(a)if(e==="backgroundImage"||e==="overlayImage")f.Image.fromObject(a,function(a){c[e]=a;d[e]=!0;b&&b()});else this["set"+f.util.string.capitalize(e,!0)](a,function(){d[e]=!0;b&&b()});else d[e]=!0},_enlivenObjects:function(e,
a,d){var b=this;if(!e||e.length===0)a&&a();else{var c=this.renderOnAddRemove;this.renderOnAddRemove=!1;f.util.enlivenObjects(e,function(d){d.forEach(function(a,c){b.insertAt(a,c,!0)});b.renderOnAddRemove=c;a&&a()},null,d)}},_toDataURL:function(e,a){this.clone(function(d){a(d.toDataURL(e))})},_toDataURLWithMultiplier:function(e,a,d){this.clone(function(b){d(b.toDataURLWithMultiplier(e,a))})},clone:function(e,a){var d=JSON.stringify(this.toJSON(a));this.cloneWithoutData(function(a){a.loadFromJSON(d,
function(){e&&e(a)})})},cloneWithoutData:function(e){var a=f.document.createElement("canvas");a.width=this.getWidth();a.height=this.getHeight();var d=new f.Canvas(a);d.clipTo=this.clipTo;this.backgroundImage?(d.setBackgroundImage(this.backgroundImage.src,function(){d.renderAll();e&&e(d)}),d.backgroundImageOpacity=this.backgroundImageOpacity,d.backgroundImageStretch=this.backgroundImageStretch):e&&e(d)}});(function(e){var a=e.fabric||(e.fabric={}),e=a.util.object.extend,d=a.util.toFixed,b=a.util.string.capitalize,
c=a.util.degreesToRadians,h=a.StaticCanvas.supports("setLineDash");if(!a.Object)a.Object=a.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",
stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:0.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),
initialize:function(a){a&&this.setOptions(a)},_initGradient:function(c){c.fill&&c.fill.colorStops&&!(c.fill instanceof a.Gradient)&&this.set("fill",new a.Gradient(c.fill))},_initPattern:function(c){c.fill&&c.fill.source&&!(c.fill instanceof a.Pattern)&&this.set("fill",new a.Pattern(c.fill));c.stroke&&c.stroke.source&&!(c.stroke instanceof a.Pattern)&&this.set("stroke",new a.Pattern(c.stroke))},_initClipping:function(c){if(c.clipTo&&typeof c.clipTo==="string"&&(c=a.util.getFunctionBody(c.clipTo),typeof c!==
"undefined"))this.clipTo=new Function("ctx",c)},setOptions:function(a){for(var c in a)this.set(c,a[c]);this._initGradient(a);this._initPattern(a);this._initClipping(a)},transform:function(a,b){this.group&&this.group.transform(a,b);var d=b?this._getLeftTopCoords():this.getCenterPoint();a.translate(d.x,d.y);a.rotate(c(this.angle));a.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(c){var b=a.Object.NUM_FRACTION_DIGITS,b={type:this.type,originX:this.originX,originY:this.originY,
left:d(this.left,b),top:d(this.top,b),width:d(this.width,b),height:d(this.height,b),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:d(this.strokeWidth,b),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:d(this.strokeMiterLimit,b),scaleX:d(this.scaleX,b),scaleY:d(this.scaleY,b),angle:d(this.getAngle(),b),flipX:this.flipX,
flipY:this.flipY,opacity:d(this.opacity,b),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};this.includeDefaultValues||(b=this._removeDefaultValues(b));a.util.populateWithProperties(this,b,c);return b},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(c){var b=a.util.getKlass(c.type).prototype;
b.stateProperties.forEach(function(a){c[a]===b[a]&&delete c[a]});return c},toString:function(){return"#<fabric."+b(this.type)+">"},get:function(a){return this[a]},_setObject:function(a){for(var c in a)this._set(c,a[c])},set:function(a,c){typeof a==="object"?this._setObject(a):typeof c==="function"&&a!=="clipTo"?this._set(a,c(this.get(a))):this._set(a,c);return this},_set:function(c,b){(c==="scaleX"||c==="scaleY")&&(b=this._constrainScale(b));c==="scaleX"&&b<0?(this.flipX=!this.flipX,b*=-1):c==="scaleY"&&
b<0?(this.flipY=!this.flipY,b*=-1):c==="width"||c==="height"?this.minScaleLimit=d(Math.min(0.1,1/Math.max(this.width,this.height)),2):c==="shadow"&&b&&!(b instanceof a.Shadow)&&(b=new a.Shadow(b));this[c]=b;return this},toggle:function(a){var c=this.get(a);typeof c==="boolean"&&this.set(a,!c);return this},setSourcePath:function(a){this.sourcePath=a;return this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(c,
b){this.width===0||this.height===0||!this.visible||(c.save(),this._setupCompositeOperation(c),b||this.transform(c),this._setStrokeStyles(c),this._setFillStyles(c),this.group&&this.group.type==="path-group"&&c.translate(-this.group.width/2,-this.group.height/2),this.transformMatrix&&c.transform.apply(c,this.transformMatrix),this._setOpacity(c),this._setShadow(c),this.clipTo&&a.util.clipContext(this,c),this._render(c,b),this.clipTo&&c.restore(),this._removeShadow(c),this._restoreCompositeOperation(c),
c.restore())},_setOpacity:function(a){this.group&&this.group._setOpacity(a);a.globalAlpha*=this.opacity},_setStrokeStyles:function(a){if(this.stroke)a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,a.miterLimit=this.strokeMiterLimit,a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a,this):this.stroke},_setFillStyles:function(a){if(this.fill)a.fillStyle=this.fill.toLive?this.fill.toLive(a,this):this.fill},_renderControls:function(b,d){var h=this.getViewportTransform();
b.save();if(this.active&&!d){var e;this.group&&(e=a.util.transformPoint(this.group.getCenterPoint(),h),b.translate(e.x,e.y),b.rotate(c(this.group.angle)));e=a.util.transformPoint(this.getCenterPoint(),h,null!=this.group);this.group&&(e.x*=this.group.scaleX,e.y*=this.group.scaleY);b.translate(e.x,e.y);b.rotate(c(this.angle));this.drawBorders(b);this.drawControls(b)}b.restore()},_setShadow:function(a){if(this.shadow)a.shadowColor=this.shadow.color,a.shadowBlur=this.shadow.blur,a.shadowOffsetX=this.shadow.offsetX,
a.shadowOffsetY=this.shadow.offsetY},_removeShadow:function(a){if(this.shadow)a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0},_renderFill:function(a){this.fill&&(a.save(),this.fill.gradientTransform&&a.transform.apply(a,this.fill.gradientTransform),this.fill.toLive&&a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),this.fillRule==="evenodd"?a.fill("evenodd"):a.fill(),a.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a))},_renderStroke:function(a){this.stroke&&
this.strokeWidth!==0&&(a.save(),this.strokeDashArray?(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),h?(a.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(a)):this._renderDashedStroke&&this._renderDashedStroke(a),a.stroke()):(this.stroke.gradientTransform&&a.transform.apply(a,this.stroke.gradientTransform),this._stroke?this._stroke(a):a.stroke()),this._removeShadow(a),a.restore())},clone:function(c,b){return this.constructor.fromObject?
this.constructor.fromObject(this.toObject(b),c):new a.Object(this.toObject(b))},cloneAsImage:function(c){var b=this.toDataURL();a.util.loadImage(b,function(b){c&&c(new a.Image(b))});return this},toDataURL:function(c){c||(c={});var b=a.util.createCanvasElement(),d=this.getBoundingRect();b.width=d.width;b.height=d.height;a.util.wrapElement(b,"div");d=new a.Canvas(b);if(c.format==="jpg")c.format="jpeg";if(c.format==="jpeg")d.backgroundColor="#fff";var h={active:this.get("active"),left:this.getLeft(),
top:this.getTop()};this.set("active",!1);this.setPositionByOrigin(new a.Point(b.width/2,b.height/2),"center","center");b=this.canvas;d.add(this);c=d.toDataURL(c);this.set(h).setCoords();this.canvas=b;d.dispose();return c},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(c,b){b||(b={});var d={colorStops:[]};d.type=b.type||(b.r1||b.r2?"radial":"linear");d.coords={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2};if(b.r1||b.r2)d.coords.r1=
b.r1,d.coords.r2=b.r2;for(var h in b.colorStops){var e=new a.Color(b.colorStops[h]);d.colorStops.push({offset:h,color:e.toRgb(),opacity:e.getAlpha()})}return this.set(c,a.Gradient.forObject(this,d))},setPatternFill:function(c){return this.set("fill",new a.Pattern(c))},setShadow:function(c){return this.set("shadow",c?new a.Shadow(c):null)},setColor:function(a){this.set("fill",a);return this},setAngle:function(a){var c=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;c&&this._setOriginToCenter();
this.set("angle",a);c&&this._resetOrigin();return this},centerH:function(){this.canvas.centerObjectH(this);return this},centerV:function(){this.canvas.centerObjectV(this);return this},center:function(){this.canvas.centerObject(this);return this},remove:function(){this.canvas.remove(this);return this},getLocalPointer:function(a,c){var c=c||this.canvas.getPointer(a),b=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:c.x-b.x,y:c.y-b.y}},_setupCompositeOperation:function(a){if(this.globalCompositeOperation)this._prevGlobalCompositeOperation=
a.globalCompositeOperation,a.globalCompositeOperation=this.globalCompositeOperation},_restoreCompositeOperation:function(a){if(this.globalCompositeOperation&&this._prevGlobalCompositeOperation)a.globalCompositeOperation=this._prevGlobalCompositeOperation}}),a.util.createAccessors(a.Object),a.Object.prototype.rotate=a.Object.prototype.setAngle,e(a.Object.prototype,a.Observable),a.Object.NUM_FRACTION_DIGITS=2,a.Object.__uid=0})(typeof j!=="undefined"?j:this);(function(){var e=f.util.degreesToRadians;
f.util.object.extend(f.Object.prototype,{translateToCenterPoint:function(a,d,b){var c=a.x,h=a.y,g=this.stroke?this.strokeWidth:0;d==="left"?c=a.x+(this.getWidth()+g*this.scaleX)/2:d==="right"&&(c=a.x-(this.getWidth()+g*this.scaleX)/2);b==="top"?h=a.y+(this.getHeight()+g*this.scaleY)/2:b==="bottom"&&(h=a.y-(this.getHeight()+g*this.scaleY)/2);return f.util.rotatePoint(new f.Point(c,h),a,e(this.angle))},translateToOriginPoint:function(a,d,b){var c=a.x,h=a.y,g=this.stroke?this.strokeWidth:0;d==="left"?
c=a.x-(this.getWidth()+g*this.scaleX)/2:d==="right"&&(c=a.x+(this.getWidth()+g*this.scaleX)/2);b==="top"?h=a.y-(this.getHeight()+g*this.scaleY)/2:b==="bottom"&&(h=a.y+(this.getHeight()+g*this.scaleY)/2);return f.util.rotatePoint(new f.Point(c,h),a,e(this.angle))},getCenterPoint:function(){return this.translateToCenterPoint(new f.Point(this.left,this.top),this.originX,this.originY)},getPointByOrigin:function(a,d){return this.translateToOriginPoint(this.getCenterPoint(),a,d)},toLocalPoint:function(a,
d,b){var c=this.getCenterPoint(),h=this.stroke?this.strokeWidth:0;d&&b?(d=d==="left"?c.x-(this.getWidth()+h*this.scaleX)/2:d==="right"?c.x+(this.getWidth()+h*this.scaleX)/2:c.x,b=b==="top"?c.y-(this.getHeight()+h*this.scaleY)/2:b==="bottom"?c.y+(this.getHeight()+h*this.scaleY)/2:c.y):(d=this.left,b=this.top);return f.util.rotatePoint(new f.Point(a.x,a.y),c,-e(this.angle)).subtractEquals(new f.Point(d,b))},setPositionByOrigin:function(a,d,b){a=this.translateToOriginPoint(this.translateToCenterPoint(a,
d,b),this.originX,this.originY);this.set("left",a.x);this.set("top",a.y)},adjustPosition:function(a){var d=e(this.angle),b=this.getWidth()/2,c=Math.cos(d)*b;b*=Math.sin(d);var h=this.getWidth(),g=Math.cos(d)*h,d=Math.sin(d)*h;this.originX==="center"&&a==="left"||this.originX==="right"&&a==="center"?(this.left-=c,this.top-=b):this.originX==="left"&&a==="center"||this.originX==="center"&&a==="right"?(this.left+=c,this.top+=b):this.originX==="left"&&a==="right"?(this.left+=g,this.top+=d):this.originX===
"right"&&a==="left"&&(this.left-=g,this.top-=d);this.setCoords();this.originX=a},_setOriginToCenter:function(){this._originalOriginX=this.originX;this._originalOriginY=this.originY;var a=this.getCenterPoint();this.originY=this.originX="center";this.left=a.x;this.top=a.y},_resetOrigin:function(){var a=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX;this.originY=this._originalOriginY;this.left=a.x;this.top=a.y;this._originalOriginY=
this._originalOriginX=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})})();(function(){var e=f.util.degreesToRadians;f.util.object.extend(f.Object.prototype,{oCoords:null,intersectsWithRect:function(a,d){var b=this.oCoords,c=new f.Point(b.tl.x,b.tl.y),h=new f.Point(b.tr.x,b.tr.y),g=new f.Point(b.bl.x,b.bl.y),b=new f.Point(b.br.x,b.br.y);return f.Intersection.intersectPolygonRectangle([c,h,b,g],a,d).status==="Intersection"},intersectsWithObject:function(a){function d(a){return{tl:new f.Point(a.tl.x,
a.tl.y),tr:new f.Point(a.tr.x,a.tr.y),bl:new f.Point(a.bl.x,a.bl.y),br:new f.Point(a.br.x,a.br.y)}}var b=d(this.oCoords),a=d(a.oCoords);return f.Intersection.intersectPolygonPolygon([b.tl,b.tr,b.br,b.bl],[a.tl,a.tr,a.br,a.bl]).status==="Intersection"},isContainedWithinObject:function(a){var d=a.getBoundingRect(),a=new f.Point(d.left,d.top),d=new f.Point(d.left+d.width,d.top+d.height);return this.isContainedWithinRect(a,d)},isContainedWithinRect:function(a,d){var b=this.getBoundingRect();return b.left>=
a.x&&b.left+b.width<=d.x&&b.top>=a.y&&b.top+b.height<=d.y},containsPoint:function(a){var d=this._getImageLines(this.oCoords),a=this._findCrossPoints(a,d);return a!==0&&a%2===1},_getImageLines:function(a){return{topline:{o:a.tl,d:a.tr},rightline:{o:a.tr,d:a.br},bottomline:{o:a.br,d:a.bl},leftline:{o:a.bl,d:a.tl}}},_findCrossPoints:function(a,d){var b,c,h,g=0,i;for(i in d)if(h=d[i],!(h.o.y<a.y&&h.d.y<a.y)&&!(h.o.y>=a.y&&h.d.y>=a.y)&&(h.o.x===h.d.x&&h.o.x>=a.x?b=h.o.x:(b=(h.d.y-h.o.y)/(h.d.x-h.o.x),
c=a.y-0*a.x,h=h.o.y-b*h.o.x,b=-(c-h)/(0-b)),b>=a.x&&(g+=1),g===2))break;return g},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var a=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],d=f.util.array.min(a),a=f.util.array.max(a),a=Math.abs(d-a),b=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],c=f.util.array.min(b),
b=f.util.array.max(b),b=Math.abs(c-b);return{left:d,top:c,width:a,height:b}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(a){return Math.abs(a)<this.minScaleLimit?a<0?-this.minScaleLimit:this.minScaleLimit:a},scale:function(a){a=this._constrainScale(a);if(a<0)this.flipX=!this.flipX,this.flipY=!this.flipY,a*=-1;this.scaleY=this.scaleX=a;this.setCoords();return this},scaleToWidth:function(a){var d=this.getBoundingRectWidth()/
this.getWidth();return this.scale(a/this.width/d)},scaleToHeight:function(a){var d=this.getBoundingRectHeight()/this.getHeight();return this.scale(a/this.height/d)},setCoords:function(){var a=this.strokeWidth>1?this.strokeWidth:0,d=e(this.angle),b=this.getViewportTransform(),c=function(a){return f.util.transformPoint(a,b)},h=this.width,g=this.height,i=this.strokeLineCap==="round"||this.strokeLineCap==="square",k=this.type==="line"&&this.width===1,m=this.type==="line"&&this.height===1,n=i&&m||this.type!==
"line",i=i&&k||this.type!=="line";k?h=a:m&&(g=a);n&&(h+=a);i&&(g+=a);this.currentWidth=h*this.scaleX;this.currentHeight=g*this.scaleY;if(this.currentWidth<0)this.currentWidth=Math.abs(this.currentWidth);g=Math.sqrt(Math.pow(this.currentWidth/2,2)+Math.pow(this.currentHeight/2,2));a=Math.atan(isFinite(this.currentHeight/this.currentWidth)?this.currentHeight/this.currentWidth:0);h=Math.cos(a+d)*g;g*=Math.sin(a+d);var n=Math.sin(d),i=Math.cos(d),k=this.getCenterPoint(),o=new f.Point(this.currentWidth,
this.currentHeight),p=new f.Point(k.x-h,k.y-g),q=new f.Point(p.x+o.x*i,p.y+o.x*n),x=new f.Point(p.x-o.y*n,p.y+o.y*i),G=new f.Point(p.x+o.x/2*i,p.y+o.x/2*n),h=c(p),g=c(q),k=c(new f.Point(q.x-o.y*n,q.y+o.y*i)),m=c(x),p=c(new f.Point(p.x-o.y/2*n,p.y+o.y/2*i)),t=c(G),q=c(new f.Point(q.x-o.y/2*n,q.y+o.y/2*i)),n=c(new f.Point(x.x+o.x/2*i,x.y+o.x/2*n)),c=c(new f.Point(G.x,G.y)),i=Math.cos(a+d)*this.padding*Math.sqrt(2),d=Math.sin(a+d)*this.padding*Math.sqrt(2),h=h.add(new f.Point(-i,-d)),g=g.add(new f.Point(d,
-i)),k=k.add(new f.Point(i,d)),m=m.add(new f.Point(-d,i)),p=p.add(new f.Point((-i-d)/2,(-d+i)/2)),t=t.add(new f.Point((d-i)/2,-(d+i)/2)),q=q.add(new f.Point((d+i)/2,(d-i)/2)),n=n.add(new f.Point((i-d)/2,(i+d)/2)),c=c.add(new f.Point((d-i)/2,-(d+i)/2));this.oCoords={tl:h,tr:g,br:k,bl:m,ml:p,mt:t,mr:q,mb:n,mtr:c};this._setCornerCoords&&this._setCornerCoords();return this}})})();f.util.object.extend(f.Object.prototype,{sendToBack:function(){this.group?f.StaticCanvas.prototype.sendToBack.call(this.group,
this):this.canvas.sendToBack(this);return this},bringToFront:function(){this.group?f.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this);return this},sendBackwards:function(e){this.group?f.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas.sendBackwards(this,e);return this},bringForward:function(e){this.group?f.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas.bringForward(this,e);return this},moveTo:function(e){this.group?
f.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas.moveTo(this,e);return this}});f.util.object.extend(f.Object.prototype,{getSvgStyles:function(){var e=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",a=this.fillRule,d=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",b=this.strokeWidth?this.strokeWidth:"0",c=this.strokeDashArray?this.strokeDashArray.join(" "):"";return["stroke: ",d,"; stroke-width: ",b,"; stroke-dasharray: ",
c,"; stroke-linecap: ",this.strokeLineCap?this.strokeLineCap:"butt","; stroke-linejoin: ",this.strokeLineJoin?this.strokeLineJoin:"miter","; stroke-miterlimit: ",this.strokeMiterLimit?this.strokeMiterLimit:"4","; fill: ",e,"; fill-rule: ",a,"; opacity: ",typeof this.opacity!=="undefined"?this.opacity:"1",";",this.shadow&&this.type!=="text"?"filter: url(#SVGID_"+this.shadow.id+");":"",this.visible?"":" visibility: hidden;"].join("")},getSvgTransform:function(){if(this.group&&this.group.type==="path-group")return"";
var e=f.util.toFixed,a=this.getAngle(),d=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],b=f.util.transformPoint(this.getCenterPoint(),d),c=f.Object.NUM_FRACTION_DIGITS,b=this.type==="path-group"?"":"translate("+e(b.x,c)+" "+e(b.y,c)+")",a=a!==0?" rotate("+e(a,c)+")":"",e=this.scaleX===1&&this.scaleY===1&&d[0]===1&&d[3]===1?"":" scale("+e(this.scaleX*d[0],c)+" "+e(this.scaleY*d[3],c)+")",c=this.type==="path-group"?this.width*d[0]:0,d=this.type==="path-group"?
this.height*d[3]:0;return[b,a,e,this.flipX?" matrix(-1 0 0 1 "+c+" 0) ":"",this.flipY?" matrix(1 0 0 -1 0 "+d+")":""].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+")":""},_createBaseSVGMarkup:function(){var e=[];this.fill&&this.fill.toLive&&e.push(this.fill.toSVG(this,!1));this.stroke&&this.stroke.toLive&&e.push(this.stroke.toSVG(this,!1));this.shadow&&e.push(this.shadow.toSVG(this));return e}});f.util.object.extend(f.Object.prototype,
{hasStateChanged:function(){return this.stateProperties.some(function(e){return this.get(e)!==this.originalState[e]},this)},saveState:function(e){this.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this);e&&e.stateProperties&&e.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this);return this},setupState:function(){this.originalState={};this.saveState();return this}});(function(){var e=f.util.degreesToRadians;f.util.object.extend(f.Object.prototype,{_controlsVisibility:null,
_findTargetCorner:function(a){if(!this.hasControls||!this.active)return!1;var d=a.x,a=a.y,b,c;for(c in this.oCoords)if(this.isControlVisible(c)&&(c!=="mtr"||this.hasRotatingPoint))if(!this.get("lockUniScaling")||!(c==="mt"||c==="mr"||c==="mb"||c==="ml"))if(b=this._getImageLines(this.oCoords[c].corner),b=this._findCrossPoints({x:d,y:a},b),b!==0&&b%2===1)return this.__corner=c;return!1},_setCornerCoords:function(){var a=this.oCoords,d=e(this.angle),b=e(45-this.angle),c=Math.sqrt(2*Math.pow(this.cornerSize,
2))/2,h=c*Math.cos(b),b=c*Math.sin(b),c=Math.sin(d),d=Math.cos(d);a.tl.corner={tl:{x:a.tl.x-b,y:a.tl.y-h},tr:{x:a.tl.x+h,y:a.tl.y-b},bl:{x:a.tl.x-h,y:a.tl.y+b},br:{x:a.tl.x+b,y:a.tl.y+h}};a.tr.corner={tl:{x:a.tr.x-b,y:a.tr.y-h},tr:{x:a.tr.x+h,y:a.tr.y-b},br:{x:a.tr.x+b,y:a.tr.y+h},bl:{x:a.tr.x-h,y:a.tr.y+b}};a.bl.corner={tl:{x:a.bl.x-b,y:a.bl.y-h},bl:{x:a.bl.x-h,y:a.bl.y+b},br:{x:a.bl.x+b,y:a.bl.y+h},tr:{x:a.bl.x+h,y:a.bl.y-b}};a.br.corner={tr:{x:a.br.x+h,y:a.br.y-b},bl:{x:a.br.x-h,y:a.br.y+b},br:{x:a.br.x+
b,y:a.br.y+h},tl:{x:a.br.x-b,y:a.br.y-h}};a.ml.corner={tl:{x:a.ml.x-b,y:a.ml.y-h},tr:{x:a.ml.x+h,y:a.ml.y-b},bl:{x:a.ml.x-h,y:a.ml.y+b},br:{x:a.ml.x+b,y:a.ml.y+h}};a.mt.corner={tl:{x:a.mt.x-b,y:a.mt.y-h},tr:{x:a.mt.x+h,y:a.mt.y-b},bl:{x:a.mt.x-h,y:a.mt.y+b},br:{x:a.mt.x+b,y:a.mt.y+h}};a.mr.corner={tl:{x:a.mr.x-b,y:a.mr.y-h},tr:{x:a.mr.x+h,y:a.mr.y-b},bl:{x:a.mr.x-h,y:a.mr.y+b},br:{x:a.mr.x+b,y:a.mr.y+h}};a.mb.corner={tl:{x:a.mb.x-b,y:a.mb.y-h},tr:{x:a.mb.x+h,y:a.mb.y-b},bl:{x:a.mb.x-h,y:a.mb.y+b},
br:{x:a.mb.x+b,y:a.mb.y+h}};a.mtr.corner={tl:{x:a.mtr.x-b+c*this.rotatingPointOffset,y:a.mtr.y-h-d*this.rotatingPointOffset},tr:{x:a.mtr.x+h+c*this.rotatingPointOffset,y:a.mtr.y-b-d*this.rotatingPointOffset},bl:{x:a.mtr.x-h+c*this.rotatingPointOffset,y:a.mtr.y+b-d*this.rotatingPointOffset},br:{x:a.mtr.x+b+c*this.rotatingPointOffset,y:a.mtr.y+h-d*this.rotatingPointOffset}}},drawBorders:function(a){if(!this.hasBorders)return this;var d=this.padding,b=d*2,c=this.getViewportTransform();a.save();a.globalAlpha=
this.isMoving?this.borderOpacityWhenMoving:1;a.strokeStyle=this.borderColor;var h=1/this._constrainScale(this.scaleX),g=1/this._constrainScale(this.scaleY);a.lineWidth=1/this.borderScaleFactor;var i=this.getWidth(),e=this.getHeight(),m=this.strokeWidth>1?this.strokeWidth:0,n=this.strokeLineCap==="round"||this.strokeLineCap==="square",o=this.type==="line"&&this.width===1,p=this.type==="line"&&this.height===1,q=n&&p||this.type!=="line",n=n&&o||this.type!=="line";o?i=m/h:p&&(e=m/g);q&&(i+=m/h);n&&(e+=
m/g);h=f.util.transformPoint(new f.Point(i,e),c,!0);c=h.x;h=h.y;this.group&&(c*=this.group.scaleX,h*=this.group.scaleY);a.strokeRect(~~(-(c/2)-d)-0.5,~~(-(h/2)-d)-0.5,~~(c+b)+1,~~(h+b)+1);this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls&&(d=(-h-d*2)/2,a.beginPath(),a.moveTo(0,d),a.lineTo(0,d-this.rotatingPointOffset),a.closePath(),a.stroke());a.restore();return this},drawControls:function(a){if(!this.hasControls)return this;var d=this.cornerSize,b=d/
2,c=this.getViewportTransform(),h=this.strokeWidth>1?this.strokeWidth:0,g=this.width,i=this.height,e=this.strokeLineCap==="round"||this.strokeLineCap==="square",m=this.type==="line"&&this.width===1,n=this.type==="line"&&this.height===1,o=e&&n||this.type!=="line",e=e&&m||this.type!=="line";m?g=h:n&&(i=h);o&&(g+=h);e&&(i+=h);g*=this.scaleX;i*=this.scaleY;h=f.util.transformPoint(new f.Point(g,i),c,!0);c=h.x;h=h.y;g=-(c/2);i=-(h/2);m=this.padding;d=b-d;n=this.transparentCorners?"strokeRect":"fillRect";
a.save();a.lineWidth=1;a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;a.strokeStyle=a.fillStyle=this.cornerColor;this._drawControl("tl",a,n,g-b-m,i-b-m);this._drawControl("tr",a,n,g+c-b+m,i-b-m);this._drawControl("bl",a,n,g-b-m,i+h+d+m);this._drawControl("br",a,n,g+c+d+m,i+h+d+m);this.get("lockUniScaling")||(this._drawControl("mt",a,n,g+c/2-b,i-b-m),this._drawControl("mb",a,n,g+c/2-b,i+h+d+m),this._drawControl("mr",a,n,g+c+d+m,i+h/2-b),this._drawControl("ml",a,n,g-b-m,i+h/2-b));this.hasRotatingPoint&&
this._drawControl("mtr",a,n,g+c/2-b,i-this.rotatingPointOffset-this.cornerSize/2-m);a.restore();return this},_drawControl:function(a,d,b,c,h){var g=this.cornerSize;this.isControlVisible(a)&&(typeof G_vmlCanvasManager!=="undefined"||this.transparentCorners||d.clearRect(c,h,g,g),d[b](c,h,g,g))},isControlVisible:function(a){return this._getControlsVisibility()[a]},setControlVisible:function(a,d){this._getControlsVisibility()[a]=d;return this},setControlsVisibility:function(a){a||(a={});for(var d in a)this.setControlVisible(d,
a[d]);return this},_getControlsVisibility:function(){if(!this._controlsVisibility)this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0};return this._controlsVisibility}})})();f.util.object.extend(f.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,a){var a=a||{},d=function(){},b=a.onComplete||d,c=a.onChange||d,h=this;f.util.animate({startValue:e.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(a){e.set("left",a);h.renderAll();
c()},onComplete:function(){e.setCoords();b()}});return this},fxCenterObjectV:function(e,a){var a=a||{},d=function(){},b=a.onComplete||d,c=a.onChange||d,h=this;f.util.animate({startValue:e.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(a){e.set("top",a);h.renderAll();c()},onComplete:function(){e.setCoords();b()}});return this},fxRemove:function(e,a){var a=a||{},d=function(){},b=a.onComplete||d,c=a.onChange||d,h=this;f.util.animate({startValue:e.get("opacity"),
endValue:0,duration:this.FX_DURATION,onStart:function(){e.set("active",!1)},onChange:function(a){e.set("opacity",a);h.renderAll();c()},onComplete:function(){h.remove(e);b()}});return this}});f.util.object.extend(f.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]==="object"){var e=[],a,d;for(a in arguments[0])e.push(a);for(var b=0,c=e.length;b<c;b++)a=e[b],d=b!==c-1,this._animate(a,arguments[0][a],arguments[1],d)}else this._animate.apply(this,arguments);return this},_animate:function(e,
a,d,b){var c=this,h,a=a.toString(),d=d?f.util.object.clone(d):{};~e.indexOf(".")&&(h=e.split("."));var g=h?this.get(h[0])[h[1]]:this.get(e);if(!("from"in d))d.from=g;a=~a.indexOf("=")?g+parseFloat(a.replace("=","")):parseFloat(a);f.util.animate({startValue:d.from,endValue:a,byValue:d.by,easing:d.easing,duration:d.duration,abort:d.abort&&function(){return d.abort.call(c)},onChange:function(a){h?c[h[0]][h[1]]=a:c.set(e,a);b||d.onChange&&d.onChange()},onComplete:function(){b||(c.setCoords(),d.onComplete&&
d.onComplete())}})}});(function(e){function a(a,c){var b=a.origin,d=a.axis1,h=a.axis2,e=a.dimension,f=c.nearest,q=c.center,x=c.farthest;return function(){switch(this.get(b)){case f:return Math.min(this.get(d),this.get(h));case q:return Math.min(this.get(d),this.get(h))+0.5*this.get(e);case x:return Math.max(this.get(d),this.get(h))}}}var d=e.fabric||(e.fabric={}),b=d.util.object.extend,c={x1:1,x2:1,y1:1,y2:1},h=d.StaticCanvas.supports("setLineDash");d.Line?d.warn("fabric.Line is already defined"):
(d.Line=d.util.createClass(d.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,c){c=c||{};a||(a=[0,0,0,0]);this.callSuper("initialize",c);this.set("x1",a[0]);this.set("y1",a[1]);this.set("x2",a[2]);this.set("y2",a[3]);this._setWidthHeight(c)},_setWidthHeight:function(a){a||(a={});this.width=Math.abs(this.x2-this.x1)||1;this.height=Math.abs(this.y2-this.y1)||1;this.left="left"in a?a.left:this._getLeftToOriginX();this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,b){this.callSuper("_set",
a,b);typeof c[a]!=="undefined"&&this._setWidthHeight();return this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a,c){a.beginPath();if(c){var b=this.getCenterPoint();a.translate(b.x,b.y)}if(!this.strokeDashArray||this.strokeDashArray&&h){var b=this.x1<=this.x2?-1:1,d=this.y1<=
this.y2?-1:1;a.moveTo(this.width===1?0:b*this.width/2,this.height===1?0:d*this.height/2);a.lineTo(this.width===1?0:b*-1*this.width/2,this.height===1?0:d*-1*this.height/2)}a.lineWidth=this.strokeWidth;b=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle;this.stroke&&this._renderStroke(a);a.strokeStyle=b},_renderDashedStroke:function(a){var c=this.x1<=this.x2?-1:1,b=this.y1<=this.y2?-1:1,c=this.width===1?0:c*this.width/2,b=this.height===1?0:b*this.height/2;a.beginPath();d.util.drawDashedLine(a,c,
b,-c,-b,this.strokeDashArray);a.closePath()},toObject:function(a){return b(this.callSuper("toObject",a),this.calcLinePoints())},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,c=this.y1<=this.y2?-1:1;return{x1:a*this.width/2,x2:a*-1*this.width/2,y1:c*this.height/2,y2:c*-1*this.height/2}},toSVG:function(a){var c=this._createBaseSVGMarkup(),b={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};this.group&&this.group.type==="path-group"||(b=this.calcLinePoints());c.push("<line ",'x1="',b.x1,'" y1="',
b.y1,'" x2="',b.x2,'" y2="',b.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},complexity:function(){return 1}}),d.Line.ATTRIBUTE_NAMES=d.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),d.Line.fromElement=function(a,c){var h=d.parseAttributes(a,d.Line.ATTRIBUTE_NAMES);return new d.Line([h.x1||0,h.y1||0,h.x2||0,h.y2||0],b(h,c))},d.Line.fromObject=function(a){return new d.Line([a.x1,a.y1,a.x2,a.y2],
a)})})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=Math.PI,b=a.util.object.extend;a.Circle?a.warn("fabric.Circle is already defined."):(a.Circle=a.util.createClass(a.Object,{type:"circle",radius:0,startAngle:0,endAngle:d*2,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("radius",a.radius||0);this.startAngle=a.startAngle||this.startAngle;this.endAngle=a.endAngle||this.endAngle},_set:function(a,b){this.callSuper("_set",a,b);a==="radius"&&this.setRadius(b);
return this},toObject:function(a){return b(this.callSuper("toObject",a),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(a){var b=this._createBaseSVGMarkup(),g=0,i=0,e=(this.endAngle-this.startAngle)%(2*d);if(e===0)this.group&&this.group.type==="path-group"&&(g=this.left+this.radius,i=this.top+this.radius),b.push("<circle ",'cx="'+g+'" cy="'+i+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),
'"/>\n');else{var g=Math.cos(this.startAngle)*this.radius,i=Math.sin(this.startAngle)*this.radius,f=Math.cos(this.endAngle)*this.radius,n=Math.sin(this.endAngle)*this.radius;b.push('<path d="M '+g+" "+i," A "+this.radius+" "+this.radius," 0 ",+(e>d?1:0)+" 1"," "+f+" "+n,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.arc(b?this.left+this.radius:0,b?this.top+this.radius:
0,this.radius,this.startAngle,this.endAngle,!1);this._renderFill(a);this._renderStroke(a)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){this.radius=a;this.set("width",a*2).set("height",a*2)},complexity:function(){return 1}}),a.Circle.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),a.Circle.fromElement=function(c,d){d||(d={});var g=a.parseAttributes(c,a.Circle.ATTRIBUTE_NAMES);
if(!("radius"in g&&g.radius>0))throw Error("value of `r` attribute is required and can not be negative");g.left=g.left||0;g.top=g.top||0;g=new a.Circle(b(g,d));g.left-=g.radius;g.top-=g.radius;return g},a.Circle.fromObject=function(c){return new a.Circle(c)})})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={});a.Triangle?a.warn("fabric.Triangle is already defined"):(a.Triangle=a.util.createClass(a.Object,{type:"triangle",initialize:function(a){a=a||{};this.callSuper("initialize",
a);this.set("width",a.width||100).set("height",a.height||100)},_render:function(a){var b=this.width/2,c=this.height/2;a.beginPath();a.moveTo(-b,c);a.lineTo(0,-c);a.lineTo(b,c);a.closePath();this._renderFill(a);this._renderStroke(a)},_renderDashedStroke:function(d){var b=this.width/2,c=this.height/2;d.beginPath();a.util.drawDashedLine(d,-b,c,0,-c,this.strokeDashArray);a.util.drawDashedLine(d,0,-c,b,c,this.strokeDashArray);a.util.drawDashedLine(d,b,c,-b,c,this.strokeDashArray);d.closePath()},toSVG:function(a){var b=
this._createBaseSVGMarkup(),c=this.width/2,h=this.height/2,c=[-c+" "+h,"0 "+-h,c+" "+h].join(",");b.push("<polygon ",'points="',c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),a.Triangle.fromObject=function(d){return new a.Triangle(d)})})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=Math.PI*2,b=a.util.object.extend;a.Ellipse?a.warn("fabric.Ellipse is already defined."):
(a.Ellipse=a.util.createClass(a.Object,{type:"ellipse",rx:0,ry:0,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("rx",a.rx||0);this.set("ry",a.ry||0)},_set:function(a,b){this.callSuper("_set",a,b);switch(a){case "rx":this.rx=b;this.set("width",b*2);break;case "ry":this.ry=b,this.set("height",b*2)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(a){return b(this.callSuper("toObject",
a),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(a){var b=this._createBaseSVGMarkup(),g=0,d=0;this.group&&this.group.type==="path-group"&&(g=this.left+this.rx,d=this.top+this.ry);b.push("<ellipse ",'cx="',g,'" cy="',d,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.save();a.transform(1,0,0,this.ry/this.rx,0,0);a.arc(b?this.left+
this.rx:0,b?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,d,!1);a.restore();this._renderFill(a);this._renderStroke(a)},complexity:function(){return 1}}),a.Ellipse.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),a.Ellipse.fromElement=function(c,d){d||(d={});var g=a.parseAttributes(c,a.Ellipse.ATTRIBUTE_NAMES);g.left=g.left||0;g.top=g.top||0;g=new a.Ellipse(b(g,d));g.top-=g.ry;g.left-=g.rx;return g},a.Ellipse.fromObject=function(c){return new a.Ellipse(c)})})(typeof j!=="undefined"?
j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Rect?console.warn("fabric.Rect is already defined"):(e=a.Object.prototype.stateProperties.concat(),e.push("rx","ry","x","y"),a.Rect=a.util.createClass(a.Object,{stateProperties:e,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(a){a=a||{};this.callSuper("initialize",a);this._initRxRy()},_initRxRy:function(){if(this.rx&&!this.ry)this.ry=this.rx;else if(this.ry&&!this.rx)this.rx=this.ry},_render:function(a,c){if(this.width===
1&&this.height===1)a.fillRect(0,0,1,1);else{var d=this.rx?Math.min(this.rx,this.width/2):0,g=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,e=this.height,f=c?this.left:-this.width/2,n=c?this.top:-this.height/2,o=d!==0||g!==0;a.beginPath();a.moveTo(f+d,n);a.lineTo(f+i-d,n);o&&a.bezierCurveTo(f+i-0.4477152502*d,n,f+i,n+0.4477152502*g,f+i,n+g);a.lineTo(f+i,n+e-g);o&&a.bezierCurveTo(f+i,n+e-0.4477152502*g,f+i-0.4477152502*d,n+e,f+i-d,n+e);a.lineTo(f+d,n+e);o&&a.bezierCurveTo(f+0.4477152502*d,
n+e,f,n+e-0.4477152502*g,f,n+e-g);a.lineTo(f,n+g);o&&a.bezierCurveTo(f,n+0.4477152502*g,f+0.4477152502*d,n,f+d,n);a.closePath();this._renderFill(a);this._renderStroke(a)}},_renderDashedStroke:function(b){var c=-this.width/2,d=-this.height/2,g=this.width,i=this.height;b.beginPath();a.util.drawDashedLine(b,c,d,c+g,d,this.strokeDashArray);a.util.drawDashedLine(b,c+g,d,c+g,d+i,this.strokeDashArray);a.util.drawDashedLine(b,c+g,d+i,c,d+i,this.strokeDashArray);a.util.drawDashedLine(b,c,d+i,c,d,this.strokeDashArray);
b.closePath()},toObject:function(a){a=d(this.callSuper("toObject",a),{rx:this.get("rx")||0,ry:this.get("ry")||0});this.includeDefaultValues||this._removeDefaultValues(a);return a},toSVG:function(a){var c=this._createBaseSVGMarkup(),d=this.left,g=this.top;this.group&&this.group.type==="path-group"||(d=-this.width/2,g=-this.height/2);c.push("<rect ",'x="',d,'" y="',g,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',
this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},complexity:function(){return 1}}),a.Rect.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),a.Rect.fromElement=function(b,c){if(!b)return null;var c=c||{},h=a.parseAttributes(b,a.Rect.ATTRIBUTE_NAMES);h.left=h.left||0;h.top=h.top||0;return new a.Rect(d(c?a.util.object.clone(c):{},h))},a.Rect.fromObject=function(b){return new a.Rect(b)})})(typeof j!=="undefined"?j:this);(function(e){var a=
e.fabric||(e.fabric={});a.Polyline?a.warn("fabric.Polyline is already defined"):(a.Polyline=a.util.createClass(a.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(d,b){return a.Polygon.prototype.initialize.call(this,d,b)},_calcDimensions:function(){return a.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return a.Polygon.prototype._applyPointOffset.call(this)},toObject:function(d){return a.Polygon.prototype.toObject.call(this,d)},toSVG:function(d){return a.Polygon.prototype.toSVG.call(this,
d)},_render:function(d){a.Polygon.prototype.commonRender.call(this,d);this._renderFill(d);this._renderStroke(d)},_renderDashedStroke:function(d){var b,c;d.beginPath();for(var h=0,g=this.points.length;h<g;h++)b=this.points[h],c=this.points[h+1]||b,a.util.drawDashedLine(d,b.x,b.y,c.x,c.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),a.Polyline.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polyline.fromElement=function(d,b){if(!d)return null;b||(b={});var c=a.parsePointsAttribute(d.getAttribute("points")),
h=a.parseAttributes(d,a.Polyline.ATTRIBUTE_NAMES);return c===null?null:new a.Polyline(c,a.util.object.extend(h,b))},a.Polyline.fromObject=function(d){return new a.Polyline(d.points,d,!0)})})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend,b=a.util.array.min,c=a.util.array.max,h=a.util.toFixed;a.Polygon?a.warn("fabric.Polygon is already defined"):(a.Polygon=a.util.createClass(a.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(a,c){c=
c||{};this.points=a;this.callSuper("initialize",c);this._calcDimensions();if(!("top"in c))this.top=this.minY;if(!("left"in c))this.left=this.minX},_calcDimensions:function(){var a=this.points,d=b(a,"x"),h=b(a,"y"),e=c(a,"x"),a=c(a,"y");this.width=e-d||1;this.height=a-h||1;this.minX=d;this.minY=h},_applyPointOffset:function(){this.points.forEach(function(a){a.x-=this.minX+this.width/2;a.y-=this.minY+this.height/2},this)},toObject:function(a){return d(this.callSuper("toObject",a),{points:this.points.concat()})},
toSVG:function(a){for(var c=[],b=this._createBaseSVGMarkup(),d=0,e=this.points.length;d<e;d++)c.push(h(this.points[d].x,2),",",h(this.points[d].y,2)," ");b.push("<",this.type," ",'points="',c.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a){this.commonRender(a);this._renderFill(a);if(this.stroke||this.strokeDashArray)a.closePath(),this._renderStroke(a)},commonRender:function(a){var c;
a.beginPath();if(this._applyPointOffset)this.group&&this.group.type==="path-group"||this._applyPointOffset(),this._applyPointOffset=null;a.moveTo(this.points[0].x,this.points[0].y);for(var b=0,d=this.points.length;b<d;b++)c=this.points[b],a.lineTo(c.x,c.y)},_renderDashedStroke:function(c){a.Polyline.prototype._renderDashedStroke.call(this,c);c.closePath()},complexity:function(){return this.points.length}}),a.Polygon.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polygon.fromElement=function(c,b){if(!c)return null;
b||(b={});var h=a.parsePointsAttribute(c.getAttribute("points")),e=a.parseAttributes(c,a.Polygon.ATTRIBUTE_NAMES);return h===null?null:new a.Polygon(h,d(e,b))},a.Polygon.fromObject=function(c){return new a.Polygon(c.points,c,!0)})})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.array.min,b=a.util.array.max,c=a.util.object.extend,h=Object.prototype.toString,g=a.util.drawArc,i={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},f={m:"l",M:"L"};a.Path?a.warn("fabric.Path is already defined"):
(a.Path=a.util.createClass(a.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(a,c){c=c||{};this.setOptions(c);if(!a)throw Error("`path` argument is required");var b=h.call(a)==="[object Array]";if(this.path=b?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)){if(!b)this.path=this._parsePath();b=this._parseDimensions();this.minX=b.left;this.minY=b.top;this.width=b.width;this.height=b.height;this.top=this.top||this.minY;this.left=this.left||this.minX;this.pathOffset=this.pathOffset||
{x:this.minX+this.width/2,y:this.minY+this.height/2};c.sourcePath&&this.setSourcePath(c.sourcePath)}},_render:function(a){var c,b=null,d=0,h=0,e=0,i=0,f=0,k=0,j,l,y,z,s=-this.pathOffset.x,r=-this.pathOffset.y;this.group&&this.group.type==="path-group"&&(r=s=0);a.beginPath();for(var u=0,B=this.path.length;u<B;++u){c=this.path[u];switch(c[0]){case "l":e+=c[1];i+=c[2];a.lineTo(e+s,i+r);break;case "L":e=c[1];i=c[2];a.lineTo(e+s,i+r);break;case "h":e+=c[1];a.lineTo(e+s,i+r);break;case "H":e=c[1];a.lineTo(e+
s,i+r);break;case "v":i+=c[1];a.lineTo(e+s,i+r);break;case "V":i=c[1];a.lineTo(e+s,i+r);break;case "m":e+=c[1];i+=c[2];d=e;h=i;a.moveTo(e+s,i+r);break;case "M":e=c[1];i=c[2];d=e;h=i;a.moveTo(e+s,i+r);break;case "c":j=e+c[5];l=i+c[6];f=e+c[3];k=i+c[4];a.bezierCurveTo(e+c[1]+s,i+c[2]+r,f+s,k+r,j+s,l+r);e=j;i=l;break;case "C":e=c[5];i=c[6];f=c[3];k=c[4];a.bezierCurveTo(c[1]+s,c[2]+r,f+s,k+r,e+s,i+r);break;case "s":j=e+c[3];l=i+c[4];f=f?2*e-f:e;k=k?2*i-k:i;a.bezierCurveTo(f+s,k+r,e+c[1]+s,i+c[2]+r,j+
s,l+r);f=e+c[1];k=i+c[2];e=j;i=l;break;case "S":j=c[3];l=c[4];f=2*e-f;k=2*i-k;a.bezierCurveTo(f+s,k+r,c[1]+s,c[2]+r,j+s,l+r);e=j;i=l;f=c[1];k=c[2];break;case "q":j=e+c[3];l=i+c[4];f=e+c[1];k=i+c[2];a.quadraticCurveTo(f+s,k+r,j+s,l+r);e=j;i=l;break;case "Q":j=c[3];l=c[4];a.quadraticCurveTo(c[1]+s,c[2]+r,j+s,l+r);e=j;i=l;f=c[1];k=c[2];break;case "t":j=e+c[1];l=i+c[2];b[0].match(/[QqTt]/)===null?(f=e,k=i):b[0]==="t"?(f=2*e-y,k=2*i-z):b[0]==="q"&&(f=2*e-f,k=2*i-k);y=f;z=k;a.quadraticCurveTo(f+s,k+r,j+
s,l+r);e=j;i=l;f=e+c[1];k=i+c[2];break;case "T":j=c[1];l=c[2];f=2*e-f;k=2*i-k;a.quadraticCurveTo(f+s,k+r,j+s,l+r);e=j;i=l;break;case "a":g(a,e+s,i+r,[c[1],c[2],c[3],c[4],c[5],c[6]+e+s,c[7]+i+r]);e+=c[6];i+=c[7];break;case "A":g(a,e+s,i+r,[c[1],c[2],c[3],c[4],c[5],c[6]+s,c[7]+r]);e=c[6];i=c[7];break;case "z":case "Z":e=d,i=h,a.closePath()}b=c}this._renderFill(a);this._renderStroke(a)},render:function(c,b){this.visible&&(c.save(),this._setupCompositeOperation(c),b||this.transform(c),this._setStrokeStyles(c),
this._setFillStyles(c),this.group&&this.group.type==="path-group"&&c.translate(-this.group.width/2,-this.group.height/2),this.transformMatrix&&c.transform.apply(c,this.transformMatrix),this._setOpacity(c),this._setShadow(c),this.clipTo&&a.util.clipContext(this,c),this._render(c,b),this.clipTo&&c.restore(),this._removeShadow(c),this._restoreCompositeOperation(c),c.restore())},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){a=
c(this.callSuper("toObject",a),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});if(this.sourcePath)a.sourcePath=this.sourcePath;if(this.transformMatrix)a.transformMatrix=this.transformMatrix;return a},toDatalessObject:function(a){a=this.toObject(a);if(this.sourcePath)a.path=this.sourcePath;delete a.sourcePath;return a},toSVG:function(a){for(var c=[],b=this._createBaseSVGMarkup(),d="",g=0,h=this.path.length;g<h;g++)c.push(this.path[g].join(" "));c=c.join(" ");this.group&&
this.group.type==="path-group"||(d="translate("+-this.pathOffset.x+", "+-this.pathOffset.y+")");b.push("<path ",'d="',c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),d,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n");return a?a(b.join("")):b.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a=[],c=[],b,d,g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/ig,h,e=0,t=this.path.length;e<t;e++){b=this.path[e];h=b.slice(1).trim();
for(c.length=0;d=g.exec(h);)c.push(d[0]);b=[b.charAt(0)];h=0;for(var j=c.length;h<j;h++)d=parseFloat(c[h]),isNaN(d)||b.push(d);d=b[0];h=i[d.toLowerCase()];j=f[d]||d;if(b.length-1>h)for(var l=1,v=b.length;l<v;l+=h)a.push([d].concat(b.slice(l,l+h))),d=j;else a.push(b)}return a},_parseDimensions:function(){for(var c=[],g=[],h,e=null,i=0,f=0,k=0,t=0,j=0,l=0,v,y,z,s,r,u=0,B=this.path.length;u<B;++u){h=this.path[u];switch(h[0]){case "l":k+=h[1];t+=h[2];r=[];break;case "L":k=h[1];t=h[2];r=[];break;case "h":k+=
h[1];r=[];break;case "H":k=h[1];r=[];break;case "v":t+=h[1];r=[];break;case "V":t=h[1];r=[];break;case "m":k+=h[1];t+=h[2];i=k;f=t;r=[];break;case "M":k=h[1];t=h[2];i=k;f=t;r=[];break;case "c":v=k+h[5];y=t+h[6];j=k+h[3];l=t+h[4];r=a.util.getBoundsOfCurve(k,t,k+h[1],t+h[2],j,l,v,y);k=v;t=y;break;case "C":k=h[5];t=h[6];j=h[3];l=h[4];r=a.util.getBoundsOfCurve(k,t,h[1],h[2],j,l,k,t);break;case "s":v=k+h[3];y=t+h[4];j=j?2*k-j:k;l=l?2*t-l:t;r=a.util.getBoundsOfCurve(k,t,j,l,k+h[1],t+h[2],v,y);j=k+h[1];
l=t+h[2];k=v;t=y;break;case "S":v=h[3];y=h[4];j=2*k-j;l=2*t-l;r=a.util.getBoundsOfCurve(k,t,j,l,h[1],h[2],v,y);k=v;t=y;j=h[1];l=h[2];break;case "q":v=k+h[3];y=t+h[4];j=k+h[1];l=t+h[2];r=a.util.getBoundsOfCurve(k,t,j,l,j,l,v,y);k=v;t=y;break;case "Q":j=h[1];l=h[2];r=a.util.getBoundsOfCurve(k,t,j,l,j,l,h[3],h[4]);k=h[3];t=h[4];break;case "t":v=k+h[1];y=t+h[2];e[0].match(/[QqTt]/)===null?(j=k,l=t):e[0]==="t"?(j=2*k-z,l=2*t-s):e[0]==="q"&&(j=2*k-j,l=2*t-l);z=j;s=l;r=a.util.getBoundsOfCurve(k,t,j,l,j,
l,v,y);k=v;t=y;j=k+h[1];l=t+h[2];break;case "T":v=h[1];y=h[2];j=2*k-j;l=2*t-l;r=a.util.getBoundsOfCurve(k,t,j,l,j,l,v,y);k=v;t=y;break;case "a":r=a.util.getBoundsOfArc(k,t,h[1],h[2],h[3],h[4],h[5],h[6]+k,h[7]+t);k+=h[6];t+=h[7];break;case "A":r=a.util.getBoundsOfArc(k,t,h[1],h[2],h[3],h[4],h[5],h[6],h[7]);k=h[6];t=h[7];break;case "z":case "Z":k=i,t=f}e=h;r.forEach(function(a){c.push(a.x);g.push(a.y)});c.push(k);g.push(t)}h=d(c);e=d(g);i=b(c);f=b(g);return{left:h,top:e,width:i-h,height:f-e}}}),a.Path.fromObject=
function(c,b){typeof c.path==="string"?a.loadSVGFromURL(c.path,function(d){var d=d[0],g=c.path;delete c.path;a.util.object.extend(d,c);d.setSourcePath(g);b(d)}):b(new a.Path(c.path,c))},a.Path.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(["d"]),a.Path.fromElement=function(b,d,g){b=a.parseAttributes(b,a.Path.ATTRIBUTE_NAMES);d&&d(new a.Path(b.d,c(b,g)))},a.Path.async=!0)})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend,b=a.util.array.invoke,c=a.Object.prototype.toObject;
a.PathGroup?a.warn("fabric.PathGroup is already defined"):(a.PathGroup=a.util.createClass(a.Path,{type:"path-group",fill:"",initialize:function(a,c){c=c||{};this.paths=a||[];for(var b=this.paths.length;b--;)this.paths[b].group=this;this.setOptions(c);if(c.widthAttr)this.scaleX=c.widthAttr/c.width;if(c.heightAttr)this.scaleY=c.heightAttr/c.height;this.setCoords();c.sourcePath&&this.setSourcePath(c.sourcePath)},render:function(c){if(this.visible){c.save();var b=this.transformMatrix;b&&c.transform(b[0],
b[1],b[2],b[3],b[4],b[5]);this.transform(c);this._setShadow(c);this.clipTo&&a.util.clipContext(this,c);for(var b=0,d=this.paths.length;b<d;++b)this.paths[b].render(c,!0);this.clipTo&&c.restore();this._removeShadow(c);c.restore()}},_set:function(a,c){if(a==="fill"&&c&&this.isSameColor())for(var b=this.paths.length;b--;)this.paths[b]._set(a,c);return this.callSuper("_set",a,c)},toObject:function(a){a=d(c.call(this,a),{paths:b(this.getObjects(),"toObject",a)});if(this.sourcePath)a.sourcePath=this.sourcePath;
return a},toDatalessObject:function(a){a=this.toObject(a);if(this.sourcePath)a.paths=this.sourcePath;return a},toSVG:function(a){for(var c=this.getObjects(),b="translate("+this.left+" "+this.top+")",b=["<g ",'style="',this.getSvgStyles(),'" ','transform="',b,this.getSvgTransform(),'" ',">\n"],d=0,e=c.length;d<e;d++)b.push(c[d].toSVG(a));b.push("</g>\n");return a?a(b.join("")):b.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+
" }>"},isSameColor:function(){var a=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(c){return(c.get("fill")||"").toLowerCase()===a})},complexity:function(){return this.paths.reduce(function(a,c){return a+(c&&c.complexity?c.complexity():0)},0)},getObjects:function(){return this.paths}}),a.PathGroup.fromObject=function(c,b){typeof c.paths==="string"?a.loadSVGFromURL(c.paths,function(d){var e=c.paths;delete c.paths;d=a.util.groupSVGElements(d,c,e);b(d)}):
a.util.enlivenObjects(c.paths,function(d){delete c.paths;b(new a.PathGroup(d,c))})},a.PathGroup.async=!0)})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend,b=a.util.array.min,c=a.util.array.max,h=a.util.array.invoke;if(!a.Group){var g={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};a.Group=a.util.createClass(a.Object,a.Collection,{type:"group",initialize:function(a,c){c=c||{};this._objects=a||[];
for(var b=this._objects.length;b--;)this._objects[b].group=this;this.originalState={};this.callSuper("initialize");this._calcBounds();this._updateObjectsCoords();c&&d(this,c);this.setCoords();this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(a){var c=a.getLeft(),b=a.getTop();a.set({originalLeft:c,originalTop:b,left:c-this.left,top:b-this.top});a.setCoords();a.__origHasControls=a.hasControls;a.hasControls=!1},toString:function(){return"#<fabric.Group: ("+
this.complexity()+")>"},addWithUpdate:function(a){this._restoreObjectsState();if(a)this._objects.push(a),a.group=this;this.forEachObject(this._setObjectActive,this);this._calcBounds();this._updateObjectsCoords();return this},_setObjectActive:function(a){a.set("active",!0);a.group=this},removeWithUpdate:function(a){this._moveFlippedObject(a);this._restoreObjectsState();this.forEachObject(this._setObjectActive,this);this.remove(a);this._calcBounds();this._updateObjectsCoords();return this},_onObjectAdded:function(a){a.group=
this},_onObjectRemoved:function(a){delete a.group;a.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,c){if(a in this.delegatedProperties){var b=this._objects.length;for(this[a]=c;b--;)this._objects[b].set(a,c)}else this[a]=c},toObject:function(a){return d(this.callSuper("toObject",a),{objects:h(this._objects,"toObject",a)})},render:function(c){if(this.visible){c.save();
this.clipTo&&a.util.clipContext(this,c);for(var b=0,d=this._objects.length;b<d;b++)this._renderObject(this._objects[b],c);this.clipTo&&c.restore();c.restore()}},_renderControls:function(a,c){this.callSuper("_renderControls",a,c);for(var b=0,d=this._objects.length;b<d;b++)this._objects[b]._renderControls(a)},_renderObject:function(a,c){var b=a.hasRotatingPoint;if(a.visible)a.hasRotatingPoint=!1,a.render(c),a.hasRotatingPoint=b},_restoreObjectsState:function(){this._objects.forEach(this._restoreObjectState,
this);return this},_moveFlippedObject:function(a){var c=a.get("originX"),b=a.get("originY"),d=a.getCenterPoint();a.set({originX:"center",originY:"center",left:d.x,top:d.y});this._toggleFlipping(a);d=a.getPointByOrigin(c,b);a.set({originX:c,originY:b,left:d.x,top:d.y});return this},_toggleFlipping:function(a){this.flipX&&(a.toggle("flipX"),a.set("left",-a.get("left")),a.setAngle(-a.getAngle()));this.flipY&&(a.toggle("flipY"),a.set("top",-a.get("top")),a.setAngle(-a.getAngle()))},_restoreObjectState:function(a){this._setObjectPosition(a);
a.setCoords();a.hasControls=a.__origHasControls;delete a.__origHasControls;a.set("active",!1);a.setCoords();delete a.group;return this},_setObjectPosition:function(a){var c=this.getLeft(),b=this.getTop(),d=this._getRotatedLeftTop(a);a.set({angle:a.getAngle()+this.getAngle(),left:c+d.left,top:b+d.top,scaleX:a.get("scaleX")*this.get("scaleX"),scaleY:a.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(a){var c=this.getAngle()*(Math.PI/180);return{left:-Math.sin(c)*a.getTop()*this.get("scaleY")+
Math.cos(c)*a.getLeft()*this.get("scaleX"),top:Math.cos(c)*a.getTop()*this.get("scaleY")+Math.sin(c)*a.getLeft()*this.get("scaleX")}},destroy:function(){this._objects.forEach(this._moveFlippedObject,this);return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(a){a.setCoords()});
return this},_calcBounds:function(a){for(var c=[],b=[],d,g=0,h=this._objects.length;g<h;++g){d=this._objects[g];d.setCoords();for(var e in d.oCoords)c.push(d.oCoords[e].x),b.push(d.oCoords[e].y)}this.set(this._getBounds(c,b,a))},_getBounds:function(d,g,h){var e=a.util.invertTransform(this.getViewportTransform()),f=a.util.transformPoint(new a.Point(b(d),b(g)),e),d=a.util.transformPoint(new a.Point(c(d),c(g)),e),g={width:d.x-f.x||0,height:d.y-f.y||0};if(!h)g.left=(f.x+d.x)/2||0,g.top=(f.y+d.y)/2||0;
return g},toSVG:function(a){for(var c=["<g ",'transform="',this.getSvgTransform(),'">\n'],b=0,d=this._objects.length;b<d;b++)c.push(this._objects[b].toSVG(a));c.push("</g>\n");return a?a(c.join("")):c.join("")},get:function(a){if(a in g)if(this[a])return this[a];else{for(var c=0,b=this._objects.length;c<b;c++)if(this._objects[c][a])return!0;return!1}else return a in this.delegatedProperties?this._objects[0]&&this._objects[0].get(a):this[a]}});a.Group.fromObject=function(c,b){a.util.enlivenObjects(c.objects,
function(d){delete c.objects;b&&b(new a.Group(d,c))})};a.Group.async=!0}})(typeof j!=="undefined"?j:this);(function(e){var a=f.util.object.extend;if(!e.fabric)e.fabric={};e.fabric.Image?f.warn("fabric.Image is already defined."):(f.Image=f.util.createClass(f.Object,{type:"image",crossOrigin:"",initialize:function(a,b){b||(b={});this.filters=[];this.callSuper("initialize",b);this._initElement(a,b);this._initConfig(b);if(b.filters)this.filters=b.filters,this.applyFilters()},getElement:function(){return this._element},
setElement:function(a,b){this._originalElement=this._element=a;this._initConfig();this.filters.length!==0&&this.applyFilters(b);return this},setCrossOrigin:function(a){this.crossOrigin=a;this._element.crossOrigin=a;return this},getOriginalSize:function(){var a=this.getElement();return{width:a.width,height:a.height}},_stroke:function(a){a.save();this._setStrokeStyles(a);a.beginPath();a.strokeRect(-this.width/2,-this.height/2,this.width,this.height);a.closePath();a.restore()},_renderDashedStroke:function(a){var b=
-this.width/2,c=-this.height/2,h=this.width,g=this.height;a.save();this._setStrokeStyles(a);a.beginPath();f.util.drawDashedLine(a,b,c,b+h,c,this.strokeDashArray);f.util.drawDashedLine(a,b+h,c,b+h,c+g,this.strokeDashArray);f.util.drawDashedLine(a,b+h,c+g,b,c+g,this.strokeDashArray);f.util.drawDashedLine(a,b,c+g,b,c,this.strokeDashArray);a.closePath();a.restore()},toObject:function(d){return a(this.callSuper("toObject",d),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(a){return a&&
a.toObject()}),crossOrigin:this.crossOrigin})},toSVG:function(a){var b=[],c=-this.width/2,h=-this.height/2;if(this.group&&this.group.type==="path-group")c=this.left,h=this.top;b.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',c,'" y="',h,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="none"',"></image>\n");if(this.stroke||this.strokeDashArray){var g=this.fill;this.fill=
null;b.push("<rect ",'x="',c,'" y="',h,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n');this.fill=g}b.push("</g>\n");return a?a(b.join("")):b.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(a,b){this.constructor.fromObject(this.toObject(b),a)},applyFilters:function(a){if(this._originalElement)if(this.filters.length===
0)this._element=this._originalElement,a&&a();else{var b=this._originalElement,c=f.util.createCanvasElement(),h=f.util.createImage(),g=this;c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(b,0,0,b.width,b.height);this.filters.forEach(function(a){a&&a.applyTo(c)});h.width=b.width;h.height=b.height;f.isLikelyNode?(h.src=c.toBuffer(E,f.Image.pngCompression),g._element=h,a&&a()):(h.onload=function(){g._element=h;a&&a();h.onload=c=b=null},h.src=c.toDataURL("image/png"));return this}},_render:function(a,
b){this._element&&a.drawImage(this._element,b?this.left:-this.width/2,b?this.top:-this.height/2,this.width,this.height);this._renderStroke(a)},_resetWidthHeight:function(){var a=this.getElement();this.set("width",a.width);this.set("height",a.height)},_initElement:function(a){this.setElement(f.util.getById(a));f.util.addClass(this.getElement(),f.Image.CSS_CANVAS)},_initConfig:function(a){a||(a={});this.setOptions(a);this._setWidthHeight(a);if(this._element&&this.crossOrigin)this._element.crossOrigin=
this.crossOrigin},_initFilters:function(a,b){a.filters&&a.filters.length?f.util.enlivenObjects(a.filters,function(a){b&&b(a)},"fabric.Image.filters"):b&&b()},_setWidthHeight:function(a){this.width="width"in a?a.width:this.getElement()?this.getElement().width||0:0;this.height="height"in a?a.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),f.Image.CSS_CANVAS="canvas-img",f.Image.prototype.getSvgSrc=f.Image.prototype.getSrc,f.Image.fromObject=function(a,b){f.util.loadImage(a.src,
function(c){f.Image.prototype._initFilters.call(a,a,function(h){a.filters=h||[];h=new f.Image(c,a);b&&b(h)})},null,a.crossOrigin)},f.Image.fromURL=function(a,b,c){f.util.loadImage(a,function(a){b(new f.Image(a,c))},null,c&&c.crossOrigin)},f.Image.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat("x y width height xlink:href".split(" ")),f.Image.fromElement=function(d,b,c){d=f.parseAttributes(d,f.Image.ATTRIBUTE_NAMES);f.Image.fromURL(d["xlink:href"],b,a(c?f.util.object.clone(c):{},d))},f.Image.async=!0,
f.Image.pngCompression=1)})(typeof j!=="undefined"?j:this);f.util.object.extend(f.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.getAngle()%360;return e>0?Math.round((e-1)/90)*90:Math.round(e/90)*90},straighten:function(){this.setAngle(this._getAngleValueForStraighten());return this},fxStraighten:function(e){var e=e||{},a=function(){},d=e.onComplete||a,b=e.onChange||a,c=this;f.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,
onChange:function(a){c.setAngle(a);b()},onComplete:function(){c.setCoords();d()},onStart:function(){c.set("active",!1)}});return this}});f.util.object.extend(f.StaticCanvas.prototype,{straightenObject:function(e){e.straighten();this.renderAll();return this},fxStraightenObject:function(e){e.fxStraighten({onChange:this.renderAll.bind(this)});return this}});f.Image.filters=f.Image.filters||{};f.Image.filters.BaseFilter=f.util.createClass({type:"BaseFilter",toObject:function(){return{type:this.type}},
toJSON:function(){return this.toObject()}});(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Brightness=a.util.createClass(a.Image.filters.BaseFilter,{type:"Brightness",initialize:function(a){a=a||{};this.brightness=a.brightness||0},applyTo:function(a){for(var c=a.getContext("2d"),a=c.getImageData(0,0,a.width,a.height),d=a.data,g=this.brightness,e=0,f=d.length;e<f;e+=4)d[e]+=g,d[e+1]+=g,d[e+2]+=g;c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),
{brightness:this.brightness})}});a.Image.filters.Brightness.fromObject=function(b){return new a.Image.filters.Brightness(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Convolute=a.util.createClass(a.Image.filters.BaseFilter,{type:"Convolute",initialize:function(b){b=b||{};this.opaque=b.opaque;this.matrix=b.matrix||[0,0,0,0,1,0,0,0,0];this.tmpCtx=a.util.createCanvasElement().getContext("2d")},_createImageData:function(a,c){return this.tmpCtx.createImageData(a,
c)},applyTo:function(a){for(var c=this.matrix,d=a.getContext("2d"),g=d.getImageData(0,0,a.width,a.height),a=Math.round(Math.sqrt(c.length)),e=Math.floor(a/2),f=g.data,m=g.width,g=g.height,n=this._createImageData(m,g),o=n.data,p=this.opaque?1:0,q=0;q<g;q++)for(var x=0;x<m;x++){for(var j=q,t=x,l=(q*m+x)*4,A=0,v=0,y=0,z=0,s=0;s<a;s++)for(var r=0;r<a;r++){var u=j+s-e,B=t+r-e;u<0||u>g||B<0||B>m||(u=(u*m+B)*4,B=c[s*a+r],A+=f[u]*B,v+=f[u+1]*B,y+=f[u+2]*B,z+=f[u+3]*B)}o[l]=A;o[l+1]=v;o[l+2]=y;o[l+3]=z+p*
(255-z)}d.putImageData(n,0,0)},toObject:function(){return d(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}});a.Image.filters.Convolute.fromObject=function(b){return new a.Image.filters.Convolute(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.GradientTransparency=a.util.createClass(a.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(a){a=a||{};this.threshold=a.threshold||100},applyTo:function(a){for(var c=
a.getContext("2d"),a=c.getImageData(0,0,a.width,a.height),d=a.data,g=this.threshold,e=d.length,f=0,m=d.length;f<m;f+=4)d[f+3]=g+255*(e-f)/e;c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{threshold:this.threshold})}});a.Image.filters.GradientTransparency.fromObject=function(b){return new a.Image.filters.GradientTransparency(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={});a.Image.filters.Grayscale=a.util.createClass(a.Image.filters.BaseFilter,
{type:"Grayscale",applyTo:function(a){for(var b=a.getContext("2d"),a=b.getImageData(0,0,a.width,a.height),c=a.data,h=a.width*a.height*4,g=0,e;g<h;)e=(c[g]+c[g+1]+c[g+2])/3,c[g]=e,c[g+1]=e,c[g+2]=e,g+=4;b.putImageData(a,0,0)}});a.Image.filters.Grayscale.fromObject=function(){return new a.Image.filters.Grayscale}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={});a.Image.filters.Invert=a.util.createClass(a.Image.filters.BaseFilter,{type:"Invert",applyTo:function(a){var b=a.getContext("2d"),
a=b.getImageData(0,0,a.width,a.height),c=a.data,h=c.length,g;for(g=0;g<h;g+=4)c[g]=255-c[g],c[g+1]=255-c[g+1],c[g+2]=255-c[g+2];b.putImageData(a,0,0)}});a.Image.filters.Invert.fromObject=function(){return new a.Image.filters.Invert}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Mask=a.util.createClass(a.Image.filters.BaseFilter,{type:"Mask",initialize:function(a){a=a||{};this.mask=a.mask;this.channel=[0,1,2,3].indexOf(a.channel)>
-1?a.channel:0},applyTo:function(b){if(this.mask){var c=b.getContext("2d"),b=c.getImageData(0,0,b.width,b.height),d=b.data,g=this.mask.getElement(),e=a.util.createCanvasElement(),f=this.channel,m=b.width*b.height*4;e.width=g.width;e.height=g.height;e.getContext("2d").drawImage(g,0,0,g.width,g.height);e=e.getContext("2d").getImageData(0,0,g.width,g.height).data;for(g=0;g<m;g+=4)d[g+3]=e[g+f];c.putImageData(b,0,0)}},toObject:function(){return d(this.callSuper("toObject"),{mask:this.mask.toObject(),
channel:this.channel})}});a.Image.filters.Mask.fromObject=function(b,c){a.util.loadImage(b.mask.src,function(d){b.mask=new a.Image(d,b.mask);c&&c(new a.Image.filters.Mask(b))})};a.Image.filters.Mask.async=!0})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Noise=a.util.createClass(a.Image.filters.BaseFilter,{type:"Noise",initialize:function(a){a=a||{};this.noise=a.noise||0},applyTo:function(a){for(var c=a.getContext("2d"),a=c.getImageData(0,
0,a.width,a.height),d=a.data,g=this.noise,e,f=0,m=d.length;f<m;f+=4)e=(0.5-Math.random())*g,d[f]+=e,d[f+1]+=e,d[f+2]+=e;c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{noise:this.noise})}});a.Image.filters.Noise.fromObject=function(b){return new a.Image.filters.Noise(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Pixelate=a.util.createClass(a.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(a){a=
a||{};this.blocksize=a.blocksize||4},applyTo:function(a){var c=a.getContext("2d"),a=c.getImageData(0,0,a.width,a.height),d=a.data,g=a.height,e=a.width,f,m,n,o,p,q,x;for(m=0;m<g;m+=this.blocksize)for(n=0;n<e;n+=this.blocksize){f=m*4*e+n*4;o=d[f];p=d[f+1];q=d[f+2];x=d[f+3];for(var j=m,t=m+this.blocksize;j<t;j++)for(var l=n,A=n+this.blocksize;l<A;l++)f=j*4*e+l*4,d[f]=o,d[f+1]=p,d[f+2]=q,d[f+3]=x}c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{blocksize:this.blocksize})}});
a.Image.filters.Pixelate.fromObject=function(b){return new a.Image.filters.Pixelate(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.RemoveWhite=a.util.createClass(a.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(a){a=a||{};this.threshold=a.threshold||30;this.distance=a.distance||20},applyTo:function(a){for(var c=a.getContext("2d"),a=c.getImageData(0,0,a.width,a.height),d=a.data,g=this.distance,e=255-this.threshold,
f=Math.abs,m,n,o,p=0,q=d.length;p<q;p+=4)m=d[p],n=d[p+1],o=d[p+2],m>e&&n>e&&o>e&&f(m-n)<g&&f(m-o)<g&&f(n-o)<g&&(d[p+3]=1);c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}});a.Image.filters.RemoveWhite.fromObject=function(b){return new a.Image.filters.RemoveWhite(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={});a.Image.filters.Sepia=a.util.createClass(a.Image.filters.BaseFilter,{type:"Sepia",
applyTo:function(a){var b=a.getContext("2d"),a=b.getImageData(0,0,a.width,a.height),c=a.data,h=c.length,g,e;for(g=0;g<h;g+=4)e=0.3*c[g]+0.59*c[g+1]+0.11*c[g+2],c[g]=e+100,c[g+1]=e+50,c[g+2]=e+255;b.putImageData(a,0,0)}});a.Image.filters.Sepia.fromObject=function(){return new a.Image.filters.Sepia}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={});a.Image.filters.Sepia2=a.util.createClass(a.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(a){var b=a.getContext("2d"),
a=b.getImageData(0,0,a.width,a.height),c=a.data,h=c.length,g,e,f,m;for(g=0;g<h;g+=4)e=c[g],f=c[g+1],m=c[g+2],c[g]=(e*0.393+f*0.769+m*0.189)/1.351,c[g+1]=(e*0.349+f*0.686+m*0.168)/1.203,c[g+2]=(e*0.272+f*0.534+m*0.131)/2.14;b.putImageData(a,0,0)}});a.Image.filters.Sepia2.fromObject=function(){return new a.Image.filters.Sepia2}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Tint=a.util.createClass(a.Image.filters.BaseFilter,{type:"Tint",
initialize:function(b){b=b||{};this.color=b.color||"#000000";this.opacity=typeof b.opacity!=="undefined"?b.opacity:(new a.Color(this.color)).getAlpha()},applyTo:function(b){var c=b.getContext("2d"),b=c.getImageData(0,0,b.width,b.height),d=b.data,g=d.length,e,f,m,n,o,p,q,x;e=(new a.Color(this.color)).getSource();f=e[0]*this.opacity;m=e[1]*this.opacity;n=e[2]*this.opacity;x=1-this.opacity;for(e=0;e<g;e+=4)o=d[e],p=d[e+1],q=d[e+2],d[e]=f+o*x,d[e+1]=m+p*x,d[e+2]=n+q*x;c.putImageData(b,0,0)},toObject:function(){return d(this.callSuper("toObject"),
{color:this.color,opacity:this.opacity})}});a.Image.filters.Tint.fromObject=function(b){return new a.Image.filters.Tint(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend;a.Image.filters.Multiply=a.util.createClass(a.Image.filters.BaseFilter,{type:"Multiply",initialize:function(a){a=a||{};this.color=a.color||"#000000"},applyTo:function(b){var c=b.getContext("2d"),b=c.getImageData(0,0,b.width,b.height),d=b.data,g=d.length,e,f;f=(new a.Color(this.color)).getSource();
for(e=0;e<g;e+=4)d[e]*=f[0]/255,d[e+1]*=f[1]/255,d[e+2]*=f[2]/255;c.putImageData(b,0,0)},toObject:function(){return d(this.callSuper("toObject"),{color:this.color})}});a.Image.filters.Multiply.fromObject=function(b){return new a.Image.filters.Multiply(b)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric;a.Image.filters.Blend=a.util.createClass({type:"Blend",initialize:function(a){a=a||{};this.color=a.color||"#000";this.image=a.image||!1;this.mode=a.mode||"multiply";this.alpha=a.alpha||
1},applyTo:function(d){var b=d.getContext("2d"),d=b.getImageData(0,0,d.width,d.height),c=d.data,h,g,e,f,m,n,o,p=!1;this.image?(p=!0,o=a.util.createCanvasElement(),o.width=this.image.width,o.height=this.image.height,o=new a.StaticCanvas(o),o.add(this.image),o=o.getContext("2d").getImageData(0,0,o.width,o.height).data):(o=(new a.Color(this.color)).getSource(),h=o[0]*this.alpha,g=o[1]*this.alpha,e=o[2]*this.alpha);for(var q=0,x=c.length;q<x;q+=4)switch(f=c[q],m=c[q+1],n=c[q+2],p&&(h=o[q]*this.alpha,
g=o[q+1]*this.alpha,e=o[q+2]*this.alpha),this.mode){case "multiply":c[q]=f*h/255;c[q+1]=m*g/255;c[q+2]=n*e/255;break;case "screen":c[q]=1-(1-f)*(1-h);c[q+1]=1-(1-m)*(1-g);c[q+2]=1-(1-n)*(1-e);break;case "add":c[q]=Math.min(255,f+h);c[q+1]=Math.min(255,m+g);c[q+2]=Math.min(255,n+e);break;case "diff":case "difference":c[q]=Math.abs(f-h);c[q+1]=Math.abs(m-g);c[q+2]=Math.abs(n-e);break;case "subtract":f-=h;m-=g;n-=e;c[q]=f<0?0:f;c[q+1]=m<0?0:m;c[q+2]=n<0?0:n;break;case "darken":c[q]=Math.min(f,h);c[q+
1]=Math.min(m,g);c[q+2]=Math.min(n,e);break;case "lighten":c[q]=Math.max(f,h),c[q+1]=Math.max(m,g),c[q+2]=Math.max(n,e)}b.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}});a.Image.filters.Blend.fromObject=function(d){return new a.Image.filters.Blend(d)}})(typeof j!=="undefined"?j:this);(function(e){var a=e.fabric||(e.fabric={}),d=a.util.object.extend,b=a.util.object.clone,c=a.util.toFixed,h=a.StaticCanvas.supports("setLineDash");
a.Text?a.warn("fabric.Text is already defined"):(e=a.Object.prototype.stateProperties.concat(),e.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor","useNative","path"),a.Text=a.util.createClass(a.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,textDecoration:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",
textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.3,textBackgroundColor:"",path:null,useNative:!0,stateProperties:e,stroke:null,shadow:null,initialize:function(a,c){c=c||{};this.text=a;this.__skipDimension=!0;this.setOptions(c);this.__skipDimension=!1;this._initDimensions()},_initDimensions:function(){this.__skipDimension||this._render(a.util.createCanvasElement().getContext("2d"))},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+
this.fontFamily+'" }>'},_render:function(a){typeof Cufon==="undefined"||this.useNative===!0?this._renderViaNative(a):this._renderViaCufon(a)},_renderViaNative:function(c){var b=this.text.split(this._reNewline);this._setTextStyles(c);this.width=this._getTextWidth(c,b);this.height=this._getTextHeight(c,b);this.clipTo&&a.util.clipContext(this,c);this._renderTextBackground(c,b);this._translateForTextAlign(c);this._renderText(c,b);this.textAlign!=="left"&&this.textAlign!=="justify"&&c.restore();this._renderTextDecoration(c,
b);this.clipTo&&c.restore();this._setBoundaries(c,b);this._totalLineHeight=0},_renderText:function(a,c){a.save();this._setShadow(a);this._setupCompositeOperation(a);this._renderTextFill(a,c);this._renderTextStroke(a,c);this._restoreCompositeOperation(a);this._removeShadow(a);a.restore()},_translateForTextAlign:function(a){this.textAlign!=="left"&&this.textAlign!=="justify"&&(a.save(),a.translate(this.textAlign==="center"?this.width/2:this.width,0))},_setBoundaries:function(a,c){this._boundaries=[];
for(var b=0,d=c.length;b<d;b++){var h=this._getLineWidth(a,c[b]),e=this._getLineLeftOffset(h);this._boundaries.push({height:this.fontSize*this.lineHeight,width:h,left:e})}},_setTextStyles:function(a){this._setFillStyles(a);this._setStrokeStyles(a);a.textBaseline="alphabetic";if(!this.skipTextAlign)a.textAlign=this.textAlign;a.font=this._getFontDeclaration()},_getTextHeight:function(a,c){return this.fontSize*c.length*this.lineHeight},_getTextWidth:function(a,c){for(var b=a.measureText(c[0]||"|").width,
d=1,h=c.length;d<h;d++){var e=a.measureText(c[d]).width;e>b&&(b=e)}return b},_renderChars:function(a,c,b,d,h){c[a](b,d,h)},_renderTextLine:function(a,c,b,d,h,e){h-=this.fontSize/4;if(this.textAlign!=="justify")this._renderChars(a,c,b,d,h,e);else{var f=c.measureText(b).width,q=this.width;if(q>f)for(var f=b.split(/\s+/),b=c.measureText(b.replace(/\s+/g,"")).width,q=(q-b)/(f.length-1),x=b=0,j=f.length;x<j;x++)this._renderChars(a,c,f[x],d+b,h,e),b+=c.measureText(f[x]).width+q;else this._renderChars(a,
c,b,d,h,e)}},_getLeftOffset:function(){return a.isLikelyNode?0:-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(a,c){if(this.fill||this._skipFillStrokeCheck){this._boundaries=[];for(var b=0,d=0,h=c.length;d<h;d++){var e=this._getHeightOfLine(a,d,c);b+=e;this._renderTextLine("fillText",a,c[d],this._getLeftOffset(),this._getTopOffset()+b,d)}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a)}},_renderTextStroke:function(a,c){if(this.stroke&&this.strokeWidth!==
0||this._skipFillStrokeCheck){var b=0;a.save();this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),h&&a.setLineDash(this.strokeDashArray));a.beginPath();for(var d=0,e=c.length;d<e;d++){var f=this._getHeightOfLine(a,d,c);b+=f;this._renderTextLine("strokeText",a,c[d],this._getLeftOffset(),this._getTopOffset()+b,d)}a.closePath();a.restore()}},_getHeightOfLine:function(){return this.fontSize*this.lineHeight},_renderTextBackground:function(a,
c){this._renderTextBoxBackground(a);this._renderTextLinesBackground(a,c)},_renderTextBoxBackground:function(a){if(this.backgroundColor)a.save(),a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),a.restore()},_renderTextLinesBackground:function(a,c){if(this.textBackgroundColor){a.save();a.fillStyle=this.textBackgroundColor;for(var b=0,d=c.length;b<d;b++)if(c[b]!==""){var h=this._getLineWidth(a,c[b]),e=this._getLineLeftOffset(h);a.fillRect(this._getLeftOffset()+
e,this._getTopOffset()+b*this.fontSize*this.lineHeight,h,this.fontSize*this.lineHeight)}a.restore()}},_getLineLeftOffset:function(a){return this.textAlign==="center"?(this.width-a)/2:this.textAlign==="right"?this.width-a:0},_getLineWidth:function(a,c){return this.textAlign==="justify"?this.width:a.measureText(c).width},_renderTextDecoration:function(a,c){function b(e){for(var f=0,k=c.length;f<k;f++){var x=h._getLineWidth(a,c[f]),j=h._getLineLeftOffset(x);a.fillRect(h._getLeftOffset()+j,~~(e+f*h._getHeightOfLine(a,
f,c)-d),x,1)}}if(this.textDecoration){var d=this._getTextHeight(a,c)/2,h=this;this.textDecoration.indexOf("underline")>-1&&b(this.fontSize*this.lineHeight);this.textDecoration.indexOf("line-through")>-1&&b(this.fontSize*this.lineHeight-this.fontSize/2);this.textDecoration.indexOf("overline")>-1&&b(this.fontSize*this.lineHeight-this.fontSize)}},_getFontDeclaration:function(){return[a.isLikelyNode?this.fontWeight:this.fontStyle,a.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",a.isLikelyNode?
'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,c){if(this.visible){a.save();c||this.transform(a);var b=this.group&&this.group.type==="path-group";b&&a.translate(-this.group.width/2,-this.group.height/2);this.transformMatrix&&a.transform.apply(a,this.transformMatrix);b&&a.translate(this.left,this.top);this._render(a);a.restore()}},toObject:function(a){a=d(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,
fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,path:this.path,textBackgroundColor:this.textBackgroundColor,useNative:this.useNative});this.includeDefaultValues||this._removeDefaultValues(a);return a},toSVG:function(a){var c=[],b=this.text.split(this._reNewline),d=this._getSVGLeftTopOffsets(b),h=this._getSVGTextAndBg(d.lineTop,d.textLeft,b),b=this._getSVGShadows(d.lineTop,b);d.textTop+=this._fontAscent?this._fontAscent/5*this.lineHeight:
0;this._wrapSVGTextAndBg(c,h,b,d);return a?a(c.join("")):c.join("")},_getSVGLeftTopOffsets:function(a){return{textLeft:-(this.width/2)+(this.group&&this.group.type==="path-group"?this.left:0),textTop:(this.useNative?this.fontSize-1:this.height/2-a.length*this.fontSize-this._totalLineHeight)+(this.group&&this.group.type==="path-group"?this.top:0),lineTop:this.useNative?this.fontSize*this.lineHeight:-this._fontAscent-this._fontAscent/5*this.lineHeight}},_wrapSVGTextAndBg:function(a,b,d,h){a.push('<g transform="',
this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',b.textBgRects.join(""),"<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" ','transform="translate(',c(h.textLeft,2)," ",c(h.textTop,2),')">',d.join(""),
b.textSpans.join(""),"</text>\n","</g>\n")},_getSVGShadows:function(b,d){var h=[],e,f,o=1;if(!this.shadow||!this._boundaries)return h;for(e=0,f=d.length;e<f;e++)d[e]!==""?(h.push('<tspan x="',c((this._boundaries&&this._boundaries[e]?this._boundaries[e].left:0)+o+this.shadow.offsetX,2),e===0||this.useNative?'" y':'" dy','="',c(this.useNative?b*e-this.height/2+this.shadow.offsetY:b+(e===0?this.shadow.offsetY:0),2),'" ',this._getFillAttributes(this.shadow.color),">",a.util.string.escapeXml(d[e]),"</tspan>"),
o=1):o++;return h},_getSVGTextAndBg:function(a,c,b){var d=[],h=[],e=1;this._setSVGBg(h);for(var f=0,q=b.length;f<q;f++)b[f]!==""?(this._setSVGTextLineText(b[f],f,d,a,e,h),e=1):e++,this.textBackgroundColor&&this._boundaries&&this._setSVGTextLineBg(h,f,c,a);return{textSpans:d,textBgRects:h}},_setSVGTextLineText:function(b,d,h,e,f){var o=this._boundaries&&this._boundaries[d]?c(this._boundaries[d].left,2):0;h.push('<tspan x="',o,'" ',d===0||this.useNative?"y":"dy",'="',c(this.useNative?e*d-this.height/
2:e*f,2),'" ',this._getFillAttributes(this.fill),">",a.util.string.escapeXml(b),"</tspan>")},_setSVGTextLineBg:function(a,b,d,h){a.push("<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',c(d+this._boundaries[b].left,2),'" y="',c(h*b-this.height/2,2),'" width="',c(this._boundaries[b].width,2),'" height="',c(this._boundaries[b].height,2),'"></rect>\n')},_setSVGBg:function(a){this.backgroundColor&&this._boundaries&&a.push("<rect ",this._getFillAttributes(this.backgroundColor),' x="',c(-this.width/
2,2),'" y="',c(-this.height/2,2),'" width="',c(this.width,2),'" height="',c(this.height,2),'"></rect>')},_getFillAttributes:function(c){var b=c&&typeof c==="string"?new a.Color(c):"";return!b||!b.getSource()||b.getAlpha()===1?'fill="'+c+'"':'opacity="'+b.getAlpha()+'" fill="'+b.setAlpha(1).toRgb()+'"'},_set:function(a,c){if(a==="fontFamily"&&this.path)this.path=this.path.replace(/(.*?)([^\/]*)(\.font\.js)/,"$1"+c+"$3");this.callSuper("_set",a,c);a in this._dimensionAffectingProps&&(this._initDimensions(),
this.setCoords())},complexity:function(){return 1}}),a.Text.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),a.Text.DEFAULT_SVG_FONT_SIZE=16,a.Text.fromElement=function(c,b){if(!c)return null;var d=a.parseAttributes(c,a.Text.ATTRIBUTE_NAMES),b=a.util.object.extend(b?a.util.object.clone(b):{},d);"dx"in d&&(b.left+=d.dx);"dy"in d&&(b.top+=d.dy);if(!("fontSize"in b))b.fontSize=a.Text.DEFAULT_SVG_FONT_SIZE;if(!b.originX)b.originX=
"left";var d=new a.Text(c.textContent,b),h=0;d.originX==="left"&&(h=d.getWidth()/2);d.originX==="right"&&(h=-d.getWidth()/2);d.set({left:d.getLeft()+h,top:d.getTop()-d.getHeight()/2});return d},a.Text.fromObject=function(c){return new a.Text(c.text,b(c))},a.util.createAccessors(a.Text))})(typeof j!=="undefined"?j:this);(function(){var e=f.util.object.clone;f.IText=f.util.createClass(f.Text,f.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,
editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1E3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!0,_reSpace:/\s|\n/,_fontSizeFraction:4,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(a,d){this.styles=d?d.styles||{}:{};this.callSuper("initialize",a,d);this.initBehavior();f.IText.instances.push(this);this.__lineWidths={};this.__lineHeights={};this.__lineOffsets=
{}},isEmptyStyles:function(){if(!this.styles)return!0;var a=this.styles,d;for(d in a)for(var b in a[d])for(var c in a[d][b])return!1;return!0},setSelectionStart:function(a){this.selectionStart!==a&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}));this.selectionStart=a;this.hiddenTextarea&&(this.hiddenTextarea.selectionStart=a)},setSelectionEnd:function(a){this.selectionEnd!==a&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",
{target:this}));this.selectionEnd=a;this.hiddenTextarea&&(this.hiddenTextarea.selectionEnd=a)},getSelectionStyles:function(a,d){if(arguments.length===2){for(var b=[],c=a;c<d;c++)b.push(this.getSelectionStyles(c));return b}b=this.get2DCursorLocation(a);return this.styles[b.lineIndex]?this.styles[b.lineIndex][b.charIndex]||{}:{}},setSelectionStyles:function(a){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,a);else for(var d=this.selectionStart;d<this.selectionEnd;d++)this._extendStyles(d,
a);return this},_extendStyles:function(a,d){var b=this.get2DCursorLocation(a);this.styles[b.lineIndex]||(this.styles[b.lineIndex]={});this.styles[b.lineIndex][b.charIndex]||(this.styles[b.lineIndex][b.charIndex]={});f.util.object.extend(this.styles[b.lineIndex][b.charIndex],d)},_render:function(a){this.callSuper("_render",a);this.ctx=a;this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var a=this.text.split(""),d;this.selectionStart===this.selectionEnd?
(d=this._getCursorBoundaries(a,"cursor"),this.renderCursor(d)):(d=this._getCursorBoundaries(a,"selection"),this.renderSelection(a,d))}},get2DCursorLocation:function(a){if(typeof a==="undefined")a=this.selectionStart;a=this.text.slice(0,a).split(this._reNewline);return{lineIndex:a.length-1,charIndex:a[a.length-1].length}},getCurrentCharStyle:function(a,d){var b=this.styles[a]&&this.styles[a][d===0?0:d-1];return{fontSize:b&&b.fontSize||this.fontSize,fill:b&&b.fill||this.fill,textBackgroundColor:b&&
b.textBackgroundColor||this.textBackgroundColor,textDecoration:b&&b.textDecoration||this.textDecoration,fontFamily:b&&b.fontFamily||this.fontFamily,fontWeight:b&&b.fontWeight||this.fontWeight,fontStyle:b&&b.fontStyle||this.fontStyle,stroke:b&&b.stroke||this.stroke,strokeWidth:b&&b.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(a,d){return this.styles[a]&&this.styles[a][d===0?0:d-1]&&this.styles[a][d===0?0:d-1].fontSize||this.fontSize},getCurrentCharColor:function(a,d){return this.styles[a]&&
this.styles[a][d===0?0:d-1]&&this.styles[a][d===0?0:d-1].fill||this.cursorColor},_getCursorBoundaries:function(a,d){var b=this.get2DCursorLocation(),c=this.text.split(this._reNewline),h=Math.round(this._getLeftOffset()),g=this._getTopOffset(),b=this._getCursorBoundariesOffsets(a,d,b,c);return{left:h,top:g,leftOffset:b.left+b.lineLeft,topOffset:b.top}},_getCursorBoundariesOffsets:function(a,d,b,c){for(var h=0,g=0,e=0,f=0,b=d==="cursor"?this._getHeightOfLine(this.ctx,0)-this.getCurrentCharFontSize(b.lineIndex,
b.charIndex):0,m=0;m<this.selectionStart;m++)a[m]==="\n"?(f=0,b+=this._getCachedLineHeight(g+(d==="cursor"?1:0)),g++,e=0):(f+=this._getWidthOfChar(this.ctx,a[m],g,e),e++),h=this._getCachedLineOffset(g,c);this._clearCache();return{top:b,left:f,lineLeft:h}},_clearCache:function(){this.__lineWidths={};this.__lineHeights={};this.__lineOffsets={}},_getCachedLineHeight:function(a){return this.__lineHeights[a]||(this.__lineHeights[a]=this._getHeightOfLine(this.ctx,a))},_getCachedLineWidth:function(a,d){return this.__lineWidths[a]||
(this.__lineWidths[a]=this._getWidthOfLine(this.ctx,a,d))},_getCachedLineOffset:function(a,d){var b=this._getCachedLineWidth(a,d);return this.__lineOffsets[a]||(this.__lineOffsets[a]=this._getLineLeftOffset(b))},renderCursor:function(a){var d=this.ctx;d.save();var b=this.get2DCursorLocation(),c=b.lineIndex,b=b.charIndex,h=this.getCurrentCharFontSize(c,b),g=c===0&&b===0?this._getCachedLineOffset(c,this.text.split(this._reNewline)):a.leftOffset;d.fillStyle=this.getCurrentCharColor(c,b);d.globalAlpha=
this.__isMousedown?1:this._currentCursorOpacity;d.fillRect(a.left+g,a.top+a.topOffset,this.cursorWidth/this.scaleX,h);d.restore()},renderSelection:function(a,d){var b=this.ctx;b.save();b.fillStyle=this.selectionColor;for(var c=this.get2DCursorLocation(this.selectionStart),h=this.get2DCursorLocation(this.selectionEnd),g=c.lineIndex,e=h.lineIndex,f=this.text.split(this._reNewline),m=g;m<=e;m++){var n=this._getCachedLineOffset(m,f)||0,o=this._getCachedLineHeight(m),p=0;if(m===g)for(var q=0,x=f[m].length;q<
x;q++){if(q>=c.charIndex&&(m!==e||q<h.charIndex))p+=this._getWidthOfChar(b,f[m][q],m,q);q<c.charIndex&&(n+=this._getWidthOfChar(b,f[m][q],m,q))}else if(m>g&&m<e)p+=this._getCachedLineWidth(m,f)||5;else if(m===e){q=0;for(x=h.charIndex;q<x;q++)p+=this._getWidthOfChar(b,f[m][q],m,q)}b.fillRect(d.left+n,d.top+d.topOffset,p,o);d.topOffset+=o}b.restore()},_renderChars:function(a,d,b,c,h,g){if(this.isEmptyStyles())return this._renderCharsFast(a,d,b,c,h);this.skipTextAlign=!0;c-=this.textAlign==="center"?
this.width/2:this.textAlign==="right"?this.width:0;var e=this.text.split(this._reNewline),f=this._getWidthOfLine(d,g,e),e=this._getHeightOfLine(d,g,e),m=this._getLineLeftOffset(f),b=b.split(""),n,f="";c+=m||0;d.save();for(var m=0,o=b.length;m<=o;m++){n=n||this.getCurrentCharStyle(g,m);var p=this.getCurrentCharStyle(g,m+1);if(this._hasStyleChanged(n,p)||m===o)this._renderChar(a,d,g,m-1,f,c,h,e),f="",n=p;f+=b[m]}d.restore()},_renderCharsFast:function(a,d,b,c,h){this.skipTextAlign=!1;a==="fillText"&&
this.fill&&this.callSuper("_renderChars",a,d,b,c,h);a==="strokeText"&&this.stroke&&this.callSuper("_renderChars",a,d,b,c,h)},_renderChar:function(a,d,b,c,h,g,e,f){var m;if(this.styles&&this.styles[b]&&(m=this.styles[b][c])){var n=m.stroke||this.stroke,o=m.fill||this.fill;d.save();a=this._applyCharStylesGetWidth(d,h,b,c,m);b=this._getHeightOfChar(d,h,b,c);o&&d.fillText(h,g,e);n&&d.strokeText(h,g,e);this._renderCharDecoration(d,m,g,e,a,f,b);d.restore();d.translate(a,0)}else{if(a==="strokeText"&&this.stroke)d[a](h,
g,e);if(a==="fillText"&&this.fill)d[a](h,g,e);a=this._applyCharStylesGetWidth(d,h,b,c);this._renderCharDecoration(d,null,g,e,a,f);d.translate(d.measureText(h).width,0)}},_hasStyleChanged:function(a,d){return a.fill!==d.fill||a.fontSize!==d.fontSize||a.textBackgroundColor!==d.textBackgroundColor||a.textDecoration!==d.textDecoration||a.fontFamily!==d.fontFamily||a.fontWeight!==d.fontWeight||a.fontStyle!==d.fontStyle||a.stroke!==d.stroke||a.strokeWidth!==d.strokeWidth},_renderCharDecoration:function(a,
d,b,c,h,g,e){var f=d?d.textDecoration||this.textDecoration:this.textDecoration,d=(d?d.fontSize:null)||this.fontSize;f&&(f.indexOf("underline")>-1&&this._renderCharDecorationAtOffset(a,b,c+this.fontSize/this._fontSizeFraction,h,0,this.fontSize/20),f.indexOf("line-through")>-1&&this._renderCharDecorationAtOffset(a,b,c+this.fontSize/this._fontSizeFraction,h,e/2,d/20),f.indexOf("overline")>-1&&this._renderCharDecorationAtOffset(a,b,c,h,g-this.fontSize/this._fontSizeFraction,this.fontSize/20))},_renderCharDecorationAtOffset:function(a,
d,b,c,h,g){a.fillRect(d,b-h,c,g)},_renderTextLine:function(a,d,b,c,h,g){h+=this.fontSize/4;this.callSuper("_renderTextLine",a,d,b,c,h,g)},_renderTextDecoration:function(a,d){if(this.isEmptyStyles())return this.callSuper("_renderTextDecoration",a,d)},_renderTextLinesBackground:function(a,d){if(this.textBackgroundColor||this.styles){a.save();if(this.textBackgroundColor)a.fillStyle=this.textBackgroundColor;for(var b=0,c=this.fontSize/this._fontSizeFraction,h=0,g=d.length;h<g;h++){var e=this._getHeightOfLine(a,
h,d);if(d[h]!==""){var f=this._getWidthOfLine(a,h,d),m=this._getLineLeftOffset(f);if(this.textBackgroundColor)a.fillStyle=this.textBackgroundColor,a.fillRect(this._getLeftOffset()+m,this._getTopOffset()+b+c,f,e);if(this.styles[h])for(var f=0,n=d[h].length;f<n;f++)if(this.styles[h]&&this.styles[h][f]&&this.styles[h][f].textBackgroundColor){var o=d[h][f];a.fillStyle=this.styles[h][f].textBackgroundColor;a.fillRect(this._getLeftOffset()+m+this._getWidthOfCharsAt(a,h,f,d),this._getTopOffset()+b+c,this._getWidthOfChar(a,
o,h,f,d)+1,e)}}b+=e}a.restore()}},_getCacheProp:function(a,d){return a+d.fontFamily+d.fontSize+d.fontWeight+d.fontStyle+d.shadow},_applyCharStylesGetWidth:function(a,d,b,c,h){var g;g=(b=h||this.styles[b]&&this.styles[b][c])?e(b):{},b=g;this._applyFontStyles(b);c=this._getCacheProp(d,b);if(this.isEmptyStyles()&&this._charWidthsCache[c]&&this.caching)return this._charWidthsCache[c];if(typeof b.shadow==="string")b.shadow=new f.Shadow(b.shadow);h=b.fill||this.fill;a.fillStyle=h.toLive?h.toLive(a):h;if(b.stroke)a.strokeStyle=
b.stroke&&b.stroke.toLive?b.stroke.toLive(a):b.stroke;a.lineWidth=b.strokeWidth||this.strokeWidth;a.font=this._getFontDeclaration.call(b);this._setShadow.call(b,a);if(!this.caching)return a.measureText(d).width;if(!this._charWidthsCache[c])this._charWidthsCache[c]=a.measureText(d).width;return this._charWidthsCache[c]},_applyFontStyles:function(a){if(!a.fontFamily)a.fontFamily=this.fontFamily;if(!a.fontSize)a.fontSize=this.fontSize;if(!a.fontWeight)a.fontWeight=this.fontWeight;if(!a.fontStyle)a.fontStyle=
this.fontStyle},_getStyleDeclaration:function(a,d){return this.styles[a]&&this.styles[a][d]?e(this.styles[a][d]):{}},_getWidthOfChar:function(a,d,b,c){if(this.textAlign==="justify"&&/\s/.test(d))return this._getWidthOfSpace(a,b);var h=this._getStyleDeclaration(b,c);this._applyFontStyles(h);h=this._getCacheProp(d,h);if(this._charWidthsCache[h]&&this.caching)return this._charWidthsCache[h];else if(a)return a.save(),d=this._applyCharStylesGetWidth(a,d,b,c),a.restore(),d},_getHeightOfChar:function(a,
d,b,c){return this.styles[b]&&this.styles[b][c]?this.styles[b][c].fontSize||this.fontSize:this.fontSize},_getWidthOfCharAt:function(a,d,b,c){c=c||this.text.split(this._reNewline);c=c[d].split("")[b];return this._getWidthOfChar(a,c,d,b)},_getHeightOfCharAt:function(a,d,b,c){c=c||this.text.split(this._reNewline);c=c[d].split("")[b];return this._getHeightOfChar(a,c,d,b)},_getWidthOfCharsAt:function(a,d,b,c){for(var h=0,g=0;g<b;g++)h+=this._getWidthOfCharAt(a,d,g,c);return h},_getWidthOfLine:function(a,
d,b){return this._getWidthOfCharsAt(a,d,b[d].length,b)},_getWidthOfSpace:function(a,d){var b=this.text.split(this._reNewline)[d],c=b.split(/\s+/);return(this.width-this._getWidthOfWords(a,b,d))/(c.length-1)},_getWidthOfWords:function(a,d,b){for(var c=0,h=0;h<d.length;h++){var g=d[h];g.match(/\s/)||(c+=this._getWidthOfChar(a,g,b,h))}return c},_getTextWidth:function(a,d){if(this.isEmptyStyles())return this.callSuper("_getTextWidth",a,d);for(var b=this._getWidthOfLine(a,0,d),c=1,h=d.length;c<h;c++){var g=
this._getWidthOfLine(a,c,d);g>b&&(b=g)}return b},_getHeightOfLine:function(a,d,b){for(var b=b||this.text.split(this._reNewline),c=this._getHeightOfChar(a,b[d][0],d,0),b=b[d].split(""),h=1,g=b.length;h<g;h++){var e=this._getHeightOfChar(a,b[h],d,h);e>c&&(c=e)}return c*this.lineHeight},_getTextHeight:function(a,d){for(var b=0,c=0,h=d.length;c<h;c++)b+=this._getHeightOfLine(a,c,d);return b},_getTopOffset:function(){return f.Text.prototype._getTopOffset.call(this)-this.fontSize/this._fontSizeFraction},
_renderTextBoxBackground:function(a){if(this.backgroundColor)a.save(),a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset()+this.fontSize/this._fontSizeFraction,this.width,this.height),a.restore()},toObject:function(a){return f.util.object.extend(this.callSuper("toObject",a),{styles:e(this.styles)})}});f.IText.fromObject=function(a){return new f.IText(a.text,e(a))};f.IText.instances=[]})();(function(){var e=f.util.object.clone;f.util.object.extend(f.IText.prototype,
{initBehavior:function(){this.initAddedHandler();this.initCursorSelectionHandlers();this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var a=this;setTimeout(function(){a.selected=!0},100)})},initAddedHandler:function(){this.on("added",function(){if(this.canvas&&!this.canvas._hasITextHandlers)this.canvas._hasITextHandlers=!0,this._initCanvasHandlers()})},_initCanvasHandlers:function(){this.canvas.on("selection:cleared",function(){f.IText.prototype.exitEditingOnOthers.call()});
this.canvas.on("mouse:up",function(){f.IText.instances.forEach(function(a){a.__isMousedown=!1})});this.canvas.on("object:selected",function(a){f.IText.prototype.exitEditingOnOthers.call(a.target)})},_tick:function(){if(!this._abortCursorAnimation){var a=this;this.animate("_currentCursorOpacity",1,{duration:this.cursorDuration,onComplete:function(){a._onTickComplete()},onChange:function(){a.canvas&&a.canvas.renderAll()},abort:function(){return a._abortCursorAnimation}})}},_onTickComplete:function(){if(!this._abortCursorAnimation){var a=
this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1);this._cursorTimeout1=setTimeout(function(){a.animate("_currentCursorOpacity",0,{duration:this.cursorDuration/2,onComplete:function(){a._tick()},onChange:function(){a.canvas&&a.canvas.renderAll()},abort:function(){return a._abortCursorAnimation}})},100)}},initDelayedCursor:function(a){var d=this,b=a?0:this.cursorDelay;if(a)this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&this.canvas.renderAll();
this._cursorTimeout2&&clearTimeout(this._cursorTimeout2);this._cursorTimeout2=setTimeout(function(){d._abortCursorAnimation=!1;d._tick()},b)},abortCursorAnimation:function(){this._abortCursorAnimation=!0;clearTimeout(this._cursorTimeout1);clearTimeout(this._cursorTimeout2);this._currentCursorOpacity=0;this.canvas&&this.canvas.renderAll();var a=this;setTimeout(function(){a._abortCursorAnimation=!1},10)},selectAll:function(){this.selectionStart=0;this.selectionEnd=this.text.length;this.fire("selection:changed");
this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(a){var d=0,b=a-1;if(this._reSpace.test(this.text.charAt(b)))for(;this._reSpace.test(this.text.charAt(b));)d++,b--;for(;/\S/.test(this.text.charAt(b))&&b>-1;)d++,b--;return a-d},findWordBoundaryRight:function(a){var d=0,b=a;if(this._reSpace.test(this.text.charAt(b)))for(;this._reSpace.test(this.text.charAt(b));)d++,
b++;for(;/\S/.test(this.text.charAt(b))&&b<this.text.length;)d++,b++;return a+d},findLineBoundaryLeft:function(a){for(var d=0,b=a-1;!/\n/.test(this.text.charAt(b))&&b>-1;)d++,b--;return a-d},findLineBoundaryRight:function(a){for(var d=0,b=a;!/\n/.test(this.text.charAt(b))&&b<this.text.length;)d++,b++;return a+d},getNumNewLinesInSelectedText:function(){for(var a=0,d=0,b=this.getSelectedText().split(""),c=b.length;d<c;d++)b[d]==="\n"&&a++;return a},searchWordBoundary:function(a,d){for(var b=this._reSpace.test(this.text.charAt(a))?
a-1:a,c=this.text.charAt(b),h=/[ \n\.,;!\?\-]/;!h.test(c)&&b>0&&b<this.text.length;)b+=d,c=this.text.charAt(b);h.test(c)&&c!=="\n"&&(b+=d===1?0:1);return b},selectWord:function(a){var d=this.searchWordBoundary(a,-1),a=this.searchWordBoundary(a,1);this.setSelectionStart(d);this.setSelectionEnd(a);this.initDelayedCursor(!0)},selectLine:function(a){var d=this.findLineBoundaryLeft(a),a=this.findLineBoundaryRight(a);this.setSelectionStart(d);this.setSelectionEnd(a);this.initDelayedCursor(!0)},enterEditing:function(){if(!this.isEditing&&
this.editable)return this.exitEditingOnOthers(),this.isEditing=!0,this.initHiddenTextarea(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.canvas&&this.canvas.renderAll(),this.fire("editing:entered"),this.canvas&&this.canvas.fire("text:editing:entered",{target:this}),this},exitEditingOnOthers:function(){f.IText.instances.forEach(function(a){a.selected=!1;a.isEditing&&a.exitEditing()},this)},_setEditingProps:function(){this.hoverCursor="text";if(this.canvas)this.canvas.defaultCursor=
this.canvas.moveCursor="text";this.borderColor=this.editingBorderColor;this.hasControls=this.selectable=!1;this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){if(this.hiddenTextarea)this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&
this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){if(this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas))this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor},exitEditing:function(){this.isEditing=
this.selected=!1;this.selectable=!0;this.selectionEnd=this.selectionStart;this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea);this.hiddenTextarea=null;this.abortCursorAnimation();this._restoreEditingProps();this._currentCursorOpacity=0;this.fire("editing:exited");this.canvas&&this.canvas.fire("text:editing:exited",{target:this});return this},_removeExtraneousStyles:function(){var a=this.text.split(this._reNewline),d;for(d in this.styles)a[d]||delete this.styles[d]},
_removeCharsFromTo:function(a,d){for(var b=d;b!==a;){var c=this.get2DCursorLocation(b).charIndex;b--;(c=this.get2DCursorLocation(b).charIndex>c)?this.removeStyleObject(c,b+1):this.removeStyleObject(this.get2DCursorLocation(b).charIndex===0,b)}this.text=this.text.slice(0,a)+this.text.slice(d)},insertChars:function(a){var d=this.text.slice(this.selectionStart,this.selectionStart+1)==="\n";this.text=this.text.slice(0,this.selectionStart)+a+this.text.slice(this.selectionEnd);this.selectionStart===this.selectionEnd&&
this.insertStyleObjects(a,d,this.copiedStyles);this.selectionStart+=a.length;this.selectionEnd=this.selectionStart;this.canvas&&this.canvas.renderAll().renderAll();this.setCoords();this.fire("changed");this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(a,d,b){this.shiftLineStyles(a,1);this.styles[a+1]||(this.styles[a+1]={});var c=this.styles[a][d-1],h={};if(b)h[0]=e(c);else for(var g in this.styles[a])parseInt(g,10)>=d&&(h[parseInt(g,10)-d]=this.styles[a][g],
delete this.styles[a][g]);this.styles[a+1]=h},insertCharStyleObject:function(a,d,b){var c=this.styles[a],h=e(c);d===0&&!b&&(d=1);for(var g in h){var i=parseInt(g,10);i>=d&&(c[i+1]=h[i])}this.styles[a][d]=b||e(c[d-1])},insertStyleObjects:function(a,d,b){if(!this.isEmptyStyles()){var c=this.get2DCursorLocation(),h=c.lineIndex,c=c.charIndex;this.styles[h]||(this.styles[h]={});a==="\n"?this.insertNewlineStyleObject(h,c,d):b?this._insertStyles(b):this.insertCharStyleObject(h,c)}},_insertStyles:function(a){for(var d=
0,b=a.length;d<b;d++){var c=this.get2DCursorLocation(this.selectionStart+d);this.insertCharStyleObject(c.lineIndex,c.charIndex,a[d])}},shiftLineStyles:function(a,d){var b=e(this.styles),c;for(c in this.styles){var h=parseInt(c,10);h>a&&(this.styles[h+d]=b[h])}},removeStyleObject:function(a,d){var b=this.get2DCursorLocation(d),c=b.lineIndex,b=b.charIndex;if(a){var h=this.text.split(this._reNewline)[c-1],h=h?h.length:0;this.styles[c-1]||(this.styles[c-1]={});for(b in this.styles[c])this.styles[c-1][parseInt(b,
10)+h]=this.styles[c][b];this.shiftLineStyles(c,-1)}else{(c=this.styles[c])&&delete c[b+(this.selectionStart===this.selectionEnd?-1:0)];var g=e(c);for(h in g){var i=parseInt(h,10);i>=b&&i!==0&&(c[i-1]=g[i],delete c[i])}}},insertNewline:function(){this.insertChars("\n")}})})();f.util.object.extend(f.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date;this.__lastLastClickTime=+new Date;this.__lastPointer={};this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(e){this.__newClickTime=
+new Date;var a=this.canvas.getPointer(e.e);this.isTripleClick(a)?(this.fire("tripleclick",e),this._stopEvent(e.e)):this.isDoubleClick(a)&&(this.fire("dblclick",e),this._stopEvent(e.e));this.__lastLastClickTime=this.__lastClickTime;this.__lastClickTime=this.__newClickTime;this.__lastPointer=a;this.__lastIsEditing=this.isEditing;this.__lastSelected=this.selected},isDoubleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y&&this.__lastIsEditing},
isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault();e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler();this.initMousedownHandler();this.initMousemoveHandler();this.initMouseupHandler();this.initClicks()},initClicks:function(){this.on("dblclick",function(e){this.selectWord(this.getSelectionStartFromPointer(e.e))});
this.on("tripleclick",function(e){this.selectLine(this.getSelectionStartFromPointer(e.e))})},initMousedownHandler:function(){this.on("mousedown",function(e){var a=this.canvas.getPointer(e.e);this.__mousedownX=a.x;this.__mousedownY=a.y;this.__isMousedown=!0;this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea);this.selected&&this.setCursorByClick(e.e);if(this.isEditing)this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0)})},initMousemoveHandler:function(){this.on("mousemove",
function(e){this.__isMousedown&&this.isEditing&&(e=this.getSelectionStartFromPointer(e.e),e>=this.__selectionStartOnMouseDown?(this.setSelectionStart(this.__selectionStartOnMouseDown),this.setSelectionEnd(e)):(this.setSelectionStart(e),this.setSelectionEnd(this.__selectionStartOnMouseDown)))})},_isObjectMoved:function(e){e=this.canvas.getPointer(e);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(e){this.__isMousedown=!1;if(!this._isObjectMoved(e.e))this.__lastSelected&&
(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0})},setCursorByClick:function(e){var a=this.getSelectionStartFromPointer(e);e.shiftKey?a<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(a)):this.setSelectionEnd(a):(this.setSelectionStart(a),this.setSelectionEnd(a))},_getLocalRotatedPointer:function(e){var a=this.canvas.getPointer(e),a=new f.Point(a.x,a.y),d=new f.Point(this.left,this.top),a=f.util.rotatePoint(a,d,f.util.degreesToRadians(-this.angle));
return this.getLocalPointer(e,a)},getSelectionStartFromPointer:function(e){for(var e=this._getLocalRotatedPointer(e),a=this.text.split(this._reNewline),d=0,b=0,c=0,h=0,g=0,i=a.length;g<i;g++){c+=this._getHeightOfLine(this.ctx,g)*this.scaleY;b=this._getLineLeftOffset(this._getWidthOfLine(this.ctx,g,a))*this.scaleX;this.flipX&&(a[g]=a[g].split("").reverse().join(""));for(var f=0,m=a[g].length;f<m;f++){var n=a[g][f],d=b;b+=this._getWidthOfChar(this.ctx,n,g,this.flipX?m-f:f)*this.scaleX;if(c<=e.y||b<=
e.x)h++;else return this._getNewSelectionStartFromOffset(e,d,b,h+g,m)}if(e.y<c)return this._getNewSelectionStartFromOffset(e,d,b,h+g,m)}return this.text.length},_getNewSelectionStartFromOffset:function(e,a,d,b,c){e=b+(d-e.x>e.x-a?0:1);this.flipX&&(e=c-e);if(e>this.text.length)e=this.text.length;return e}});f.util.object.extend(f.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=f.document.createElement("textarea");this.hiddenTextarea.setAttribute("autocapitalize","off");this.hiddenTextarea.style.cssText=
"position: absolute; top: 0; left: -9999px";f.document.body.appendChild(this.hiddenTextarea);f.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this));f.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this));f.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this));f.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this));if(!this._clickHandlerInitialized&&this.canvas)f.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),
this._clickHandlerInitialized=!0},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){if(e.keyCode in this._keysMap)this[this._keysMap[e.keyCode]](e);
else if(e.keyCode in this._ctrlKeysMap&&(e.ctrlKey||e.metaKey))this[this._ctrlKeysMap[e.keyCode]](e);else return;e.stopImmediatePropagation();e.preventDefault();this.canvas&&this.canvas.renderAll()}},forwardDelete:function(e){this.selectionStart===this.selectionEnd&&this.moveCursorRight(e);this.removeChars(e)},copy:function(e){var a=this.getSelectedText();(e=this._getClipboardData(e))&&e.setData("text",a);this.copiedText=a;this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},
paste:function(e){var a=null;(a=(e=this._getClipboardData(e))?e.getData("text"):this.copiedText)&&this.insertChars(a)},cut:function(e){this.selectionStart!==this.selectionEnd&&(this.copy(),this.removeChars(e))},_getClipboardData:function(e){return e&&(e.clipboardData||f.window.clipboardData)},onKeyPress:function(e){this.isEditing&&!e.metaKey&&!e.ctrlKey&&(e.which!==0&&this.insertChars(String.fromCharCode(e.which)),e.stopPropagation())},getDownCursorOffset:function(e,a){var d=a?this.selectionEnd:this.selectionStart,
b=this.text.split(this._reNewline),c=this.text.slice(0,d),h=this.text.slice(d),g=c.slice(c.lastIndexOf("\n")+1),c=h.match(/(.*)\n?/)[1],h=(h.match(/.*\n(.*)\n?/)||{})[1]||"",i=this.get2DCursorLocation(d);if(i.lineIndex===b.length-1||e.metaKey||e.keyCode===34)return this.text.length-d;for(var f=this._getLineLeftOffset(this._getWidthOfLine(this.ctx,i.lineIndex,b)),m=i.lineIndex,n=0,o=g.length;n<o;n++)d=g[n],f+=this._getWidthOfChar(this.ctx,d,m,n);b=this._getIndexOnNextLine(i,h,f,b);return c.length+
1+b},_getIndexOnNextLine:function(e,a,d,b){for(var e=e.lineIndex+1,c=this._getLineLeftOffset(this._getWidthOfLine(this.ctx,e,b)),h=0,g,b=0,i=a.length;b<i;b++){var f=this._getWidthOfChar(this.ctx,a[b],e,b);c+=f;if(c>d){g=!0;e=c;c=Math.abs(c-f-d);h=Math.abs(e-d)<c?b+1:b;break}}if(!g)h=a.length;return h},moveCursorDown:function(e){this.abortCursorAnimation();this._currentCursorOpacity=1;var a=this.getDownCursorOffset(e,this._selectionDirection==="right");e.shiftKey?this.moveCursorDownWithShift(a):this.moveCursorDownWithoutShift(a);
this.initDelayedCursor()},moveCursorDownWithoutShift:function(e){this._selectionDirection="right";this.selectionStart+=e;if(this.selectionStart>this.text.length)this.selectionStart=this.text.length;this.selectionEnd=this.selectionStart},swapSelectionPoints:function(){var e=this.selectionEnd;this.selectionEnd=this.selectionStart;this.selectionStart=e},moveCursorDownWithShift:function(e){if(this.selectionEnd===this.selectionStart)this._selectionDirection="right";this[this._selectionDirection==="right"?
"selectionEnd":"selectionStart"]+=e;if(this.selectionEnd<this.selectionStart&&this._selectionDirection==="left")this.swapSelectionPoints(),this._selectionDirection="right";if(this.selectionEnd>this.text.length)this.selectionEnd=this.text.length},getUpCursorOffset:function(e,a){var d=a?this.selectionEnd:this.selectionStart,b=this.get2DCursorLocation(d);if(b.lineIndex===0||e.metaKey||e.keyCode===33)return d;for(var c=this.text.slice(0,d),d=c.slice(c.lastIndexOf("\n")+1),c=(c.match(/\n?(.*)\n.*$/)||
{})[1]||"",h=this.text.split(this._reNewline),g,i=this._getLineLeftOffset(this._getWidthOfLine(this.ctx,b.lineIndex,h)),f=b.lineIndex,m=0,n=d.length;m<n;m++)g=d[m],i+=this._getWidthOfChar(this.ctx,g,f,m);b=this._getIndexOnPrevLine(b,c,i,h);return c.length-b+d.length},_getIndexOnPrevLine:function(e,a,d,b){for(var e=e.lineIndex-1,c=this._getLineLeftOffset(this._getWidthOfLine(this.ctx,e,b)),h=0,g,b=0,i=a.length;b<i;b++){var f=this._getWidthOfChar(this.ctx,a[b],e,b);c+=f;if(c>d){g=!0;e=c;c=Math.abs(c-
f-d);h=Math.abs(e-d)<c?b:b-1;break}}g||(h=a.length-1);return h},moveCursorUp:function(e){this.abortCursorAnimation();this._currentCursorOpacity=1;var a=this.getUpCursorOffset(e,this._selectionDirection==="right");e.shiftKey?this.moveCursorUpWithShift(a):this.moveCursorUpWithoutShift(a);this.initDelayedCursor()},moveCursorUpWithShift:function(e){if(this.selectionEnd===this.selectionStart)this._selectionDirection="left";this[this._selectionDirection==="right"?"selectionEnd":"selectionStart"]-=e;if(this.selectionEnd<
this.selectionStart&&this._selectionDirection==="right")this.swapSelectionPoints(),this._selectionDirection="left";if(this.selectionStart<0)this.selectionStart=0},moveCursorUpWithoutShift:function(e){this.selectionStart===this.selectionEnd&&(this.selectionStart-=e);if(this.selectionStart<0)this.selectionStart=0;this.selectionEnd=this.selectionStart;this._selectionDirection="left"},moveCursorLeft:function(e){if(!(this.selectionStart===0&&this.selectionEnd===0))this.abortCursorAnimation(),this._currentCursorOpacity=
1,e.shiftKey?this.moveCursorLeftWithShift(e):this.moveCursorLeftWithoutShift(e),this.initDelayedCursor()},_move:function(e,a,d){e.altKey?this[a]=this["findWordBoundary"+d](this[a]):e.metaKey||e.keyCode===35||e.keyCode===36?this[a]=this["findLineBoundary"+d](this[a]):this[a]+=d==="Left"?-1:1},_moveLeft:function(e,a){this._move(e,a,"Left")},_moveRight:function(e,a){this._move(e,a,"Right")},moveCursorLeftWithoutShift:function(e){this._selectionDirection="left";this.selectionEnd===this.selectionStart&&
this._moveLeft(e,"selectionStart");this.selectionEnd=this.selectionStart},moveCursorLeftWithShift:function(e){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)this._moveLeft(e,"selectionEnd");else if(this._selectionDirection="left",this._moveLeft(e,"selectionStart"),this.text.charAt(this.selectionStart)==="\n"&&this.selectionStart--,this.selectionStart<0)this.selectionStart=0},moveCursorRight:function(e){if(!(this.selectionStart>=this.text.length&&this.selectionEnd>=
this.text.length))this.abortCursorAnimation(),this._currentCursorOpacity=1,e.shiftKey?this.moveCursorRightWithShift(e):this.moveCursorRightWithoutShift(e),this.initDelayedCursor()},moveCursorRightWithShift:function(e){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)this._moveRight(e,"selectionStart");else if(this._selectionDirection="right",this._moveRight(e,"selectionEnd"),this.text.charAt(this.selectionEnd-1)==="\n"&&this.selectionEnd++,this.selectionEnd>this.text.length)this.selectionEnd=
this.text.length},moveCursorRightWithoutShift:function(e){this._selectionDirection="right";if(this.selectionStart===this.selectionEnd)this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart;else{this.selectionEnd+=this.getNumNewLinesInSelectedText();if(this.selectionEnd>this.text.length)this.selectionEnd=this.text.length;this.selectionStart=this.selectionEnd}},removeChars:function(e){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(e):this._removeCharsFromTo(this.selectionStart,
this.selectionEnd);this.selectionEnd=this.selectionStart;this._removeExtraneousStyles();this.canvas&&this.canvas.renderAll().renderAll();this.setCoords();this.fire("changed");this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(e){if(this.selectionStart!==0)e.metaKey?(e=this.findLineBoundaryLeft(this.selectionStart),this._removeCharsFromTo(e,this.selectionStart),this.selectionStart=e):e.altKey?(e=this.findWordBoundaryLeft(this.selectionStart),this._removeCharsFromTo(e,
this.selectionStart),this.selectionStart=e):(this.removeStyleObject(this.text.slice(this.selectionStart-1,this.selectionStart)==="\n"),this.selectionStart--,this.text=this.text.slice(0,this.selectionStart)+this.text.slice(this.selectionStart+1))}});f.util.object.extend(f.IText.prototype,{_setSVGTextLineText:function(e,a,d,b,c,h){this.styles[a]?this._setSVGTextLineChars(e,a,d,b,c,h):this.callSuper("_setSVGTextLineText",e,a,d,b,c)},_setSVGTextLineChars:function(e,a,d,b,c,h){for(var b=a===0||this.useNative?
"y":"dy",e=e.split(""),c=0,g=this._getSVGLineLeftOffset(a),i=this._getSVGLineTopOffset(a),f=this._getHeightOfLine(this.ctx,a),m=0,n=e.length;m<n;m++){var o=this.styles[a][m]||{};d.push(this._createTextCharSpan(e[m],o,g,i,b,c));var p=this._getWidthOfChar(this.ctx,e[m],a,m);o.textBackgroundColor&&h.push(this._createTextCharBg(o,g,i,f,p,c));c+=p}},_getSVGLineLeftOffset:function(e){return this._boundaries&&this._boundaries[e]?f.util.toFixed(this._boundaries[e].left,2):0},_getSVGLineTopOffset:function(e){for(var a=
0,d=0;d<=e;d++)a+=this._getHeightOfLine(this.ctx,d);return a-this.height/2},_createTextCharBg:function(e,a,d,b,c,h){return['<rect fill="',e.textBackgroundColor,'" transform="translate(',-this.width/2," ",-this.height+b,')" x="',a+h,'" y="',d+b,'" width="',c,'" height="',b,'"></rect>'].join("")},_createTextCharSpan:function(e,a,d,b,c,h){var g=this.getSvgStyles.call(f.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},a));return['<tspan x="',d+h,'" ',c,'="',b,'" ',a.fontFamily?
'font-family="'+a.fontFamily.replace(/"/g,"'")+'" ':"",a.fontSize?'font-size="'+a.fontSize+'" ':"",a.fontStyle?'font-style="'+a.fontStyle+'" ':"",a.fontWeight?'font-weight="'+a.fontWeight+'" ':"",a.textDecoration?'text-decoration="'+a.textDecoration+'" ':"",'style="',g,'">',f.util.string.escapeXml(e),"</tspan>"].join("")}});(function(){function e(a,d,g){var e=b.parse(a);if(!e.port)e.port=e.protocol.indexOf("https:")===0?443:80;a=(e.port===443?h:c).request({hostname:e.hostname,port:e.port,path:e.path,
method:"GET"},function(a){var c="";d&&a.setEncoding(d);a.on("end",function(){g(c)});a.on("data",function(b){a.statusCode===200&&(c+=b)})});a.on("error",function(a){a.errno===process.ECONNREFUSED?f.log("ECONNREFUSED: connection refused to "+e.hostname+":"+e.port):f.log(a.message)});a.end()}function a(a,c){require("fs").readFile(a,function(a,b){if(a)throw f.log(a),a;else c(b)})}if(!(typeof document!=="undefined"&&typeof F!=="undefined")){var d=require("xmldom").DOMParser,b=require("url"),c=require("http"),
h=require("https"),g=require("canvas"),i=require("canvas").Image;f.util.loadImage=function(c,b,d){function g(a){h.src=new Buffer(a,"binary");h._src=c;b&&b.call(d,h)}var h=new i;c&&(c instanceof Buffer||c.indexOf("data")===0)?(h.src=h._src=c,b&&b.call(d,h)):c&&c.indexOf("http")!==0?a(c,g):c?e(c,"binary",g):b&&b.call(d,c)};f.loadSVGFromURL=function(c,b,d){c=c.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim();c.indexOf("http")!==0?a(c,function(a){f.loadSVGFromString(a.toString(),b,d)}):e(c,"",function(a){f.loadSVGFromString(a,
b,d)})};f.loadSVGFromString=function(a,c,b){a=(new d).parseFromString(a);f.parseSVGDocument(a.documentElement,function(a,b){c&&c(a,b)},b)};f.util.getScript=function(a,c){e(a,"",function(a){eval(a);c&&c()})};f.Image.fromObject=function(a,c){f.util.loadImage(a.src,function(b){var d=new f.Image(b);d._initConfig(a);d._initFilters(a,function(a){d.filters=a||[];c&&c(d)})})};f.createCanvasForNode=function(a,c,b,d){var d=d||b,h=f.document.createElement("canvas"),a=new g(a||600,c||600,d);h.style={};h.width=
a.width;h.height=a.height;b=new (f.Canvas||f.StaticCanvas)(h,b);b.contextContainer=a.getContext("2d");b.nodeCanvas=a;b.Font=g.Font;return b};f.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()};f.StaticCanvas.prototype.createJPEGStream=function(a){return this.nodeCanvas.createJPEGStream(a)};var k=f.StaticCanvas.prototype.setWidth;f.StaticCanvas.prototype.setWidth=function(a,c){k.call(this,a,c);this.nodeCanvas.width=a;return this};if(f.Canvas)f.Canvas.prototype.setWidth=
f.StaticCanvas.prototype.setWidth;var m=f.StaticCanvas.prototype.setHeight;f.StaticCanvas.prototype.setHeight=function(a,c){m.call(this,a,c);this.nodeCanvas.height=a;return this};if(f.Canvas)f.Canvas.prototype.setHeight=f.StaticCanvas.prototype.setHeight}})();F.fabric=f;j=j||{};j.fabric=f;typeof define==="function"&&define.amd&&define([],function(){return f});return f})})})(function(){var D=window.AmazonUIPageJS||window.P,F=D._namespace||D.attributeErrors;return F?F("AmazonCustomFabricJS"):D}(),window);
(function(D,F,E){D.execute(function(){(function(){D.when("A","ready").register("ProductCustomizationBase",function(){return function(){}});D.when("A","ready").execute(function(l){function j(a){var b="/gp/product/features/log-message.html/ref="+a.refTag,c;e++;c="ajax_amzon_custom_log"+e;if(F.ue){var h=F.uet;h("tc",c)}f.ajax({type:"POST",url:b,dataType:"json",data:{component:a.component,message:a.msg,isMetricsNeeded:a.isMetricsNeeded},success:function(a){if(F.ue){var b=F.ues,d=F.uet,h=F.uex;b("id",
c,a.result.rid);b("t0",c,new Date);b("ctb",c,"1");d("cf",c);d("be",c);h("ld",c)}}})}var f=l.$,e=0,a=function(){var a=f("#ASIN",f(".pc-buy-box")).val();return{CustomizeNowClick:{refTag:"amz_custom_cn_clk_"+a,component:"Amazon Custom customize now button",msg:"Amazon Custom customize now button clicked",isMetricsNeeded:!1},AddToCartClick:{refTag:"amz_custom_atc_clk_"+a,component:"Amazon Custom Add to cart",msg:"Amazon Custom add to cart clicked",isMetricsNeeded:!1},CloseClick:{refTag:"amz_custom_cls_clk_"+
a,component:"Amazon Custom Add to cart",msg:"Amazon Custom close button clicked",isMetricsNeeded:!1},FontChange:{refTag:"amz_custom_font_chg_"+a,component:"Font drop down list",msg:"Font selected from drop down list",isMetricsNeeded:!1},FontColorChange:{refTag:"amz_custom_color_chg_"+a,component:"Font drop down list",msg:"Font selected from drop down list",isMetricsNeeded:!1},CustomizeNextSurfaceClick:{refTag:"amz_custom_customize_next_surface_clk_"+a,component:"Amazon Custom Next Surface Button",
msg:"Customize next surface button clicked",isMetricNeeded:!1},CloseWarningClick:{refTag:"amz_custom_close_atc_warning_"+a,component:"Amazon Custom atc warning",msg:"Warning shown when uncustomized surfaces are there and add to cart is clicked",isMetricNeeded:!1},PreviewSurfaceClick:{refTag:"amz_custom_preview_surface_clk_"+a,component:"Amazon Custom Preview Surface button",msg:"Preview surface button clicked",isMetricNeeded:!1}}}();l.on("amazon-custom-popup-open",function(){this.popupOpenTime=new Date});
l.on("amazon-custom-popup-close",function(a){a-=this.popupOpenTime;a/=1E3;F.ue.count("pcSingleTextTimer",a);F.ue.count("pcSingleTextTimer")});l.on("amazon-custom-log-ref-tag",function(d){d!==E&&(d=a[d],d!==E&&j(d))})})})();(function(){D.when("A","ProductCustomizationBase","ready").register("pc-input-validator",function(){var l={AlphaNumeric:function(){return!0},Digits:function(j){return/^[\s\d]*$/.test(j)}};return{Validate:function(j,f){return l[f]!==E&&typeof l[f]==="function"?l[f](j):!0}}})})();
(function(){D.when("A","ProductCustomizationBase","ready").register("ProductPrice",function(l,j){return function(f){var e=function(){return this};e.prototype=new j;e.prototype.Init=function(){if(f("#is-buying-price-enabled").val()!=="1"){var a=f(".pc-buy-box");l.post("/gp/product/features/pc-price.html",{dataType:"json",params:{itemAsin:a.find("#ASIN").val(),merchantId:a.find("#merchantID").val()},success:function(d){a.find(".a-color-price").html(d.result.price);a.find(".a-color-price,.a-color-base").addClass("active")},
error:function(){a.find(".a-color-price,.a-color-base").removeClass("active")}})}};return e}(l.$)})})();(function(){D.when("A","ProductCustomizationBase","pc-input-validator","ready").register("SimpleText",function(l,j,f){return function(e){var a=function(a){this.config={};this.config.$el=a;return this};a.prototype=new j;a.prototype.getDOM=function(){var a=this;return{$inputTextElement:function(){return a.config.$el.find(e(".pc-simple-text-input"))},$textLimitElement:function(){return a.config.$el.find(e(".pc-char-limit-length"))}}};
a.prototype.BindEvents=function(){function a(c){l.trigger("simple-text-preview-change",{text:c,state:h.$inputTextElement().data("area-name"),aspectName:h.$inputTextElement().data("aspect-name"),aspectTitle:h.$inputTextElement().data("aspect-title")})}function b(){var b=h.$inputTextElement().val()||h.$inputTextElement().find("[type=text]").val(),e=b.length;h.$inputTextElement().attr("maxlength")||h.$inputTextElement().find("[type=text]").attr("maxlength");h.$textLimitElement().length>0&&h.$textLimitElement().html(parseInt(c.config.maxLength,
10)-parseInt(e,10));c.isValid()?a(b):a("")}var c=this,h=c.getDOM();h.$inputTextElement().bind("keyup",function(){b.call(c)});h.$inputTextElement().bind("cut",function(){setTimeout(function(){b.call(c)},100)});h.$inputTextElement().bind("paste",function(){setTimeout(function(){b.call(c)},100)});h.$inputTextElement().bind("change",function(){b.call(c)})};a.prototype.getComponentName=function(){return"SimpleText"};a.prototype.Init=function(){this.BindEvents();var a=this.getDOM();this.config.maxLength=
a.$inputTextElement().attr("maxlength")||a.$inputTextElement().find("[type=text]").attr("maxlength");this.config.aspectName=a.$inputTextElement().data("aspect-name");this.config.aspectTitle=a.$inputTextElement().data("aspect-title");this.config.areaName=a.$inputTextElement().data("area-name");this.config.charset=a.$inputTextElement().data("input-type")};a.prototype.addContent=function(a){var b=this.getDOM();b.$inputTextElement().attr("type")==="text"?b.$inputTextElement().val(a).change():b.$inputTextElement().find("[type=text]").val(a).change()};
a.prototype.getContent=function(){var a=this.getDOM();return a.$inputTextElement().attr("type")==="text"?a.$inputTextElement().val():a.$inputTextElement().find("[type=text]").val()};a.prototype.getAspectName=function(){return this.config.aspectName};a.prototype.getAspectTitle=function(){return this.config.aspectTitle};a.prototype.getAreaName=function(){return this.config.areaName};a.prototype.isEmpty=function(){return this.getContent().length===0};a.prototype.isValid=function(){var a=this.getContent();
return f.Validate(a,this.config.charset)&&!this.isEmpty()};a.prototype.resetContent=function(){var a=this.getDOM();a.$inputTextElement().attr("type")==="text"?a.$inputTextElement().val(""):a.$inputTextElement().find("[type=text]").val("")};a.prototype.getJSON=function(){var a={};a.value=this.getContent();return a};return a}(l.$)})})();(function(){D.when("A","a-dropdown","ProductCustomizationBase","ready").register("FontPicker",function(l,j,f){return function(e){var a={$el:E,showLabel:!0},d,b={},c=
{value:E,fontName:E,fontUrl:E,isDefault:!1},h=function(c){b=e.extend({},a,c);return this};h.prototype=new f;h.prototype.getComponentName=function(){return"FontPicker"};h.prototype.Init=function(){var a=e(".pc-simple-text-font-picker",b.$el),h=parseInt(b.$el.attr("data-surface-num"),10);if(e("#is-aui-dropdown-available").length===0)e("select",a).change(function(){var a=e("#pc-simple-text-font-dropdown-surface"+h+" :selected");if(a.length===1&&a.data("a-html-content"))a=e(a.data("a-html-content")),
c.isDefault=a.attr("data-is-default"),c.fontUrl=a.attr("data-font-url"),c.fontName=a.text();a=e(this).val();c.value=a;l.trigger("simple-text-preview-font-change")}),e("select option:first-child",a).click().change();else{var f="pc-font-"+e("#ASIN",e(".pc-buy-box")).val();d=j.getSelect(f);l.on("a:dropdown:"+f+":select",function(a){c.value=a.value;l.trigger("simple-text-preview-font-change")});c.value=d.val()}e("#pc-simple-text-font-dropdown-surface"+h+" > option").length<2?a.hide():a.show()};h.prototype.getJSON=
function(){return c};return h}(l.$)})})();(function(){D.when("A","ProductCustomizationBase","a-popover","ready").register("ColorPickerPopover",function(l,j,f){return function(e){var a={$el:E,showLabel:!0},d={},b={value:E},c=function(c){d=e.extend({},a,c);return this};c.prototype=new j;var h={Bind:function(){var a=d.$el,c=e(".pc-simplecolorpicker",a),h=parseInt(a.attr("data-surface-num"),10);e(".pc-color-li",a).bind("click",function(){var d=e(this),h=d.find("div").attr("data-color"),d=d.find("div").attr("data-name"),
k=f.get(e(".pc-color-picker-trigger",a).parent());c.css("background-color",h);b.value=h;b.name=d?d:"";l.trigger("simple-text-preview-color-change");k.hide()});b.value=c.data("color");b.name=c.data("name")?c.data("name"):"";e(".pc-color-surface"+h+" > .pc-color-li").length<2?e(".pc-simple-text-color-picker",a).hide():e(".pc-simple-text-color-picker",a).show()}};c.prototype.getComponentName=function(){return"ColorPickerPopover"};c.prototype.getJSON=function(){return b};c.prototype.Init=function(){h.Bind()};
return c}(l.$)})})();(function(){D.when("A","ProductCustomizationBase","SimpleText","ColorPickerPopover","FontPicker","ProductPrice","BuyBox","ac-surfaces-carousel","ready").register("SingleTextInput",function(l,j,f,e,a,d,b){return function(c){function h(a){return l.state(a)===E?o.states[a]:l.state(a)}function g(){for(var a=0;a<o.textInputControlObjects.length;a+=1){var c=o.textInputControlObjects[a];if(c.isValid()){var b=c.getDOM().$inputTextElement().data("area-name"),d=c.getDOM().$inputTextElement().data("aspect-title");
l.trigger("simple-text-preview-change",{text:c.getContent(),state:b,aspectName:b,aspectTitle:d})}}}function i(){var a=0,b=c(".pc-surface-nav-carousel-item"),d=c(".pc-surface-nav-carousel");if(d.length&&b.length){for(var g=0;g<b.length;g++){var h=c(b[g]);a+=h.width()+parseInt(h.css("margin-right").split("px")[0],10);(function(a){h.find("a").unbind().bind("click",function(c){c.preventDefault();l.trigger("change-surface",{surfaceNum:a+1})})})(g)}d.width(a);c(b[0]).addClass("active")}}function k(){c(".pc-single-text-input-container");
(new d).Init();i();o.textInputControls=[];o.textInputControlObjects=[];o.fontPickers=[];o.colorPickers=[];c(".pc-simple-text").each(function(a,b){var d=new f(c(b));d.Init();o.textInputControlObjects.push(d)});c(".pc-single-text-input-container").each(function(b,d){var g=new e({$el:c(d)});g.Init();o.colorPickers.push(g);g=new a({$el:c(d)});g.Init();o.fontPickers.push(g)});(new b({controller:o})).Init();q.Bind()}function m(a){for(var a=a.find('[type="text"]'),c=0;c<a.length;c++)if(a[c].value.length)return!0;
return!1}var n={$el:E},o,p=function(a){c.extend({},n,a);for(var a=o=this,b=document.getElementsByTagName("script"),d=[],g=0,h=b.length;g<h;g++)if(!c.data(b[g],"a-eval")){var e=c(b[g]),i=e.attr("data-a-state");i&&(i=l.parseJSON(i),i.key&&(e=l.parseJSON(e.html()),d[i.key]=e))}a.states=d;return o},q={Bind:function(){l.on("SingleTextValid",function(){for(var a=0;a<o.textInputControlObjects.length;a+=1)if(!o.textInputControlObjects[a].isValid()){l.trigger("SingleTextInvalid");break}l.trigger("enableBuybox")});
l.on("SingleTextInvalid",function(){l.trigger("disableBuybox")});o.fontSwitch=!0;l.on("simple-text-preview-font-change",function(){g();o.fontSwitch&&l.trigger("amazon-custom-log-ref-tag","FontChange");o.fontSwitch=!o.fontSwitch});l.on("simple-text-preview-color-change",function(){g();l.trigger("amazon-custom-log-ref-tag","FontColorChange")});l.on("resize-preview",function(){var a=c(".pc-simple-text").find("[type=text]");c(".pc-product-image");for(var b=0;b<a.length;b++)l.trigger("simple-text-preview-change",
{text:c(a[b]).val(),state:c(a[b]).parent().data("area-name"),aspectName:c(a[b]).parent().data("aspect-name"),aspectTitle:c(a[b]).parent().data("aspect-title")})});l.on("simple-text-preview-change",function(a){var b=c(".pc-product-image").get()[0],d=b.width,g=d/b.naturalWidth,e,i,f,b=a.text;e=h(a.state);var k,n,p;k=e.dimension.width*g;n=e.dimension.height*g;p=e.position.x*g;e=e.position.y*g;g=c(".pc-preview-container").find('[data-area-name="'+a.state+'"]');a=parseInt(g.parent().attr("data-surface-num"),
10);i=o.colorPickers[a].getJSON().value;f=o.fontPickers[a].getJSON().value;if(g.length===1){var q;c("#pc-text-width-span").length||(q=c("<span>"),q.css({position:"absolute",left:"-1000px",top:"-1000px","white-space":"nowrap",visibility:"hidden"}).appendTo(c("body")).attr("id","pc-text-width-span"));q=c("#pc-text-width-span");q.css({"font-size":Math.floor(n),"font-family":f}).text(b);for(var j;q.width()>=0.9*k||q.height()>=0.9*n;)if(j=q.css("font-size").split("px")[0],j>2)q.css("font-size",j-1+"px");
else break;q=q.css("font-size");g.css({"font-size":q,"font-family":f,width:Math.round(k),height:Math.round(n),position:"absolute",left:Math.round(p+(c(".pc-preview-container").width()-d)/2),top:Math.round(e),color:i});g.children().length===1&&c(g.children()[0]).prop("tagName")==="DIV"?c(g.children()[0]).text(b):(d=c("<div>"),d.appendTo(g),d.text(b))}d=c(".customization-options-block").find("[data-surface-num="+a+"]");b=c(".pc-surface-nav-carousel").find("[data-surface-num="+(a+1)+"]");m(d)?b.addClass("customized"):
b.removeClass("customized");a:{for(d=0;d<o.textInputControlObjects.length;d++)if(o.textInputControlObjects[d].getContent().length>0){d=!0;break a}d=!1}d?l.trigger("enableBuybox"):l.trigger("disableBuybox")})}};p.prototype=new j;p.prototype.Init=function(){k()};p.prototype.getComponentName=function(){return"SingleTextInput"};p.prototype.checkUncustomizedSurfaces=function(){var a=c(".pc-single-text-input-container"),b=[];if(a.length>0)for(var d=0;d<a.length;d++)m(c(a[d]))||b.push('<a href="#" data-surface-num="'+
(d+1)+'">Surface '+(d+1)+"</a>");return b};p.prototype.getJSON=function(){var a={},b=[],a=h("ctsStateInfo");c(".pc-single-text-input-container").each(function(a,d){var g={},e=h("ctsStateInfo"+a);g.name=e.surfaceName;g.areas=[];g.id="surface-"+a;g.images={previewUrl:c("#pc-surfaces-carousel").find("[data-surface-num="+a+"]").find("img").attr("src")||c(".pc-product-image").attr("src")};g.font={};g.font.isDefault=parseInt(o.fontPickers[a].getJSON().isDefault,10);g.font.fontName=o.fontPickers[a].getJSON().fontName;
if(!g.font.isDefault)g.font.fontUrl=o.fontPickers[a].getJSON().fontUrl;for(var e=c(d).find(".pc-simple-text"),i=0;i<e.length;i++){var f=c(e[i]);c(f.find(".pc-simple-text-input"));var k=a,m=i,n={},f=c(f.find(".pc-simple-text-input"));n.id=f.data("area-name");n.text=f.find('[type="text"]').val();n.name=f.data("aspect-name");n.label=f.data("aspect-title");n.fill=o.colorPickers[k].getJSON().value;n.colorName=o.colorPickers[k].getJSON().name;n.fontFamily=o.fontPickers[k].getJSON().fontName;n.customizationType=
"TextPrinting";n.fulfillmentType="JSON";n.Position=h("surface-"+k+"-area-"+m).position;n.Dimensions=h("surface-"+k+"-area-"+m).dimension;g.areas.push(n)}b.push(g)});return a={fulfillmentDetails:a.fulfillmentDetails,"version3.0":{surfaces:b}}};return p}(l.$)})})();D.when("A","ready").execute(function(l){var j=l.$;l.on("pc-single-text-loaded",function(){j("html").hasClass("a-canvas")||(j(".pc-customization-disabled").addClass("active"),j(".pc-customization-enabled").remove())})});D.when("A","a-modal",
"a-dropdown","SingleTextInput","ready").execute(function(l,j,f,e){var a=l.$;l.on("a:popover:afterHide:pc-popover-content",function(){l.trigger("amazon-custom-log-ref-tag","CloseClick");l.trigger("amazon-custom-popup-close",new Date)});a("html").hasClass("a-canvas")&&(a(".pc-customization-disabled").remove(),l.on.orientationchange(function(){setTimeout(function(){l.trigger("resize-preview")},250)}),l.on("a:popover:beforeShow:pc-buybox-secondary-view",function(){var d=a("#pc-customize-now-div").attr("data-customization-clicked");
if(a("#is-aui-dropdown-available").length===0)l.on("a:popover:beforeShow:pc-popover-content",function(c){c=c.popover;a(".a-button-dropdown",a(".pc-simple-text-font-picker",c.$popover)).remove();a("select",a(".pc-simple-text-font-picker",c.$popover)).css("display","block")});var b=a("#ASIN",a(".pc-buy-box",a(".pc-two-column-layout"))).val();a(".pc-two-column-layout").attr("asin",b);l.trigger("amazon-custom-log-ref-tag","CustomizeNowClick");l.trigger("amazon-custom-popup-open");d==="false"&&((new e).Init(),
a("#pc-customize-now-div").attr("data-customization-clicked","true"));a(".pc-simple-text-font-picker, .selectQuantity").unbind().bind("click",function(){setTimeout(function(){a("body").css("position")!=="static"&&a("body").css("position","static")},300)})}),l.on("a:popover:afterShow:pc-buybox-secondary-view",function(){l.trigger("resize-preview");a(".preview-customization").unbind().bind("click",function(){l.trigger("amazon-custom-log-ref-tag","PreviewSurfaceClick");a("html, body").animate({scrollTop:"0"},
500);return!1});a(".pc-buybox-warning-close").unbind().bind("click",function(){l.trigger("amazon-custom-log-ref-tag","CloseWarningClick");a(".pc-buybox-warning-close").attr("data-is-clicked","true");a(".pc-buybox-warning").hide();l.trigger("enableBuybox")});a(".pc-popover-footer-wrapper").delay(1E3).fadeIn(1E3)}),l.on("a:popover:afterHide:pc-buybox-secondary-view",function(){a(".pc-popover-footer-wrapper").fadeOut()}))});(function(){D.when("A","ac-surfaces-carousel","ready").register("BuyBox",function(l){return function(j){function f(){var a=
{},c={};if(b.controller!==E)a.merchantId=j("#merchantID",j(".pc-buy-box")).val(),a.customizationInfo=b.controller.getJSON();c.customizationData=JSON.stringify(a);if(j("#amazonCustomUseCaseId").length)c.clientId=j("#amazonCustomUseCaseId").val();j(".pc-error-container").hide();l.post("/gp/product/features/callSetCustomizationDatav2.html",{dataType:"json",params:c,contentType:"application/x-www-form-urlencoded;charset=utf-8",success:function(a){a.result&&a.result.Status==="OK"&&a.result.pcToken!==E?
(l.trigger("amazon-custom-log-ref-tag","AddToCartClick"),j("#UNIQ-pcToken",j(".pc-buy-box")).val(a.result.pcToken),j("#addToCart").submit()):j(".pc-error-container").show()},error:function(){j(".pc-error-container").show()}})}function e(a,c){c?(j(".pc-buybox-warning .uncustomized-surfaces").html(a.join(", ")),j(".pc-buybox-warning .uncustomized-surfaces a").unbind().bind("click",function(a){a.preventDefault();j("html, body").animate({scrollTop:"0"},500);l.trigger("change-surface",{surfaceNum:j(this).attr("data-surface-num")})}),
j(".pc-buybox-warning").show()):j(".pc-buybox-warning").hide()}function a(a){var c=j("#pc-atc"),b=j(".pc-atc-wrapper");a?(c.prop("disabled",!1),b.removeClass("a-button-disabled")):(c.prop("disabled",!0),b.addClass("a-button-disabled"))}var d={$el:E,showLabel:!0,controller:E},b={},c=function(a){b=j.extend({},d,a);return this};c.prototype.getComponentName=function(){return"BuyBox"};c.prototype.Init=function(){h.Bind()};var h={Bind:function(){l.declarative("upload-metadata","click",function(c){c.$event.preventDefault();
c=b.controller.checkUncustomizedSurfaces();j("#pc-atc").is(":disabled")||(c.length&&j(".pc-buybox-warning-close").attr("data-is-clicked")==="false"?(e(c,!0),a(!1)):(e(!1),l.trigger("amazon-custom-popup-close",new Date),f()))});l.on("enableBuybox",function(){a(!0)});l.on("disableBuybox",function(){a(!1)})}};return c}(l.$)})})();(function(){D.when("A","a-carousel-framework","ready").register("ac-surfaces-carousel",function(l,j){var f=l.$,e;j.onInit("pc-surfaces-carousel",function(a){e=a;e.gotoPage(1);
f(".pc-single-text-input-container").hide();f(".customization-options-block").find('[data-surface-num="0"]').show();f(".customize-next-btn").click(function(){l.trigger("amazon-custom-log-ref-tag","CustomizeNextSurfaceClick");f(".preview-customization").click();setTimeout(function(){e.gotoNextPage()},1E3)})});l.on("a:carousel:pc-surfaces-carousel:change:pageNumber",function(a){var d=a.oldValue,a=a.newValue;f(".customization-options-block").find('[data-surface-num="'+(d-1)+'"]').hide();f(".customization-options-block").find('[data-surface-num="'+
(a-1)+'"]').show();f(".pc-surface-nav-carousel").find('[data-surface-num="'+d+'"]').removeClass("active");f(".pc-surface-nav-carousel").find('[data-surface-num="'+a+'"]').addClass("active");l.trigger("update-surface-nav",{surfaceNum:a})});l.on("change-surface",function(a){e.gotoPage(a.surfaceNum)});l.on("update-surface-nav",function(a){var d=a.surfaceNum,b,c,h,g,a=f(".pc-surface-nav-carousel-viewport").get()[0];if((b=f(".pc-surface-nav-carousel").find('[data-surface-num="'+d+'"]').get()[0])&&a)d=
b.offsetLeft,b=b.offsetWidth,c=a.offsetWidth,h=a.scrollLeft,g=a.offsetLeft,d<h?a.scrollLeft=d-d:d>h&&d+b>h+c&&(a.scrollLeft+=g+(d+b-(h+c)))})})})()})})(function(){var D=window.AmazonUIPageJS||window.P,F=D._namespace||D.attributeErrors;return F?F("AmazonCustomMobileWebSingleTextAssets"):D}(),window);
/* ******** */
(function(d,f){d.execute(function(){var b={fallbackTimer:!1,heartbeatTimer:!1,openWebUrlTimer:!1,Metrics:{ABORT:0,CONTINUE:1},Method:{IFRAME:0,INTENTS:1,DIRECT:2,APPSTORE:3},Fallback:{NOTHING:0,APPSTORE:1,WEBURL:2},DeepLinkInstance:function(a){if(typeof a!=="object")throw"DeepLinkingUtils: Invalid constructor argument for DeepLinkInstance; options must be either a key value set of options or a DOM element containing a data-deeplink attribute.";if(a.target){if(typeof a.target==="string")a.target=document.querySelector(a.target);
if(!a.target||typeof a.target.nodeType==="undefined")throw"DeepLinkingUtils: Target node was not a valid DOM element or was not found";var d=this;a.target.addEventListener("click",function(){d.openApp()},!1)}for(var c="action,refTag,failAction,failRefTag,clientToken,campaignId,treatmentId,webUrl,appUrl,appStoreUrl".split(","),e=0;e<c.length;e++)if(!a[c[e]])throw"DeepLinkingUtils: Required option not included for DeepLinkingUtils: `"+c[e]+"`";var l=b.AJAX_TIMEOUT||800,c=function(a,b){return typeof a===
"undefined"?b:a},e=function(a,b){return typeof a==="string"?b[a]:a};a.method=c(e(a.method,b.Method),b.Method.IFRAME);a.metricsFailureMode=c(e(a.metricsFailureMode,b.Metrics),b.Metrics.CONTINUE);a.timeout=c(a.timeout,1E3);a.storePref=c(a.storePref,!1);a.recordMetricsUrl=c(a.recordMetricsUrl,"/gp/mobile-marketing/utility/metrics.html");a.updatePreferencesUrl=c(a.updatePreferencesUrl,"/gp/mobile-marketing/utility/update-preference.html");a.openWebUrlOnSuccess=c(a.openWebUrlOnSuccess,!1);a.fallbackMethod=
c(e(a.fallbackMethod,b.Fallback),b.Fallback.APPSTORE);a.autoRedirect=c(a.autoRedirect,!1);var g=function(b,d,c,e){b="storePref="+(c?1:0)+"&clientToken="+a.clientToken+"&campaignId="+a.campaignId+"&action="+b+"_"+a.treatmentId+"&ref_="+d+"&url="+encodeURIComponent(a.webUrl);i(a.recordMetricsUrl,b,e)},i=b.ajaxRequest||function(a,b,d){var c=f.XMLHttpRequest?new XMLHttpRequest:f.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):!1,d=d||function(){};if(c){c.open("POST",a);c.setRequestHeader("Content-Type",
"application/x-www-form-urlencoded");c.timeout=l;var e=!1;c.onreadystatechange=function(){c.readyState===4&&!e&&(e=!0,d(c.status===200))};c.ontimeout=function(){e||(e=!0,d(!1))};c.send(b)}else d()},j=function(){b.heartbeatTimer=setInterval(function(){(document.webkitHidden||document.hidden)&&clearTimeout(b.fallbackTimer)},200)},h=function(c,d){c&&d?g(c,d,!1,function(c){(c||a.metricsFailureMode===b.Metrics.CONTINUE)&&h()}):k(a.appStoreUrl)},n=function(){b.openWebUrlTimer&&(clearTimeout(b.openWebUrlTimer),
a.openWebUrlOnSuccess&&setTimeout(m,l*2));g(a.failAction,a.failRefTag,!1,function(c){if(c||a.metricsFailureMode===b.Metrics.CONTINUE){if(a.onFail)a.onFail();a.fallbackMethod===b.Fallback.APPSTORE?h():a.fallbackMethod===b.Fallback.WEBURL&&m()}})},k=b.openUrl||function(b,c){if(c){var d=document.getElementById("deeplinkFrame");d&&d.parentNode.removeChild(d);document.body.insertAdjacentHTML("beforeend",'<iframe style="display:none" height="0" width="0" id="deeplinkFrame" src="'+a.appUrl+'"></iframe>')}else document.location=
b},m=function(){k(a.webUrl)};this.openApp=function(){clearTimeout(b.fallbackTimer);clearInterval(b.heartbeatTimer);a.method===b.Method.APPSTORE?(g(a.action,a.refTag,!1),h()):g(a.action,a.refTag,a.storePref,function(c){if(a.method===b.Method.INTENTS)k(a.appUrl);else if(c||a.metricsFailureMode===b.Metrics.CONTINUE){var d=Date.now();k(a.appUrl,a.method!==b.Method.DIRECT);j();b.fallbackTimer=setTimeout(function(){clearTimeout(b.fallbackTimer);clearInterval(b.heartbeatTimer);!document.webkitHidden&&!document.hidden&&
Date.now()-d<a.timeout+500&&n()},a.timeout)}if(a.openWebUrlOnSuccess)b.openWebUrlTimer=setTimeout(m,a.timeout+500+l)})};this.openAppStore=h;this.updatePreferences=function(b){var b=a.updatePreferencesUrl+"/ref="+b+"?ie=UTF8campaignId="+a.campaignId+"&clientToken="+a.clientToken,c="url="+encodeURIComponent(a.webUrl)+"&treatmentId="+a.treatmentId;i(b,c)};a.autoRedirect&&setTimeout(this.openApp,1)}};d.register("deeplinking-utils",function(){return b})})})(function(){var d=window.AmazonUIPageJS||window.P,
f=d._namespace||d.attributeErrors;return f?f("DeepLinkingAssets"):d}(),window);
(function(d,f,b){d.execute(function(){function a(a){(a=a||document.getElementById("smart-app-banner"))&&(a.className+=" closed")}d&&document.querySelector("[data-aui-build-date]")?d.when("deeplinking-utils","A","ready").execute(function(d,c){var e=c.state("mm-redirect-options");e&&new d.DeepLinkInstance(e);try{var f=document.getElementById("smart-app-banner"),g=f?c.state(f.dataset.options):b;if(g){var i=new d.DeepLinkInstance(g),j=document.getElementById("smart-app-banner-close");j&&j.addEventListener("click",
function(b){b.preventDefault();b.stopPropagation();i&&i.updatePreferences(j.dataset.closeRefTag);a(f)},!1)}else if(f&&f.dataset.options)throw"SmartAppBanner: No options available for smart app banner";}catch(h){throw a(),h;}}):a()})})(function(){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors;return f?f("MobileMarketingSmartAppBannerAssets"):d}(),window);
/* ******** */
(function(c,a){c.execute(function(){c.when("A","ready").execute(function(b){var c=b.state("rentbox-mobile-page-state");if(c){var g=c.greenStates,h=c.defaultRentNowUrl,j=!1;if(c.onlyUnrestrictedOfferAvailable===!0)j=!0,h=c.unrestrictedOfferDetails.rentNowUrl;b.$("#rentButton").click(function(){j?a.location=h:(b.$("#chooseShippingStateBtn").addClass("a-button-error"),b.$("#chooseShippingStateBtn")[0].scrollIntoView())});b.declarative("state-select","click",function(a){a=a.data;j=!0;b.$("#chooseShippingStateBtn").removeClass("a-button-error");
var e=g.indexOf(a.stateCode)!==-1?c.restrictedOfferDetails:c.unrestrictedOfferDetails;b.$("#rentPrice").html(e.price);h=e.rentNowUrl;b.$("#rentButton").attr("href",h);b.$("#rentalDetailsInitialPrice").text(e.price);b.$("#rentalDetailsShortExtnPrice").text(e.shortExtensionPrice);b.$("#rentalDetailsLongExtnPrice").text(e.longExtensionPrice);b.$("#rentalDetailsFullPrice").text(e.fullPrice);b.$("#rentBoxMerchantUrlLink").text(e.merchantName);b.$("#rentBoxMerchantUrlLink").attr("href",e.merchantUrl);a=
a.stateName;b.$("#chooseShippingStateBtn .a-button-text").text("Shipping To: "+a);b.$("[data-action='a-popover-close']").click()})}})})})(function(){var c=window.AmazonUIPageJS||window.P,a=c._namespace||c.attributeErrors;return a?a("RentalsPlatformDPXModulesAUIAssets"):c}(),window);
/* ******** */
(function(e){e.execute(function(){})})(function(){var e=window.AmazonUIPageJS||P,d=e.attributeErrors;return d?d("BuyBackAssets"):e}());
/* ******** */
(function(a){a.execute(function(){a.when("A","ready").execute(function(a){var c=a.$;c("#sms").click(function(){a.ajax("/gp/aw/social/swf/metrics.html/ref=cm_sw_cl_sms_awdo",{method:"post",params:{id:"SMSClick",result:"success"}})})})})})(function(){var a=window.AmazonUIPageJS||P,b=a.attributeErrors;return b?b("DetailPageTellAFriendMobileWebAssets"):a}());
/* ******** */
(function(g,l,s){g.execute(function(){g.when("jQuery","A","load").execute(function(f){var d=l.ue,b=function(a){d&&d.count&&d.count(a,(d.count(a)||0)+1)},a=function(a){return typeof a==="undefined"||a===null||a===""},c=function(e,c){var b=e.attr("href");if(!a(b)){var d;b.indexOf("#")!==-1&&(d=b.split("#"),b=d[0],d=d[1]);b+=b.indexOf("?")===-1?"?":"&";b=b+"dpPl=1&dpID="+c;a(d)||(b=b+"#"+d);e.attr("href",b);e.attr("data-isDpImgCached",1)}},h=function(e){if(!a(e)){var b=/[^\/]+$/,c;a(e)||(e=e.match(b))&&
(c=e[0]);return c.split(".")[0]}},A;try{(function(){f(".dpLanImgCacheUrl").each(function(){var e=f(this),d=e.attr("data-isDpImgCached");if(a(d)){var d=e.attr("data-dpLanImgCachedUrl"),j=h(d);try{var k=new Image;k.src=d;f.isFunction(c)&&f(k).load(function(){c(e,j);b("dpCacheHit")})}catch(i){b("dpCacheEx")}}})})()}catch(g){b("dpPlEx")}});g.when("jQuery","softlines-common-utils","ready").execute(function(f,d){var b=f("#softlinesGNOAutoScrollUptoSubnav"),a=f("#softlinesGNOAutoScrollUptoSearch"),c=null;
d.isNotNull(b)&&b.length>0?c=f("#nav-subnav"):d.isNotNull(a)&&a.length>0&&(c=f("#nav-search"));if(c&&c.length!==0)b=c.offset().top,d.animationScroll(b,2E3)});g.when("jQuery","softlines-common-utils","atf").execute(function(f,d){var b=f("#softlinesMobileGNOAutoScrollUptoNavBar"),a=f("#softlinesMobileGNOAutoScrollUptoNavBarEnd"),c=f("#navbar");c.length===0&&(c=f(".nav-anywhere-wrapper"));var h=0;if(d.isNotNull(c)&&c.length!==0)h=c.offset().top;h>0&&(d.isNotNull(b)&&b.length>0?d.animationScroll(h,2E3):
d.isNotNull(a)&&a.length>0&&(h+=c.outerHeight(!0),d.animationScroll(h,2E3)))});g.when("jQuery","ueCount","ImageBlockATF","atf").execute(function(f,d,b){if(b.isEnhancedImageBlockSize&&b.isEnhancedImageBlockSize===!0){b=function(){var a=f(l).height(),b=f("#landingImage"),c,e=0;c=0;if(b){if(c=b.offset())e=c.top;(c=e+b.height())&&a&&c>a&&d.incrementCounterByOne("sl_main_img_btf")}};try{(function(){var a=f(l).width();a&&(a<=1366?d.incrementCounterByOne("sl_vp_dim_1"):a>=1367&&a<=1649?d.incrementCounterByOne("sl_vp_dim_2"):
a>=1650&&a<=1859?d.incrementCounterByOne("sl_vp_dim_3"):d.incrementCounterByOne("sl_vp_dim_4"))})()}catch(a){d.incrementCounterByOne("err_sl_vp_dim")}try{b()}catch(c){d.incrementCounterByOne("err_sl_main_img_btf")}}});g.when("A","jQuery","ueCount","ImageBlockATF","ImageBlockBTF").register("altImageAutoCycle",function(f,d,b,a,c){f.on("softlinesPreloadedCanvasItems",function(){var h=!1,A=d("#altImages .a-declarative"),g=!1,e=null,p=function(){var a=[];d.each(A,function(e,b){var f=d(b),i=f.attr("data-thumb-action");
(i=JSON.parse(i))&&i.type&&(c.autoplayVideo&&"chromeless-video"===i.type?g=!0:"image"===i.type&&a.push(f))});return a}(),j=function(){var a={NOT_STARTED:0,STARTED:1,STOPPED:2},e=a.NOT_STARTED;return{states:a,currentState:function(){return e},start:function(){if(e===a.NOT_STARTED)e=a.STARTED},stop:function(){if(e!==a.STOPPED)e=a.STOPPED}}}(),k=function(){var a=0,e=0;return{nextIndex:function(){a>=p.length-1?(a=0,e++,b.incrementCounterByOne("sl_auto_cycle_num_cycles")):a++},currentIndex:function(){return a},
numberOfCompletedCycles:function(){return e}}}(),i=function(){if(j.currentState()===j.states.NOT_STARTED){var b=a.altImageAutoCycleInterval,b=b?parseInt(b,10):3E3;e=setInterval(function(){var a=d.Event("mouseenter");a.startAutoCycleForAlts=!0;p[k.currentIndex()].trigger(a);k.nextIndex()},b);j.start();n()}},n=function(){f.declarative("thumb-action",["click","mouseenter"],function(a){if(a)(a=a.$event)&&!a.startAutoCycleForAlts&&o()})},o=function(){if(j.states.STARTED===j.currentState()){var a="sl_auto_cycle_transition_",
c=k.numberOfCompletedCycles();0===c?(c=k.currentIndex(),c=c===0?0:c-1,a+=c<6?c:6):0<c&&(c=p.length-1,a+=c<6?c:6);b.incrementCounterByOne(a);e&&clearInterval(e);j.stop()}},E=function(){1>=p.length&&(j.stop(),b.incrementCounterByOne("sl_auto_cycle_too_few_alts"));if(!1===g)i();else f.on("image-block-first-thumbnail-selected",function(){!0===g&&i()})},ca=function(){f.on("image-block-twister-swatch-hover",function(){o()});f.declarative("main-image-click",["click","touchstart","mouseenter"],function(){o()})};
try{0<A.length?(E(),ca()):h=!0}catch(ja){h=!0}h&&b.incrementCounterByOne("sl_auto_cycle_error")})});g.when("atf").register("ueCount",function(){var f=l.ue;return{incrementCounterByOne:function(d){f&&f.count&&f.count(d,(f.count(d)||0)+1)}}});g.when("jQuery").register("softlines-common-utils",function(f){var d=function(){};d.prototype.isNotNull=function(b){return f.type(b)!=="undefined"&&f.type(b)!=="null"};d.prototype.isString=function(b){return this.isNotNull(b)&&f.type(b)==="string"};d.prototype.isStringNotEmpty=
function(b){return this.isString(b)&&b.length>0};d.prototype.equalsIgnoreCase=function(b,a){var c=!1;this.isString(b)&&this.isString(a)&&b.toUpperCase()===a.toUpperCase()&&(c=!0);return c};d.prototype.getDeviceType=function(b){return this.getDataAttribute(b,"device-type")};d.prototype.getRegexOutput=function(b,a){var c,d=/^[A-Z0-9]*$/;if(this.isStringNotEmpty(b)){var f=b.match(a);f&&f.forEach(function(a){a&&d.test(a)&&(c=a)})}return c};d.prototype.getCurrentAsin=function(){return this.getRegexOutput(l.location.href,
/\/dp\/([^\/?]*)|\/gp\/product\/([^\/?]*)/)};d.prototype.getDataAttribute=function(b,a){var c=null;if(this.isStringNotEmpty(b)){var d=f(b);this.isNotNull(d)&&d.length>0&&(c=d.data(a))}return c};d.prototype.isMobileWeb=function(b){return this.equalsIgnoreCase(this.getDeviceType(b),"mobileWeb")?!0:!1};d.prototype.isMobileApp=function(b){return this.equalsIgnoreCase(this.getDeviceType(b),"mobileApp")?!0:!1};d.prototype.isPCOrTabletWeb=function(b){return this.equalsIgnoreCase(this.getDeviceType(b),"pcOrTabletWeb")?
!0:!1};d.prototype.isTabletApp=function(b){return this.equalsIgnoreCase(this.getDeviceType(b),"tabletApp")?!0:!1};d.prototype.checkWeblabTreatment=function(b,a,c){return this.getDataAttribute(b,a)===c};d.prototype.animationScroll=function(b,a){f(l).scrollTop()===0&&b!==0&&f("html, body").delay(500).animate({scrollTop:b},a)};d.prototype.isMacOs=function(){var b=!1,a=l.navigator.userAgent;a&&(b=/Mac OS/i.test(a));return b};return new d});g.when("jQuery","ueCount").execute(function(f,d){f("#softlinesTechnicalSpecificationsLink").bind("click",
function(){d.incrementCounterByOne("sts_link",1)})});g.when("jQuery","A").execute(function(f,d){d.on("a:popover:ajaxContentLoaded:g2s2SizeChartView",function(){function b(a){return p+f.param({asin:k,sizeChartDept:a,deviceType:i})}function a(){var a=f("#sizechart_department_dropdown_native_select").children(":selected").attr("data-deptName"),a=b(a);c(a)}function c(a){f.ajax({url:a,cache:!0,beforeSend:function(){if(e.data(a)!==s){var b=e.data(a);e.html(b);return!1}e.addClass(j);return!0},complete:function(){e.removeClass(j)},
success:function(b){e.data(a,b);e.html(b)}})}function d(a){c(a.data.rwAjaxSizeChartUrl)}var g=f("#spinnerContainer"),m=f("#sizeChartSpinnerUrl").attr("data-sizechart-spinner-url");g.css("background-image","url("+m+")");g=g.attr("data-showTab");m=f("#sizeChartHeight").attr("data-height");f(".heightG2S2SizeChartPC").css("height",m+"px");if(g==="true"){var e=f("#tabContent"),p="/gp/product/ajax-handlers/apparel-sizing-chart.html/ref=dp_sizechart?ie=UTF8&isUDP=1&",j="loadingSpinnerSizeChart",k=e.attr("data-asin"),
i=e.attr("data-deviceType"),g=f("#dataForJs").attr("data-numberOfDepts");if(f("#dataForJs").attr("data-show-department-dropdown")==="false")for(m=0;m<g;m++){var n=f("#dept"+m).attr("data-deptName"),o=f("#dept"+m).attr("data-isActive"),n=b(n);o==="true"&&e.data(n,e.html());f("#dept"+m).click({rwAjaxSizeChartUrl:n},d)}else f("#sizechart_department_dropdown_native_select").change(a),n=f("#sizechart_department_dropdown_native_select").children(":selected").attr("data-deptName"),n=b(n),e.data(n,e.html())}})});
g.when("A","imageBlockUtils","ImageBlockATF","ImageBlockBTF","a-modal","warrantyForesterLogging","ready").execute(function(f,d,b,a,c,h){function A(a,e){c.get(i(a)).hide();i("html,body").animate({scrollTop:i("#watchRecommendations").offset().top},"slow");h.foresterLog(e)}function m(a){i(document).delegate("#similarWatchRecommendationsLink","click.interstitial",function(){A(a,"simWatchRecOptClickedWR")});i(document).delegate("#otherWatchOfferLink","click.interstitial",function(){A(a,"otherWatchOfferOptClickedWR")})}
function e(a){i(document).undelegate(".interstitial");a.click()}function p(){var a=i("#add-to-cart-button");i(document).delegate("#warrantyModalBtnAtc",E,function(){h.foresterLog("clickedContinue"+h.warrantyType+h.watchRecommendationsForesterSuffix);i("#watchWarrantyDoNotShowMessageAtc").is(":checked")?i.ajax(o,{complete:function(){e(a)},timeout:500}):e(a)});i(document).delegate("#warrantyModalCancelBtnAtc",E,function(){i("#watchWarrantyDoNotShowMessageAtc").is(":checked")&&(f.ajax(o,{}),i(document).undelegate(".interstitial"));
h.foresterLog("clickedCancel"+h.warrantyType+h.watchRecommendationsForesterSuffix)})}function j(a){i(document).delegate("#warrantyModalBtnPtc",E,function(){h.foresterLog("clickedContinue"+h.warrantyType+h.watchRecommendationsForesterSuffix);i("#watchWarrantyDoNotShowMessagePtc").is(":checked")?i.ajax(o,{complete:function(){e(a)},timeout:500}):e(a)});i(document).delegate("#warrantyModalCancelBtnPtc",E,function(){i("#watchWarrantyDoNotShowMessagePtc").is(":checked")&&(f.ajax(o,{}),i(document).undelegate(".interstitial"));
h.foresterLog("clickedCancel"+h.warrantyType+h.watchRecommendationsForesterSuffix)})}function k(){var e="";if(l.isTwisterPage){if(ca)e=d.getColorFromState(ca.selected_variations),e=a.colorImages[e][0].large}else e=b.colorImages.initial[0].large;i("[id = interstitialImage]").attr("src",e)}var i=f.$,n=f.state("watch-warranty-params");if(n&&n.showInterstitial){i(document).undelegate(".interstitial");var o="/gp/product/ajax-handlers/watch-warranty-sembu-setter.html?timeStamp="+(new Date).getTime()+"&WRSuffix="+
h.watchRecommendationsForesterSuffix,E=navigator.userAgent.match(/ipad/i)?"touchstart.interstitial":"click.interstitial",ca;l.isTwisterPage&&g.when("twisterModule").execute(function(a){ca=a.getState()});i(document).delegate("#add-to-cart-button","click.interstitial",function(){try{return k(),h.foresterLog("modelShown"+h.warrantyType+h.watchRecommendationsForesterSuffix),c.get(i("#watchWarrantyModalAtc")).show(),p(),m("#watchWarrantyModalAtc"),!1}catch(a){return!0}});i(document).delegate("#one-click-button",
"click.interstitial",function(){try{k();h.foresterLog("modelShown"+h.warrantyType+h.watchRecommendationsForesterSuffix);c.get(i("#watchWarrantyModalPtc")).show();var a=i("#one-click-button");j(a);m("#watchWarrantyModalPtc");return!1}catch(e){return!0}});i(document).delegate("#oneClickBuyButton","click.interstitial",function(){try{k();h.foresterLog("modelShown"+h.warrantyType+h.watchRecommendationsForesterSuffix);c.get(i("#watchWarrantyModalPtc")).show();var a=i("#oneClickBuyButton");j(a);m("#watchWarrantyModalPtc");
return!1}catch(e){return!0}});i("#warrantyPdfInModal").click(function(){h.foresterLog("clicked"+h.watchRecommendationsForesterSuffix)});i("#warrantyFaqLink").click(function(){h.foresterLog("faqClicked"+h.warrantyType+h.watchRecommendationsForesterSuffix)})}});g.when("A","ueCount","cf").register("warrantyForesterLogging",function(f,d){var b=f.$;if((b=b("#warranty-div"))&&b.length){var a=b.attr("data-watchRecommendationsForesterSuffix");return{foresterLog:function(a){d&&d.incrementCounterByOne(a)},
warrantyType:b.find("#watchWarrantyText").attr("data-warrantyType"),watchRecommendationsForesterSuffix:a}}});g.when("A","warrantyForesterLogging").execute(function(f,d){var b=f.$,a=b("#warranty-div");a&&a.length&&(b=a.find("#watch-warranty-filelink"),a=a.find("#aboutWatchWarrantyLink"),b.length&&d.foresterLog("shown"),a.click(function(){d.foresterLog("aboutWatchWarrantyClickedWR")}),b.click(function(){d.foresterLog("clickedFromDP")}))});g.when("jQuery","A","cf").execute(function(f,d){var b,a,c,h,
g,m,e;function p(){var e=d.viewport().height,f=e-b;n&&(e/=2,f=e-e*a/100);return Math.min(Math.max(f,c),h)}function j(){var a=k.attr("data-header"),b="data-"+i,c=k.attr("href"),h=p(),c={name:"g2s2SizeChartView",url:c+"&height="+h};n?(a=d.viewport().width*g/100,a=Math.min(Math.max(a,m),e).toString(),f.extend(c,{width:a,position:"triggerBottom"})):f.extend(c,{width:"800",header:a});a=JSON.stringify(c);o.attr(b,a)}var k=f("#size-chart-url"),i=k.attr("data-sizeChartActionType"),n=i==="a-popover";g=70;
m=300;e=800;c=300;h=700;a=5;b=300;var o=f("#size-chart-popover");d.on("resize",function(){var a=f("#fit-guide"),e=p();if(a.length===0){if(o.length>0){var a=o.data(i),b="",c=a.url.split("?"),h=c[0],c=c[1],n="";if(c)for(var c=c.split("&"),k=c.length,g=0;g<k;g++)c[g].split("=")[0]!=="height"&&(b+=n+c[g],n="&");a.url=h+"?"+b+(n+"height="+e);o.data(i,a)}}else d.capabilities.ios||a.height(e)});o.length>0&&j()});g.when("A","jQuery","mobile-udp-twister-view-controller","twister-swatch-click-state").execute(function(f,
d,b,a){f.on("image-block-refresh",function(){if(b.hasTwisterTilesOnMobile()&&a.getDimensionState()){var c=d("div#twister_feature_div");if(c&&c.length>0){b.logScrollUpToVisualDimension&&b.logScrollUpToVisualDimension();var f=c.offset().top,c=c.height(),g=d(l).height(),f=f+c-g;d("html,body").delay(500).animate({scrollTop:f},1E3)}}})});g.when("A","airy-image-block").execute(function(f){function d(a){var b=a/e,d=(e-a)/2;c(A).each(function(){var a=c(this),e="translate3d(0, "+d+"px, 0)";a&&a.css("height")&&
(a.height()>=p&&(e=e+" scale("+b+")"),a.css("transform",e),a.css("-webkit-transform",e))});k.css("-webkit-transform","translate3d(0,"+2*d+"px, 0)");k.css("transform","translate3d(0,"+2*d+"px, 0)");i&&i.length>0&&(i.css("transform","translate3d(0,"+2*d+"px, 0)"),i.css("-webkit-transform","translate3d(0,"+2*d+"px, 0)"));n&&n.length>0&&(n.css("transform","scale("+b+") translate3d(0,"+2*d+"px, 0)"),n.css("-webkit-transform","scale("+b+") translate3d(0,"+2*d+"px, 0)"));o&&o.length>0&&(o.css("transform",
"scale("+b+") translate3d(0,"+2*d+"px, 0)"),o.css("-webkit-transform","scale("+b+") translate3d(0,"+2*d+"px, 0)"))}function b(){k=c("#titleExpander");i=c("#video-play-wrapper");n=c("#right-arrow-wrapper");o=c("#left-arrow-wrapper");k.length>0&&(h=c("#image-block"),h.length>0&&(k.offset(),k.css("position","relative"),k.css("z-index","5"),(m=h.length?!1:!0)&&(h=c("#single-image-block")),A=h.find("img"),e=h.height()))}function a(){l.requestAnimFrame=function(){return l.requestAnimationFrame||l.webkitRequestAnimationFrame||
l.mozRequestAnimationFrame||function(a){l.setTimeout(a,1E3/60)}}();var a=function(){if(h){var b=h[0].getBoundingClientRect().top-j,b=Math.min(Math.max(h.height()+b,p),e)+1;d(b)}l.requestAnimFrame(a)};l.requestAnimFrame(a);g.when("a-carousel-framework").execute(function(){f.on("a:carousel:image-block-carousel:init",function(){b()})});f.on("image-block-refresh",function(){b()})}var c=f.$,h,A=[],m,e,p=150,j=60,k,i,n,o;c("#twister_end_marker").length>0&&a()});g.when("A","ueCount","atf").register("searchStripeAjaxRequest",
function(f,d){function b(e,b){f.ajax(g,{method:a,dataType:c,params:e,success:function(a){b(a)},error:function(){if(!m){var a=h(".search-stripe-item-loader");a.length!==0&&(a.remove(),m=!0)}console.log("Failed to send the AJAX Request for search stripe");d&&d.incrementCounterByOne("SearchStripeAjaxRequestFailure")}})}var a="get",c="JSON",h=f.$,g="/gp/product/ajax-handlers/search-stripe.html?ie=UTF8&",m=!1;return{sendAjaxGet:function(a,c){b(a,c)}}});g.when("A","ueCount","softlines-common-utils","atf").register("searchStripeContainer",
function(f,d,b){var a=f.$,f=function(){function c(){d&&(d.incrementCounterByOne("ss_user_enter"),k.unbind("mouseenter",c))}function f(){d&&(Y||d.incrementCounterByOne("ss_leave_wout_scroll"),k.unbind("mouseleave",f))}function g(){var e=a(".search-stripe-item-loader");e.length!==0&&e.remove();S()}function m(a){var e="";a>=0&&a<u.length&&(e=u[a]);return e}function e(a){if((a=a.find("li.search-stripe-item"))&&a.length>0){a.first();var a=a.last().attr("id"),e=-1;a&&(a=a.split("-"),e=u.indexOf(a[a.length-
1]));v.start=0;v.end=e}}function p(b,c){g();var f=!1;try{var i=a(b),h=j();c==="prepend"?h.prepend(i):h.append(i);e(h);S();f=!0}catch(n){console.log("Couldn't append the aisnBlockHTML in search stripe: "+b+" It gave following error: "+n.message),d&&d.incrementCounterByOne("ErrorInAsinBlockAppendForSearchStripe")}return f}function j(){var a=i;H&&(a=i.find(".jspPane"));return a}var k=a("#search-stripe-container"),i=a("#search-stripe-item-list"),n=a(".search-stripe-item"),o,E=0;n.length!==0&&(E=parseInt(n.eq(0).outerHeight(),
10));var ca=a("#ppd"),ja=a("#searchStripeOnDetailPage"),n="C",u=[],v={start:-1,end:-1},s=n=0;if((n=a("#search-stripe-asin-list"))&&n.length>0)if(n=n.data("asinlist"))u=n.split(","),n=u.length,s=n*E;var H=!1,n=b.getDataAttribute("div#searchStripeOnDetailPage","searchstripetreatment"),U='<li class="search-stripe-item search-stripe-large search-stripe-item-loader"><div class="a-spinner-wrapper search-stripe-spinner"><span class="a-spinner a-spinner-medium"></span></div></li><li class="search-stripe-item search-stripe-thumbnail search-stripe-item-loader"><div class="a-spinner-wrapper search-stripe-spinner"><span class="a-spinner a-spinner-medium"></span></div></li>';
n==="T2"&&(U='<li class="search-stripe-item search-stripe-thumbnail search-stripe-item-loader search-stripe-thumbnail-t2"><div class="a-spinner-wrapper search-stripe-spinner"><span class="a-spinner a-spinner-medium"></span></div></li>');var J=ca.height(),I=s-k.height(),Y=!1,$=!1,aa=!1,Z=function(){var a=-1*parseInt(o.css("top"),10);!Y&&a>I/4?(Y=!0,d.incrementCounterByOne("ss_scrolled_upto_50")):!$&&a>I/2?($=!0,d.incrementCounterByOne("ss_scrolled_beyond_50")):!aa&&a>I*3/4&&(aa=!0,d.incrementCounterByOne("ss_scrolled_beyond_75"),
i.unbind("scroll",Z))};k.bind("mouseenter",c);k.bind("mouseleave",f);var S=function(){k.height("600px");J=ca.height();k.height(J);I=s-J;H&&i.data("jsp").reinitialise()};l.onresize=function(){S()};return{searchStripeTreatment:function(){var a="C";ja&&(a=ja.attr("data-searchStripeTreatment"));return a},setCurrentWindowIndices:function(){return e(j())},getContainer:function(){return k},getContainerItemList:function(){return i},getItemContainer:function(){return j()},addScrolling:function(e){e(i);H=!0;
o=a(".jspPane");d&&o.length!==0&&i.bind("scroll",Z)},addLoaders:function(){var a=j(),e;for(e=0;e<5;e++)a.append(U);S()},cleanLoaders:function(){g()},updateScroll:function(){S()},appendAsinBlocks:function(a){return p(a,"append")},prependAsinBlocks:function(a){return p(a,"prepend")},getWindowSize:function(){return 5},getEntireAsinList:function(){return u},firstAsinInStripe:function(){return m(v.start)},lastAsinInStripe:function(){return m(v.end)},getCurrentWindowIndices:function(){return v},currentNumberOfAsinsShownOnStripe:function(){var a=
0;-1!==v.end&&-1!==v.start&&(a=v.end-v.start+1);return a},asinCapacity:function(){return 5}}};return b.checkWeblabTreatment("div#searchStripeOnDetailPage","searchstripeondetailpage",!0)?f():{}});g.when("A","softlines-common-utils","searchStripeScroll","atf").register("searchStripeInteractions",function(f,d,b){var a;return{addInteractions:function(c){a=c;a.addScrolling(b)}}});g.when("A","searchStripeAjaxRequest","softlines-common-utils","searchStripeContainer","searchStripeInteractions","ueCount",
"atf").execute(function(f,d,b,a,c){function h(e){e&&e.length&&a.appendAsinBlocks(e)}function g(e){e&&e.length&&a.prependAsinBlocks(e)}function m(){var e=a.getEntireAsinList(),c=e.join(","),f=a.getWindowSize(),k=a.getCurrentWindowIndices(),i=b.getCurrentAsin(),n=a.searchStripeTreatment();if(k.start>0)for(var o=k.start;o>0;){o-=f;o<0&&(o=0);var E=e[o],E={searchStripeDPWeblabTreatment:n,searchStripeStartAsin:E,searchStripeAsinList:c,searchStripeCurrentAsin:i};d.sendAjaxGet(E,g)}var m=e.length-1;if(k.end<
m){a.addLoaders();for(o=k.end+1;o<=m;)E=e[o],E={searchStripeDPWeblabTreatment:n,searchStripeStartAsin:E,searchStripeAsinList:c,searchStripeCurrentAsin:i},d.sendAjaxGet(E,h),o+=f}else a.updateScroll()}b.checkWeblabTreatment("div#searchStripeOnDetailPage","searchstripeondetailpage",!0)&&(a.setCurrentWindowIndices(),m(),c.addInteractions(a,d))});g.when("jQuery","ueCount").execute(function(f,d){try{var b=f(".dp-heart-button"),a=f(".email"),c=f("#facebook"),h=f("#twitter"),g=f("#pinterest"),m=!1;f(".collect-and-share-buttons-wrapper").length===
1&&(m=!0);var e=function(a,e){a.bind("click",function(){d.incrementCounterByOne(e+"_"+(m?"T1":"C"))})};e(b,"rsw_heart");e(a,"rsw_email");e(c,"rsw_fb");e(h,"rsw_twitter");e(g,"rsw_pinterest")}catch(p){d.incrementCounterByOne("error_in_rsw_counter")}});g.when("A","ueCount","softlines-common-utils").register("searchStripeScroll",function(f,d,b){var a=f.$,c=function(b,f){function g(e,b){function c(b){var d,i,g,o,p=!1,u=!1;q=b;if(r===s)g=e.scrollTop(),o=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),
t=e.innerWidth()+V,w=e.innerHeight(),e.width(t),r=a('<div class="jspPane" />').css("padding",ea).append(e.children()),x=a('<div class="jspContainer" />').css({width:t+"px",height:w+"px"}).append(r).appendTo(e);else{e.css("width","");p=q.stickToBottom&&Y();u=q.stickToRight&&$();if(b=e.innerWidth()+V!==t||e.outerHeight()!==w)t=e.innerWidth()+V,w=e.innerHeight(),x.css({width:t+"px",height:w+"px"});if(!b&&ka===G&&r.outerHeight()===B){e.width(t);return}ka=G;r.css("width","");e.width(t);x.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}r.css("overflow",
"auto");G=q.contentWidth?q.contentWidth:r[0].scrollWidth;B=r[0].scrollHeight;r.css("overflow","");la=G/t;ba=B/w;K=ba>1;L=!1;if(!L&&!K)e.removeClass("jspScrollable"),r.css({top:0,left:0,width:x.width()-V}),x.unbind(fa),A();else{e.addClass("jspScrollable");if(b=q.maintainPosition&&(y||z))d=-r.position().left,i=-r.position().top;f();h();E();b&&(I(u?G-t:d,!1),J(p?B-w:i,!1));aa();S();q.clickOnTrack&&m()}q.autoReinitialise&&!W?W=setInterval(function(){c(q)},q.autoReinitialiseDelay):!q.autoReinitialise&&
W&&clearInterval(W);g&&e.scrollTop(0)&&J(g,!1);o&&e.scrollLeft(0)&&I(o,!1);e.trigger("jsp-initialised",[L||K]);r.width(t)}function f(){K&&(x.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),ga=x.find(">.jspVerticalBar"),M=ga.find(">.jspTrack"),C=M.find(">.jspDrag"),X=w,x.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){X-=
a(this).outerHeight()}),C.hover(function(){C.addClass("jspHover")},function(){C.removeClass("jspHover")}).bind("mousedown.jsp",function(e){a("html").bind("dragstart.jsp selectstart.jsp",Z);C.addClass("jspActive");d&&d.incrementCounterByOne("ss_scroll_thumb_drag");var b=e.pageY-C.position().top;a("html").bind("mousemove.jsp",function(a){v(a.pageY-b,!1)}).bind("mouseup.jsp mouseleave.jsp",u);return!1}),i())}function i(){M.height(X+"px");y=0;ma=q.verticalGutter+M.outerWidth();r.width(t);try{ga.position().left===
0&&r.css("margin-left",ma+"px")}catch(a){}}function h(){L&&(x.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),ha=x.find(">.jspHorizontalBar"),N=ha.find(">.jspTrack"),D=N.find(">.jspDrag"),D.hover(function(){D.addClass("jspHover")},function(){D.removeClass("jspHover")}).bind("mousedown.jsp",
function(e){a("html").bind("dragstart.jsp selectstart.jsp",Z);D.addClass("jspActive");var b=e.pageX-D.position().left;a("html").bind("mousemove.jsp",function(a){H(a.pageX-b,!1)}).bind("mouseup.jsp mouseleave.jsp",u);return!1}),T=x.innerWidth(),o())}function o(){x.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){T-=a(this).outerWidth()});N.width(T+"px");z=0}function E(){if(L&&K){var e=N.outerHeight(),b=M.outerWidth();X-=e;a(ha).find(">.jspCap:visible,>.jspArrow").each(function(){T+=
a(this).outerWidth()});T-=b;w-=b;t-=e;N.parent().append(a('<div class="jspCorner" />').css("width",e+"px"));i();o()}B=r.outerHeight();ba=B/w;if(L){O=Math.ceil(1/la*T);if(O>q.horizontalDragMaxWidth)O=q.horizontalDragMaxWidth;else if(O<q.horizontalDragMinWidth)O=q.horizontalDragMinWidth;D.width(O+"px");P=T-O;U(z)}if(K){Q=Math.ceil(1/ba*X);if(Q>q.verticalDragMaxHeight)Q=q.verticalDragMaxHeight;else if(Q<q.verticalDragMinHeight)Q=q.verticalDragMinHeight;C.height(Q+"px");R=X-Q;l(y)}}function m(){A();K&&
M.bind("mousedown.jsp",function(e){if(e.originalTarget===s||e.originalTarget===e.currentTarget){var b=a(this),c=b.offset(),f=e.pageY-c.top-y,i,h=!0,g=function(){var a=b.offset(),a=e.pageY-a.top-Q/2,c=w*q.scrollPagePercent,k=R*c/(B-w);if(f<0)y-k>a?F.scrollByY(-c):v(a);else if(f>0)y+k<a?F.scrollByY(c):v(a);else{n();return}f!==0&&d&&d.incrementCounterByOne("ss_scroll_track_click");i=setTimeout(g,h?q.initialDelay:q.trackClickRepeatFreq);h=!1},n=function(){i&&clearTimeout(i);i=null;a(document).unbind("mouseup.jsp",
n)};g();a(document).bind("mouseup.jsp",n);return!1}});L&&N.bind("mousedown.jsp",function(e){if(e.originalTarget===s||e.originalTarget===e.currentTarget){var b=a(this),c=b.offset(),d=e.pageX-c.left-z,f,i=!0,h=function(){var a=b.offset(),a=e.pageX-a.left-O/2,c=t*q.scrollPagePercent,n=P*c/(G-t);if(d<0)z-n>a?F.scrollByX(-c):H(a);else if(d>0)z+n<a?F.scrollByX(c):H(a);else{g();return}f=setTimeout(h,i?q.initialDelay:q.trackClickRepeatFreq);i=!1},g=function(){f&&clearTimeout(f);f=null;a(document).unbind("mouseup.jsp",
g)};h();a(document).bind("mouseup.jsp",g);return!1}})}function A(){N&&N.unbind("mousedown.jsp");M&&M.unbind("mousedown.jsp")}function u(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");C&&C.removeClass("jspActive");D&&D.removeClass("jspActive")}function v(a,e){if(K){a<0?a=0:a>R&&(a=R);if(e===s)e=q.animateScroll;e?F.animate(C,"top",a,l):(C.css("top",a),l(a))}}function l(a){if(a===s)a=C.position().top;x.scrollTop(0);y=a||0;var b=y===0,c=y===R,a=-(a/R)*(B-
w);if(na!==b||oa!==c)na=b,oa=c;r.css("top",a);e.trigger("jsp-scroll-y",[-a,b,c]).trigger("scroll")}function H(a,e){if(L){a<0?a=0:a>P&&(a=P);if(e===s)e=q.animateScroll;e?F.animate(D,"left",a,U):(D.css("left",a),U(a))}}function U(a){if(a===s)a=D.position().left;x.scrollTop(0);z=a||0;var b=z===0,c=z===P,a=-(a/P)*(G-t);if(pa!==b||qa!==c)pa=b,qa=c;r.css("left",a);e.trigger("jsp-scroll-x",[-a,b,c]).trigger("scroll")}function J(a,e){v(a/(B-w)*R,e)}function I(a,e){H(a/(G-t)*P,e)}function Y(){var a=B-w;return a>
20&&a- -r.position().top<10}function $(){var a=G-t;return a>20&&a- -r.position().left<10}function aa(){x.unbind(fa).bind(fa,function(a,e,b,c){z||(z=0);y||(y=0);var e=z,d=y,a=a.deltaFactor||q.mouseWheelSpeed;F.scrollBy(b*a,-c*a,!1);return e===z&&d===y})}function Z(){return!1}function S(){var a,e,b,c,d,f=!1;x.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(i){i=i.originalEvent.touches[0];a=-r.position().left;e=-r.position().top;b=i.pageX;c=i.pageY;
d=!1;f=!0}).bind("touchmove.jsp",function(i){if(f){var i=i.originalEvent.touches[0],h=z,g=y;F.scrollTo(a+b-i.pageX,e+c-i.pageY);d=d||Math.abs(b-i.pageX)>5||Math.abs(c-i.pageY)>5;return h===z&&g===y}}).bind("touchend.jsp",function(){f=!1}).bind("click.jsp-touchclick",function(){if(d)return d=!1})}var q,F=this,r,t,w,x,G,B,la,ba,K,L,C,R,y,D,P,z,ga,M,ma,X,Q,ha,N,T,O,W,ea,V,ka,na=!0,pa=!0,oa=!1,qa=!1,ia=e.clone(!1,!1).empty(),fa=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";e.css("box-sizing")===
"border-box"?V=ea=0:(ea=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft"),V=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0));a.extend(F,{reinitialise:function(e){e=a.extend({},q,e);c(e)},scrollTo:function(a,e,b){I(a,b);J(e,b)},scrollToX:function(a,e){I(a,e)},scrollToY:function(a,e){J(a,e)},scrollToPercentX:function(a,e){I(a*(G-t),e)},scrollToPercentY:function(a,e){J(a*(B-w),e)},scrollBy:function(a,e,b){F.scrollByX(a,b);
F.scrollByY(e,b)},scrollByX:function(a,e){var b=(-r.position().left+Math[a<0?"floor":"ceil"](a))/(G-t);H(b*P,e)},scrollByY:function(a,e){var b=(-r.position().top+Math[a<0?"floor":"ceil"](a))/(B-w);v(b*R,e)},positionDragX:function(a,e){H(a,e)},positionDragY:function(a,e){v(a,e)},animate:function(a,e,b,c){var d={};d[e]=b;a.animate(d,{duration:q.animateDuration,easing:q.animateEase,queue:!1,step:c})},destroy:function(){var a=-r.position().top,b=-r.position().left;e.removeClass("jspScrollable").unbind(".jsp");
r.unbind(".jsp");e.replaceWith(ia.append(r.children()));ia.scrollTop(a);ia.scrollLeft(b);W&&clearInterval(W)}});c(b)}f=a.extend({},c.defaults,f);a.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){f[this]=f[this]||f.speed});return b.each(function(){var e=a(this),b=e.data("jsp");b?b.reinitialise(f):(a("script",e).filter('[type="text/javascript"],:not([type])').remove(),b=new g(e,f),e.data("jsp",b))})};c.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,
clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:300,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:s,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,
hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8};return b.checkWeblabTreatment("div#searchStripeOnDetailPage","searchstripeondetailpage",!0)?c:{}});g.when("A","softlines-common-utils").execute(function(f,d){function b(b){var d=b||l.event,f=m.call(arguments,1),h=0,g=0,j=0,u=0,v=0,A=0,b=c.event.fix(d);b.type="mousewheel";"detail"in d&&(j=d.detail*-1);if("wheelDelta"in d)j=d.wheelDelta;if("wheelDeltaY"in d)j=d.wheelDeltaY;"wheelDeltaX"in d&&(g=d.wheelDeltaX*-1);"axis"in d&&
d.axis===d.HORIZONTAL_AXIS&&(g=j*-1,j=0);h=j===0?g:j;"deltaY"in d&&(h=j=d.deltaY*-1);if("deltaX"in d)g=d.deltaX,j===0&&(h=g*-1);if(!(j===0&&g===0)){d.deltaMode===1?(u=c.data(this,"mousewheel-line-height"),h*=u,j*=u,g*=u):d.deltaMode===2&&(u=c.data(this,"mousewheel-page-height"),h*=u,j*=u,g*=u);u=Math.max(Math.abs(j),Math.abs(g));if(!p||u<p)p=u,k.settings.adjustOldDeltas&&d.type==="mousewheel"&&u%120===0&&(p/=40);k.settings.adjustOldDeltas&&d.type==="mousewheel"&&u%120===0&&(h/=40,g/=40,j/=40);h=Math[h>=
1?"floor":"ceil"](h/p);g=Math[g>=1?"floor":"ceil"](g/p);j=Math[j>=1?"floor":"ceil"](j/p);k.settings.normalizeOffset&&this.getBoundingClientRect&&(d=this.getBoundingClientRect(),v=b.clientX-d.left,A=b.clientY-d.top);b.deltaX=g;b.deltaY=j;b.deltaFactor=p;b.offsetX=v;b.offsetY=A;b.deltaMode=0;f.unshift(b,h,g,j);e&&clearTimeout(e);e=setTimeout(a,200);return(c.event.dispatch||c.event.handle).apply(this,f)}}function a(){p=null}if(d.checkWeblabTreatment("div#searchStripeOnDetailPage","searchstripeondetailpage",
!0)){var c=f.$,h=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],g="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],m=Array.prototype.slice,e,p;if(c.event.fixHooks)for(var j=h.length;j;)c.event.fixHooks[h[--j]]=c.event.mouseHooks;var k=c.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=g.length;a;)this.addEventListener(g[--a],b,!1);else this.onmousewheel=b;c.data(this,"mousewheel-line-height",
k.getLineHeight(this));c.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=g.length;a;)this.removeEventListener(g[--a],b,!1);else this.onmousewheel=null;c.removeData(this,"mousewheel-line-height");c.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){var a=c(a),e=a["offsetParent"in c.fn?"offsetParent":"parent"]();e.length||(e=c("body"));return parseInt(e.css("fontSize"),10)||parseInt(a.css("fontSize"),10)||16},getPageHeight:function(a){return c(a).height()},
settings:{adjustOldDeltas:!0,normalizeOffset:!0}};c.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}});g.when("jQuery","ready").execute(function(f){f("#brandFollow").length>0&&g.load.js("https://www.amazon.com/follow/follow_button.js")})})})(function(){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors;return l?l("SoftlinesFeaturesAssets"):g}(),window);
/* ******** */
(function(g){g.execute(function(){})})(function(){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors;return l?l("SoftlinesRecommendationsAssets"):g}(),window);
/* ******** */
(function(a,b){a.execute(function(){a.when("jQuery","A","a-util","p13n-sc-math","p13n-sc-call-on-visible","p13n-sc-lazy-image-loader").register("srecs-grid",function(c,j,g,k,l,m){function e(d){this.$container=c(d);this.$gridCells=this.$container.find(".srecs-grid-cell");this.currentCellIndex=0;this.bindEvents();this.adjustGrid();this.$container.addClass("show-border");m.loadImages(this.$container)}var i=[".srecs-image-container",".srecs-product-details-container"];e.prototype={bindEvents:function(){var d=
this;c(b).bind("resize.srecs-grid",function(){d.resetGrid();d.adjustGrid()});j.on("p13n-sc-infinite-widget:loaded-products",function(a){d.$gridCells=d.$gridCells.add(a);d.adjustGrid()})},adjustGrid:function(){for(var d,a;this.currentCellIndex+1<this.$gridCells.length;)d=this.$gridCells.eq(this.currentCellIndex),a=this.$gridCells.eq(this.currentCellIndex+1),d.height()!==a.height()&&this.adjustRowHeight(d,a),this.currentCellIndex+=2},adjustRowHeight:function(a,b){var f=this;g.each(i,function(c){var e=
[a.find(c).first(),b.find(c).first()],h=0;g.each(e,function(a){h=k.max(h,a.height())});g.each(e,function(a){a.height(h);c===".srecs-image-container"&&f.centerImage(a)})})},centerImage:function(a){var b=a.find("img").first();b.css("margin-top",(a.height()-b.height())/2)},resetGrid:function(){this.$container.find(i.join(", ")).each(function(a,b){var f=c(b);f.height("auto");f.hasClass(".srecs-image-container")&&f.find("img").first().css("margin-top","")});this.currentCellIndex=0}};a.when("afterReady").execute("srecs-grid:init",
function(){var a={distanceY:-500,distanceX:0};c(".srecs-grid-container").each(function(b,c){l.register(c,function(){new e(c)},a)})});return e})})})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("SoftlinesRecommendationsMobileAssets"):a}(),window);
/* ******** */
(function(k,m){k.execute(function(){k.when("A","jQuery","ready").register("DeliveryCountdownComponent",function(d,a){function i(a,d,e,c,l){this.strings=a;this.asin=d;this.deliveryMessageSectionId=e;this.countdownElementId=c;this.secondsLeft=l;this.intervalHandle=null}m.DeliveryCountdownHandler=function(a){var d=a.strings,e=a.asin,c=a.deliveryMessageSectionId,l=a.fastCountdownElementId,g=a.cheapCountdownElementId;this.cheapCountdownTimer=this.fastCountdownTimer=null;this.start=function(a,j){if(a>0)this.fastCountdownTimer=
new i(d,e,c,l,a),this.fastCountdownTimer.start();if(j>0)this.cheapCountdownTimer=new i(d,e,c,g,j),this.cheapCountdownTimer.start()};this.stop=function(){if(this.fastCountdownTimer)this.fastCountdownTimer.stop(),this.fastCountdownTimer=null;if(this.cheapCountdownTimer)this.cheapCountdownTimer.stop(),this.cheapCountdownTimer=null}};i.prototype.start=function(){var a=this;this.intervalHandle=d.interval(function(){a&&a.updateCountdownText()},1E3)};i.prototype.stop=function(){this.intervalHandle&&m.clearInterval(this.intervalHandle)};
i.prototype.updateCountdownText=function(){this.secondsLeft--;if(this.secondsLeft>0){var d=Math.floor(this.secondsLeft/60),h=d%60,d=Math.floor(d/60),e=this.secondsLeft%60,c=this.strings.inNext,l=d>1?this.strings.hours:this.strings.hour,g=h>1?this.strings.minutes:this.strings.minute,o=e>1?this.strings.seconds:this.strings.second,j=this.strings.timeSeperator;a(this.countdownElementId).html(d>0&&h>0?d+j+l+j+h+j+g+j+c:d>0&&h===0?d+j+l+c:d===0&&h>0?h+j+g+c:e+j+o+c)}else this.stop(),h="<a href='javacript:window.location.reload();'>"+
this.strings.refreshTimeout+"</a>",a(this.deliveryMessageSectionId).html(h)}});k.when("A","jQuery","LUXContext").register("LUXController",function(d,a,i){function f(){return{addressLabel:b,addressId:C,obfuscatedId:m,countryCode:s,zipCode:t,state:r,city:p,district:u,locationType:x}}function h(c){b=c.addressLabel;C=c.addressId;m=c.obfuscatedId;s=c.countryCode;t=c.zipCode;r=c.state;p=c.city;u=c.district;x=c.locationType}function e(b,c,a){b=d.copy(b);b.deviceType=i.deviceType;b.pageType=l;d.post(A,{contentType:"application/x-www-form-urlencoded;charset=utf-8",
params:b,success:function(b){if(b.sembuUpdated){b.address&&h(b.address);var j=f();d.trigger(o,j);d.trigger(g,j);c&&c();k.when("LUXMetrics").execute(function(b){b.logLocationChange(j.locationType)})}else a&&a()},error:function(){d.trigger(j,f());a&&a()}})}var c=!1,l=null,g="DeliveryAddressDropdown_OnAddressChange",o="DeliveryAddressDropdown_OnSembuUpdateSuccess",j="DeliveryAddressDropdown_OnSembuUpdateFail",b,C,m,s,t,r,p,u,x,A="/gp/delivery/ajax/address-change.html";return{locationChangeEventName:g,
locationTypes:{defaultAddress:"DEFAULT_ADDRESS",accountAddress:"ACCOUNT_ADDRESS",lockerAddress:"LOCKER_ADDRESS",locationInput:"LOCATION_INPUT",realmDefault:"REALM_DEFAULT",region:"REGION",country:"COUNTRY",ip2location:"IP2LOCATION"},init:function(b){k.when("LUXResponder").execute(function(a){c?d.equals(b,f())||(h(b),a.refresh()):(h(b),a.activate(),c=!0)});k.when("LUXCustom").execute(function(b){b.activate()});k.when("LUXMetrics").execute(function(b){l=b.getPageType()})},getLocationData:function(){return f()},
changeLocation:function(b,c,a){e(b,c,a)}}});k.when("A","LUXDPOnly").register("LUXDPRefreshController",function(d){function a(a){g=a;i({addressId:g.addressId,zipCode:g.zipCode,city:g.city,state:g.state,district:g.district,countryCode:g.countryCode});var b={asin:g.asin,merchantId:g.merchantId,deviceType:g.deviceType,smid:g.smid,exMerchId:g.exMerchId};g.useTwisterRefresh==="T1"&&k.when("TwisterUpdateHandler").execute(function(a){a.init(b);c=!0;l=a});k.when("UnifiedLocationUpdateHandler").execute(function(a){c||
(a.init(b),l=a)});f(g.obfuscatedId);h(g.obfuscatedId)}function i(c){var b=1;e("#quantity").length===1&&(b=e("#quantity").val());d.state("unifiedLocation",{addressId:c.addressId,zipCode:c.zipCode,city:c.city,state:c.state,district:c.district,countryCode:c.countryCode,quantity:b})}function f(c){if(g&&g.oneClick){var b="unifiedLocation1ClickAddress";g.deviceType&&g.deviceType==="mobileApp"&&(b="addressID");c||(c=g.addNewAddress?g.addNewAddress:e("#"+b).data("addnewaddress"));b='[id="'+b+'"]';0<e(b).length&&
e(b).val(c);if(g.deviceType&&g.deviceType in o&&(b=d.state("buyNowInfo"))){var a=b.urlParams,a=a.indexOf("addressID=")>0?a.replace(/(addressID=)[^&]*/,"$1"+c):a+"&addressID="+c;b.urlParams=a;d.state("buyNowInfo",b)}}}function h(c){g&&!g.oneClick&&g.updateAddressForNon1Click==="T1"&&(c||(c=g.addNewAddress?g.addNewAddress:e("#unifiedLocationAddress").data("addnewaddress")),e("#unifiedLocationAddress").length===1&&e("#unifiedLocationAddress").val(c))}var e=d.$,c=!1,l=null,g=null,o={tabletApp:1,tabletLargeApp:1,
iPad:1};d.on("DeliveryAddressDropdown_OnAddressChange",function(a){i(a);f(a.obfuscatedId);h(a.obfuscatedId);l!==null&&(l.refresh(),c||d.trigger("LocationUX_OnAddressChange",a))});d.on("UnifiedLocationPostRefresh",function(){d.trigger("diodeAjaxRefreshed")});return{init:function(c){a(c)}}});k.when("A","detailPage:RefreshHandler","LUXDPOnly","a-state").execute(function(d,a){k.register("TwisterUpdateHandler",function(){return{init:function(a){d.state("unifiedLocation",a)},refresh:function(){var i=a.getHandlerInstance("LocationUX"),
f=[],h="addressId,zipCode,city,state,district,countryCode".split(",");if(i){var e=d.state("unifiedLocation"),c;for(c in e)if(e.hasOwnProperty(c)&&d.$.inArray(c,h)>-1){var l=typeof e[c];if(l==="number"||l==="boolean"||l==="string"||e[c]instanceof String)f.push(i.getURLParamObject(c,e[c]===null?"":e[c],1))}}f.length>0&&i.doPageRefresh(f)}}})});k.when("A","LUXDPOnly","a-state").execute(function(d){k.register("UnifiedLocationUpdateHandler",function(){return{init:function(c){d.state("unifiedLocation",
c)},refresh:function(){a=2;i()}}});var a=0,i=function(){var c=d.state("unifiedLocation"),a;for(a in c)if(c.hasOwnProperty(a)){var g=typeof c[a];g==="number"||g==="boolean"||g==="string"||c[a]instanceof String||(c[a]===null?c[a]="":delete c[a])}c&&c.asin&&c.merchantId&&(d.trigger("UnifiedLocationPreRefresh"),d.ajax("/gp/product/features/unified-location/udp/refresh-features.html?_encoding=UTF-8",{params:c,method:"POST",success:f,error:h,abort:e}))},f=function(){d.trigger("UnifiedLocationPostRefresh",
!0)},h=function(){d.trigger("UnifiedLocationPostRefresh",!1);--a>0&&i()},e=function(){d.trigger("UnifiedLocationPostRefresh",!1)}});k.when("A","jQuery","a-popover","LUXWidgetConfig","ready").execute(function(d,a,i,f){function h(h){var i=!1,D=h.selectedAddressId,v=h.selectedObfuscatedId,E=h.selectedAddressLabel,H=h.selectedCountryCode,N=h.selectedZipCode,B=h.selectedState,w=h.selectedCity,n=h.selectedDistrict,q=h.addressPopover.name,y=h.addressPopover.type,J=f.initialAddressLoadCount,K=f.addressReloadCount,
z=h.deviceType,L=h.isRecognized,I=0,M=!1;this.init=function(){i||(i=!0,U())};this.destroy=function(){d.off("a:popover:beforeShow:"+q,T);d.off("a:popover:afterHide:"+q,R);d.capabilities.tablet&&a.isFunction(d.off.orientationchange)&&d.off.orientationchange(X);a(document).undelegate(g,"focus");a(document).undelegate(g,"input");a(document).undelegate(r,"click");a(document).undelegate(l,"click");a(document).undelegate(j+" input[type=radio], "+p+" ul li .a-touch-link.a-touch-select","click");a(document).undelegate(s,
"click")};var G=function(){k.when(y).execute(function(b){b.get(q)&&b.get(q).hide()})},U=function(){d.on("a:popover:beforeShow:"+q,T);d.on("a:popover:afterHide:"+q,R);d.capabilities.tablet&&a.isFunction(d.on.orientationchange)&&d.on.orientationchange(X);a(document).delegate(g,"focus",function(){$()});a(document).delegate(r,"click",function(){var b=!0;z==="mobileApp"&&k.now("mash").execute(function(c){c&&(b=!1,c.navstack.begin().back().end(),c.showLoginDialog({successCallback:function(){c.navstack.begin().back().forward(m.location.href).end()}}))});
if(b)m.location.href=h.addressPopover.signInURL+m.location.pathname});a(document).delegate(g,"keyup",function(){Q()});a(document).delegate(g,"keypress",function(b){(b.keyCode||b.which)===13&&S()});a(document).delegate(l,"click",function(){S()});a(document).delegate(j+" input[type=radio], "+p+" ul li .a-touch-link.a-touch-select","click",function(){var b=a.parseJSON(a(this).hasClass("a-touch-link")?a(this).find("input[type=hidden]").val():a(this).val());if(a(this).hasClass("a-active"))G();else if(b){var c=
b.id;c!==D&&aa({addressId:c,isDefaultShippingAddress:b.isDefault,addressLabel:b.label,deviceType:z},!1,a(this))}});a(document).delegate(s,"click",function(){Y()});z==="tabletApp"&&m.scrollBy(0,1)},V=a(g).attr("placeholder"),Q=function(){z==="tabletApp"&&(a(g).val()?a(g).removeAttr("placeholder"):a(g).attr("placeholder",V))},S=function(){var b=a(g).val();!b||!b.match(/^\d{5}$/)?Z():aa({zipCode:b,deviceType:z},!0,null)},T=function(){a(o).hasClass("aok-hidden")||(a(g).val(""),$());d.capabilities.tablet&&
a("#a-popover-lgtbox")&&a("#a-popover-lgtbox").css({position:"absolute",top:"0px",left:"0px",width:"100%",height:a("#a-page").css("height")});Q();M||Y()},R=function(){z==="tabletApp"&&document.activeElement.blur()},X=function(){k.when(y).execute(function(b){b.get(q)&&b.get(q).refresh()})},Y=function(){L&&a.ajax({type:"POST",url:e,contentType:"application/x-www-form-urlencoded;charset=utf-8",data:{currentAddressCount:I,loadCount:M?K:J,selectedAddressId:D,deviceType:z},dataType:"json",success:function(c){if(c){var d=
c.loadedAddressCount;if(d>0){var e=c.html;e&&(a(p).length?(a(p+" ul li").has("span .a-touch-link.a-touch-select").remove(),a(p+" ul").html(e+a(p+" ul").html())):a(j).html(e),a(b).removeClass("a-hidden aok-hidden"),a(C).addClass("aok-hidden"),a(t).removeClass("a-hidden aok-hidden"),k.when(y).execute(function(b){b.get(q)&&b.get(q).updatePosition()}),c.hasMore?a(s).removeClass("a-hidden aok-hidden"):a(s).addClass("aok-hidden"),I=d)}}M=!0},error:function(){}})},Z=function(){a(g).addClass("a-form-error");
a(o).removeClass("a-hidden aok-hidden");z==="tabletApp"&&(document.activeElement.blur(),a(o)[0].scrollIntoView())},$=function(){a(g).removeClass("a-form-error");a(o).addClass("aok-hidden")},aa=function(b,d,e){a.ajax({type:"POST",url:c,contentType:"application/x-www-form-urlencoded;charset=utf-8",data:b,dataType:"json",success:function(b){if(b.sembuUpdated){if(b=b.address)D=b.addressId,v=b.obfuscatedId,E=b.addressLabel,H=b.countryCode,N=b.zipCode,B=b.state,w=b.city,n=b.district,b="",b=E?E:(w?w+", ":
"")+(B?B+" ":"")+N,a(F).html(b),d&&(a(j+" input[type=radio]:checked").attr("checked",!1),a(g).val("")),a(p+" ul li .a-touch-link.a-touch-select.a-active").removeClass("a-active"),e&&e.hasClass("a-touch-link")&&e.addClass("a-active");G();W(x);W(u)}else b.isValidAddress||Z()},error:function(){W(A)}})},W=function(b){d.trigger(b,{addressId:D,obfuscatedId:v,countryCode:H,zipCode:N,state:B,city:w,district:n})}}var e="/gp/delivery/ajax/get-customer-address-list.html",c="/gp/delivery/ajax/address-change.html",
l="#unifiedLocationAddrUpdate",g="#unifiedLocationAddrInput",o="#unifiedLocationInvalidInputAlert",j="#unifiedLocationAccountAddrList",b="#unifiedLocationTitleSelectAddress",C="#unifiedLocationTitleNoAddress",F="#unifiedLocationSelectedAddressText",s="#unifiedLocationSeeMore",t="#unifiedLocationSeeMoreDiv",r="#unifiedLocationSignIn",p="#unifiedLocationPopoverSelections",u="DeliveryAddressDropdown_OnAddressChange",x="DeliveryAddressDropdown_OnSembuUpdateSuccess",A="DeliveryAddressDropdown_OnSembuUpdateFail";
k.register("DeliveryAddressDropdown",function(){var b;return{init:function(c){b&&b.destroy();(b=new h(c)).init()}}})});k.when("A","jQuery","LUXContext","LUXWidgetConfig","LUXUtils","LUXController","LUXMetrics","ready").register("LUXResponder",function(d,a,i,f,h,e,c){function l(b){var c=null;b===I?(a(n).addClass("a-form-error"),a(q).width(a(q).parent().width()).removeClass("aok-hidden"),a(y).addClass("aok-hidden"),c=a(q)[0]):b===M?(a(n).removeClass("a-form-error"),a(q).addClass("aok-hidden"),a(y).width(a(y).parent().width()).removeClass("aok-hidden"),
c=a(y)[0]):b===G&&(a(n).removeClass("a-form-error"),a(q).addClass("aok-hidden"),a(y).addClass("aok-hidden"));d.capabilities.tablet&&c&&(document.activeElement.blur(),c.scrollIntoView())}function g(b){a(D).html(h.generateLocationLabel(b))}function o(b){b.locationType===e.locationTypes.locationInput&&b.zipCode?a(n).val(b.zipCode):a(n).val("");j();l(G)}function j(){d.capabilities.tablet&&(a(n).val()?a(n).removeAttr("placeholder"):a(n).attr("placeholder",L))}function b(b){for(var c=h.mapLocationDataToCode(b),
j=a(E+" .a-declarative"),f=j.length-1;f>=0;f--)d.parseJSON(j[f].getAttribute(K)).value===c?a(".a-touch-link",j[f]).addClass("a-active"):a(".a-touch-link",j[f]).removeClass("a-active");b.locationType===e.locationTypes.country||b.locationType===e.locationTypes.region||b.locationType===e.locationTypes.ip2location&&!b.state?(b=h.getNameForCode(c),a("#unifiedLocationCountrySelectionLink div")[0].childNodes[1].textContent=b):a("#unifiedLocationCountrySelectionLink div")[0].childNodes[1].textContent=z}function C(b){e.changeLocation(b.data,
null,null)}function F(b){e.changeLocation(h.mapCodeToLocationData(b.data.value),null,null)}function s(){var b=a(n).val();h.validateZipCode(b)?e.changeLocation({zipCode:h.preprocessZipCode(b),locationType:e.locationTypes.locationInput},function(){l(G)},function(){l(I)}):h.isMilitaryZipCode(b)?l(M):l(I)}function t(){k.when(f.addressSelectorComponentType).execute(function(b){b.get(f.addressSelectorComponentName)&&b.get(f.addressSelectorComponentName).hide()});k.when(f.countrySelectorComponentType).execute(function(b){b.get(f.countrySelectorComponentName)&&
b.get(f.countrySelectorComponentName).hide()})}function r(){var b=a(v+" ul li").has("span .a-touch-link.a-touch-select"),j=a(v+" ul li").has(".aok-hidden span .a-touch-link.a-touch-select"),b=b.length===j.length;j.slice(0,b?f.initialAddressLoadCount:f.addressReloadCount).removeClass("aok-hidden");a(v+" ul li").has(".aok-hidden span .a-touch-link.a-touch-select").length?a(B).removeClass("aok-hidden"):a(B).addClass("aok-hidden");d.capabilities.tablet&&k.when("a-modal").execute(function(b){b.get(f.addressSelectorComponentName)&&
b.get(f.addressSelectorComponentName).updatePosition()});b||c.logEvent(c.getEvents().click.seeMore)}function p(c){g(c);for(var j=a(v+" ul li .a-declarative").has(".a-touch-link.a-touch-select"),e=c.addressId,f=j.length-1;f>=0;f--)d.parseJSON(j[f].getAttribute(J)).addressId===e?a(".a-touch-link",j[f]).addClass("a-active"):a(".a-touch-link",j[f]).removeClass("a-active");o(c);b(c);t()}function u(){a(E+" .a-declarative").length===0&&d.post(O,{contentType:"application/x-www-form-urlencoded;charset=utf-8",
params:h.prepareCountrySelectionGeneratorInput(),success:function(c){a(E).html(c);d.capabilities.tablet&&k.when("a-modal").execute(function(b){b.get(f.countrySelectorComponentName)&&b.get(f.countrySelectorComponentName).updatePosition()});b(e.getLocationData())}});c.logWidgetView(c.getEvents().view.countrySelector)}function x(){var b=e.getLocationData();o(b);d.capabilities.tablet&&a("#a-popover-lgtbox")&&a("#a-popover-lgtbox").css({position:"absolute",top:"0px",left:"0px",width:"100%",height:a("#a-page").css("height")});
i.isRecognizedCustomer&&a(v+" ul li").has("span .a-touch-link.a-touch-select").length===0&&d.get(P,{params:{currentAddressId:b.addressId,deviceType:i.deviceType},success:function(b){b&&(a(N).addClass("aok-hidden"),a(H).removeClass("aok-hidden"),a(v+" ul li").first().before(b),r(),a(w).removeClass("aok-hidden"))}});c.logWidgetView(c.getEvents().view.addressSelector)}function A(){d.capabilities.tablet&&document.activeElement.blur()}var P="/gp/delivery/ajax/get-address-selections.html",O="/gp/delivery/ajax/get-country-selections.html",
D=".lux-location-label",v="#unifiedLocationPopoverSelections",E="#LUXCountrySelections",H="#unifiedLocationTitleSelectAddress",N="#unifiedLocationTitleNoAddress",B="#unifiedLocationSeeMore",w="#unifiedLocationSeeMoreDiv",n="#unifiedLocationAddrInput",q="#LUXInvalidZipCodeAlert",y="#LUXMilitaryZipCodeAlert",J="data-lux-address-selection",K="data-lux-country-selection",z=null,L=null,I=1,M=2,G=3;return{activate:function(){var h=e.getLocationData();c.logPageView(h.locationType);z=a("#unifiedLocationCountrySelectionLink div")[0].childNodes[1].textContent||
"";L=a(n).attr("placeholder");h.locationType===e.locationTypes.region&&g(h);d.on("a:popover:beforeShow:"+f.addressSelectorComponentName,x);d.on("a:popover:afterHide:"+f.addressSelectorComponentName,A);d.on("a:popover:beforeShow:"+f.countrySelectorComponentName,u);d.on(e.locationChangeEventName,p);d.declarative("lux-address-selection",["click"],C);b(h);o(h);a(document).delegate(n,"keypress",function(b){b.which===13&&s()});a(document).delegate(n,"focus",function(){l(G)});a(document).delegate(n,"keyup",
function(){j()});a(document).delegate("#unifiedLocationAddrUpdate","click",s);a(document).delegate("#unifiedLocationSignIn","click",function(){var b=!0;d.capabilities.mobile&&k.now("mash").execute(function(c){c&&(b=!1,c.navstack.begin().back().end(),c.showLoginDialog({successCallback:function(){c.navstack.begin().back().forward(m.location.href).end()}}))});if(b)m.location.href=f.signInURL+m.location.pathname;c.logEvent(c.getEvents().click.signIn)});a(document).delegate(B,"click",r);a(document).delegate(".lux-manage-address-link",
"click",function(){c.logEvent(c.getEvents().click.manageAddressBook);return!0});d.declarative("lux-country-selection",["click"],F);d.capabilities.tablet&&a.isFunction(d.on.orientationchange)&&(m.scrollBy(0,1),d.on.orientationchange(function(){k.when("a-modal").execute(function(b){b.get(f.addressSelectorComponentName)&&b.get(f.addressSelectorComponentName).isActive()&&b.get(f.addressSelectorComponentName).refresh();b.get(f.countrySelectorComponentName)&&b.get(f.countrySelectorComponentName).isActive()&&
b.get(f.countrySelectorComponentName).refresh()})}))},refresh:function(){p(e.getLocationData())}}});k.declare("LUXWidgetConfig",{addressSelectorComponentName:"LUXAddressSelector",addressSelectorComponentType:"a-secondary-view",countrySelectorComponentName:"LUXCountrySelector",countrySelectorComponentType:"a-secondary-view",initialAddressLoadCount:5,addressReloadCount:1E3,signInURL:"/gp/aw/si.html?ie=UTF8&destinationURL="});k.when("A","jQuery","LUXController","RegionNames","ready").register("LUXRegionData",
function(d,a,i,f){function h(c){if(d.objectIsEmpty(c)||!c.countryCode||!c.zipCode)return null;for(var a in e)if(e.hasOwnProperty(a)&&d.reduce(e[a],function(f,h,j){return f&&!d.objectIsEmpty(c[j])&&d.equals(c[j],e[a][j])},!0))return a;return null}var e={"GB-ML":{countryCode:"GB",zipCode:"KA10 6EB"},"GB-NI":{countryCode:"GB",zipCode:"BT1 3ES"},"GB-JE":{countryCode:"GB",zipCode:"JE2 4QA"},"GB-IS":{countryCode:"GB",zipCode:"ZE1 0BX"},"GB-BF":{countryCode:"GB",zipCode:"BFPO 204"},"GB-HI":{countryCode:"GB",
zipCode:"PH41 4PU"},"DE-ML":{countryCode:"DE",zipCode:"60313"},"DE-GI":{countryCode:"DE",zipCode:"27498"},"FR-ML":{countryCode:"FR",zipCode:"75001"},"FR-CH":{countryCode:"FR",zipCode:"20000"},"FR-GP":{countryCode:"FR",zipCode:"97100"},"FR-GY":{countryCode:"FR",zipCode:"97300"},"FR-MC":{countryCode:"FR",zipCode:"98000"},"FR-MQ":{countryCode:"FR",zipCode:"97200"},"FR-NC":{countryCode:"FR",zipCode:"98800"},"FR-PF":{countryCode:"FR",zipCode:"98700"},"FR-RE":{countryCode:"FR",zipCode:"97400"},"FR-SB":{countryCode:"FR",
zipCode:"97133"},"FR-SM":{countryCode:"FR",zipCode:"97150"},"FR-SP":{countryCode:"FR",zipCode:"97500"},"FR-WF":{countryCode:"FR",zipCode:"98611"},"FR-YT":{countryCode:"FR",zipCode:"97600"},"IT-ML":{countryCode:"IT",zipCode:"20125"},"IT-II":{countryCode:"IT",zipCode:"09121"},"ES-ML":{countryCode:"ES",zipCode:"28004"},"ES-BI":{countryCode:"ES",zipCode:"07003"},"ES-CI":{countryCode:"ES",zipCode:"35005"},"BR-SP":{countryCode:"BR",zipCode:"01319900"}};return{getRegions:function(){return e},mapLocationDataToRegionCode:function(c){return h(c)},
mapRegionCodeToLocationData:function(c){c=e.hasOwnProperty(c)?a.extend({},{addressLabel:f[c],countryCode:e[c].countryCode,zipCode:e[c].zipCode,state:e[c].state,city:e[c].city,locationType:i.locationTypes.region}):null;return c}}});k.when("A","jQuery","ready").register("LUXRegionConfig",function(){var d=[],a="AE,AR,AT,AU,BE,BG,BH,BM,BR,CA,CH,CL,CN,CO,CR,CY,CZ,DE,DK,EC,EE,EG,ES,FI,FR,GB,GP,GR,HK,HU,ID,IE,IL,IN,IS,IT,JO,JP,KE,KR,KW,KZ,LI,LT,LU,LV,MC,MO,MT,MX,MY,NG,NL,NO,NZ,OM,PA,PE,PH,PL,PT,QA,RO,RS,RU,SA,SE,SG,SI,SK,TH,TR,TT,TW,US,UY,VE,ZA".split(","),
i=/^\d{5}([ \-]\d{4})?$/,f=/^[ \t]*([AFD](\.?)([ \t]?)P(\.?)([ \t]?)O(\.?)[ \t]*[A-Z]{2}[ \t]*[0-9]{5}([ \-][0-9]{4})?)[ \t]*$/;return{getPrimarySelections:function(){return d},getSecondarySelections:function(){return a},getZipCodePattern:function(){return i},getMilitaryZipCodePattern:function(){return f},preprocessZipCode:function(a){return a.toUpperCase().trim().substring(0,5)}}});k.declare("RegionNames",{"GB-ML":"UK - Mainland","GB-BF":"UK - BFPO","GB-JE":"UK - Channel Islands","GB-IS":"UK - Islands",
"GB-NI":"UK - Northern Ireland","GB-HI":"UK - Scottish Highlands","DE-ML":"Germany - Mainland","DE-GI":"German Islands","FR-ML":"France - Mainland","FR-CH":"Corsica","FR-GP":"Guadeloupe","FR-GY":"Guyane","FR-MC":"Monaco","FR-MQ":"Martinique","FR-NC":"New Caledonia","FR-PF":"French Polynesia","FR-RE":"Reunion","FR-SB":"Saint Barthlemy","FR-SM":"Saint Martin","FR-SP":"Saint Pierre and Miquelon","FR-WF":"Wallis and Futuna Islands","FR-YT":"Mayotte","IT-ML":"Italy - Mainland","IT-II":"Italian Islands",
"ES-ML":"Spain - Mainland","ES-BI":"Spain - Balearic Islands","ES-CI":"Spain - Canary Islands, Ceuta and Melilla","BR-SP":"Brazil"});k.declare("CountryNames",{AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AN:"Netherlands Antilles",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"Aland Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",
BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barthelemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia",BQ:"Bonaire, Saint Eustatius and Saba",BR:"Brazil",BS:"Bahamas, The",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Congo, The Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"Cote D'ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",
CO:"Colombia",CR:"Costa Rica",CS:"Serbia and Montenegro",CU:"Cuba",CV:"Cape Verde",CW:"Curaao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",
GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia, The",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and the McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",
IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",
ME:"Montenegro",MF:"Saint Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, The Former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",
OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestinian Territories",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"Reunion",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",
SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syria",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",
US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Kosovo",YE:"Yemen",YT:"Mayotte",YU:"Yugoslavia",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"});k.when("A","jQuery","LUXController","LUXRegionData","LUXRegionConfig","LUXContext","CountryNames","RegionNames").register("LUXUtils",function(d,a,i,f,h,e,c,l){function g(b){return!d.objectIsEmpty(b)&&
b.countryCode&&c.hasOwnProperty(b.countryCode)?d.equals(b.locationType,i.locationTypes.country)?b.countryCode:d.equals(b.locationType,i.locationTypes.region)?f.mapLocationDataToRegionCode(b):f.mapLocationDataToRegionCode(b)||b.countryCode:null}function o(b){return c.hasOwnProperty(b)?c[b]:l.hasOwnProperty(b)?l[b]:null}function j(b){var c={};if(!d.objectIsEmpty(b))for(var a=b.length,j=0;j<a;j++)c[o(b[j])]=b[j];return c}return{getNameForCode:function(b){return o(b)},mapCodeToLocationData:function(b){b=
b?c.hasOwnProperty(b)?{countryCode:b,locationType:i.locationTypes.country}:f.mapRegionCodeToLocationData(b):null;return b},mapLocationDataToCode:function(b){return g(b)},generateLocationLabel:function(b){var c="";return c=b.addressLabel?b.addressLabel:b.locationType!==i.locationTypes.region&&b.locationType!==i.locationTypes.country&&(b.city||b.state)&&b.zipCode?(b.city?b.city+", ":"")+(b.state?b.state+" ":"")+b.zipCode:o(g(b))},prepareCountrySelectionGeneratorInput:function(){return{deviceType:e.deviceType,
primarySelections:JSON.stringify(j(h.getPrimarySelections())),primarySelectionsOrder:JSON.stringify(h.getPrimarySelections()),secondarySelections:JSON.stringify(j(h.getSecondarySelections()))}},validateZipCode:function(b){return!d.objectIsEmpty(b)&&h.getZipCodePattern().test(b.toUpperCase())},preprocessZipCode:function(b){return h.preprocessZipCode(b)},isMilitaryZipCode:function(b){return!d.objectIsEmpty(b)&&h.getMilitaryZipCodePattern().test(b.toUpperCase())}}});k.when("A","jQuery","LUXContext",
"ready").register("LUXMetrics",function(d,a,i){function f(a,d){m.ueLogError&&a&&m.ueLogError({message:a},{logLevel:d||"ERROR",attribution:c})}function h(c){m.ue?m.ue.count(c,(m.ue.count(c)||0)+1):f("Failed to increment metrics counter: "+c+" because window.ue is not present.","ERROR")}function e(){var c;if(c=m.ue_pty)a:{c=m.ue_pty;for(var a in l)if(l.hasOwnProperty(a)&&d.indexOfArray(l[a],c)!==-1){c=!0;break a}c=!1}return c?m.ue_pty:"unrecognizedPage"}var c="LocationUX",l={detail:["Detail","DetailAW",
"DetailWebView","TabletUDP"],search:["Search","SearchAW"],offerListing:["OfferListing","OfferListingAW","OfferListingMobileAppAW"]},g={click:{signIn:"click.signIn",seeMore:"click.seeMore",manageAddressBook:"click.manageAddressBook"},view:{page:"view.page",addressSelector:"view.addressSelector",countrySelector:"view.countrySelector"},selection:"selection",override:"override"};return{getPageType:function(){return e()},getEvents:function(){return g},logLocationChange:function(a){k.when("LUXController").execute(function(j){var b=
e(),f=c+"."+b;f+=d.equals(a,j.locationTypes.locationInput)||d.equals(a,j.locationTypes.realmDefault)||d.equals(a,j.locationTypes.ip2location)?"."+g.override+"."+a:"."+g.selection+"."+a;!d.equals(a,j.locationTypes.defaultAddress)&&!d.equals(a,j.locationTypes.accountAddress)&&!d.equals(a,j.locationTypes.lockerAddress)&&(f+="."+(i.isRecognizedCustomer?"recognized":"unrecognized"));d.indexOfArray(l.detail,b)!==-1&&i.isRecognizedCustomer&&(f+="."+(i.isOneClick?"1Click":"Non1Click"));h(f)})},logPageView:function(a){k.when("LUXController").execute(function(j){var b=
e(),f=c+"."+b+"."+g.view.page+"."+a;!d.equals(a,j.locationTypes.defaultAddress)&&!d.equals(a,j.locationTypes.accountAddress)&&!d.equals(a,j.locationTypes.lockerAddress)&&(f+="."+(i.isRecognizedCustomer?"recognized":"unrecognized"));d.indexOfArray(l.detail,b)!==-1&&i.isRecognizedCustomer&&(f+="."+(i.isOneClick?"1Click":"Non1Click"));h(f)})},logWidgetView:function(a){var j=e(),a=c+"."+j+"."+a+"."+(i.isRecognizedCustomer?"recognized":"unrecognized");d.indexOfArray(l.detail,j)!==-1&&i.isRecognizedCustomer&&
(a+="."+(i.isOneClick?"1Click":"Non1Click"));h(a)},logEvent:function(a){a=c+"."+e()+"."+a;h(a)},logError:function(c,a){f(c,a)}}})})})(function(){var k=window.AmazonUIPageJS||window.P,m=k._namespace||k.attributeErrors;return m?m("DeliveryStatic"):k}(),window);
/* ******** */
(function(a){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("CashOnDeliveryAssets"):a}(),window);
/* ******** */
(function(h,j,t){h.execute(function(){h.when("jQuery","ready").execute(function(a){a("body").delegate(".askInlineWidget .cdShowLess, .askInlineWidget .cdReadMore","click touchstart",function(b){b.preventDefault();a(b.target).parents(".cdJSEnabledText").toggleClass("askShowMore")})});h.when("jQuery","load").execute(function(a){var b=a(".askSubHeader");b.length>0&&!j.pageYOffset&&a("html, body").animate({scrollTop:b.offset().top},0)});h.when("jQuery","ready").execute(function(a){function b(){return a(j).scrollTop()+
e>=a(document).height()-a(j).height()}function i(){b()&&c()}function g(){a("body").hasClass("allAnswersScrolling")?a(document).scroll(i):(a(".loadMoreAnswersMobile").show(),a(".loadMoreAnswersMobile").bind("touchstart click",c))}function c(){var e=a(".answersLoadingSpinner"),h=a(".loadMoreAnswersMobile"),j=a.trim(a(".askPage input[name=askQuestion]").val()),k=a.trim(a(".askPage input[name=askSort]").val()),o=a(".askPage input[name=askLanguage]").val(),j="/ask/answers/inline/"+j+"/"+d+"?pageSize="+
m+"&sort="+k+"&language="+o;e.show();h.hide();a(".askMobileFailedToFetchMoreAnswers").hide();a(document).unbind("scroll",i);h.unbind("touchstart click",c);a.ajax({url:j,data:{},dataType:"html",cache:!1,timeout:q,success:function(i){e.hide();a(".askPage .answerBox > .a-box-inner").append(i);f&&(b()?c():f=!1);a.trim(a("input[name=moreAnswersAfterPage"+d+"]").val())==="true"?g():a(".loadMoreAnswersMobile").hide();a(document).trigger("ajax:success");d+=1},error:function(){e.hide();a(".askMobileFailedToFetchMoreAnswers").show();
g()}})}var f=!0,e=5,d=3,m=6,q=2E3;a("body").hasClass("allAnswersScrolling")&&(b()?c():f=!1,a(document).scroll(i));a(".loadMoreAnswersMobile").bind("touchstart click",c)});h.when("jQuery","ready").execute(function(a){var b=!0;a("body").delegate(".askQuestionForm","submit",function(c){var c=a(c.currentTarget),f=c.find("[name='askQuestionText'], [name='bodyText']"),e=f.val(),f=f.attr("placeholder");if(typeof e==="undefined"||e.match(/^\s*$/)||e===f)return c.attr("class","askQuestionForm hasEmptyQuestion"),
!1;if(b)return b=!1,g(c,e,i),!1;c.attr("class","askQuestionForm");return!0});var i=function(a,b){b?a.trigger("submit"):a.attr("class","askQuestionForm hasBadQuestion")},g=function(b,f,e){f.indexOf("?")>=0?e(b,!0):a.ajax({url:"/gp/customer-forum/dynamic-update/validate-post.html",dataType:"json",data:{body:f,checkIsQuestion:1},success:function(a){e(b,a.hasError||a.content.isQuestion);b.trigger("ajax:success")},error:function(){e(b,!0);b.trigger("ajax:error")}})}});h.when("jQuery","ready").register("askPostQuestionValidation",
function(a){function b(b){var d=a(b.currentTarget),h=f.val(),j=f.attr("placeholder");a(".askError").hide();if(typeof h==="undefined"||h.match(/^\s*$/)||h===j)return e.show(),b.stopImmediatePropagation(),d.trigger("askValidationComplete"),!1;return c?(c=!1,g(d,h,i),b.stopImmediatePropagation(),d.trigger("askValidationComplete"),!1):!0}function i(a,b){b?a.trigger("submit"):d.show()}function g(b,d,c){d.indexOf("?")>=0?c(b,!0):a.ajax({url:"/gp/customer-forum/dynamic-update/validate-post.html",dataType:"json",
data:{body:d,checkIsQuestion:1},success:function(a){c(b,a.hasError||a.content.isQuestion);b.trigger("askValidationComplete")},error:function(){c(b,!0);b.trigger("askValidationComplete")}})}var c=!0,f,e=a(".askEmptyQuestionError"),d=a(".askBadQuestionError");return{setup:function(a,d,c){f=c;a.delegate(d,"submit",b)}}});h.when("jQuery","ready").execute(function(a){function b(b){var c="/ask/questions/inline/"+a.trim(a(".askWidgetQuestions input.askAsin").val())+"/"+b;a.ajax({url:c,data:{},dataType:"html",
cache:!1,timeout:i,success:function(c){a(".askInlineWidget .askFailedToFetchMoreQuestions").hide();a(".askInlineWidget .askLoadMoreQuestions").hide();a(".askInlineWidget .askMoreQandAResults").append(c);a(".askInlineWidget .askTopQandALoadMoreQuestions").hide();c=b+1;a(".askWidgetQuestions input.nextPage").val(c);var c=document.getElementById("askInlineQuestionsPage-"+b),e;if(e=typeof c!=="undefined")if(e=c!==null)e=c.getBoundingClientRect(),e=!(e.top>=0&&e.left>=0&&e.bottom<=(j.innerHeight||a(j).height())&&
e.right<=(j.innerWidth||a(j).width()));if(e){e=0;do e+=c.offsetTop||0,c=c.offsetParent;while(c);c=e;a("html, body").animate({scrollTop:c},"slow")}},error:function(){a(".askInlineWidget .askFailedToFetchMoreQuestions").show()}})}var i=5E3;a("body").delegate(".askInlineWidget .askSeeMoreQuestionsLink","click",function(a){b(2);a.preventDefault()});a("body").delegate(".askInlineWidget .askLoadMoreQuestionsLink","click",function(g){var c=parseInt(a(".askWidgetQuestions input.nextPage").val(),10)||0;c>
0&&(b(c),g.preventDefault())})});h.when("jQuery","ready").execute(function(a){function b(b){var b=document.getElementById(b),c;if(c=typeof b!=="undefined")if(c=b!==null)c=b.getBoundingClientRect(),c=!(c.top>=0&&c.left>=0&&c.bottom<=(j.innerHeight||a(j).height())&&c.right<=(j.innerWidth||a(j).width()));if(c){c=0;do c+=b.offsetTop||0,b=b.offsetParent;while(b);b=c;a("html, body").animate({scrollTop:b},"slow")}}function i(){var b=a(".askQuestionForm input.askAsin").val();return!b||0===b.length?"":"?asin="+
b}function g(d,f){if(d){var g=i();a.ajax({url:"/ask/answers/inline/"+d+"/"+f+g,data:{},dataType:"html",cache:!1,timeout:e,success:function(e){a(".askInlineWidget #failed-to-fetch-answers-"+d).hide();a(".askInlineWidget #askSeeAllAnswersLink-"+d).hide();a(".askInlineWidget .askCollapseAnswers-"+d).show();a(".askInlineWidget .askLoadMoreAnswersLink-"+d).hide();a(".askInlineWidget #"+d).show();a(".askInlineWidget #"+d).append(e);c(d,f);b("askInlineAnswersPage-"+d+"-"+f)},error:function(){a(".askInlineWidget #failed-to-fetch-answers-"+
d).show()}})}}function c(b,c){a(".askWidgetQuestions input.currentAnswersPage-"+b).val(c)}function f(d){b("question-"+d);setTimeout(function(){a(".askInlineWidget #"+d).empty();a(".askInlineWidget .askCollapseAnswers-"+d).hide();a(".askInlineWidget #failed-to-fetch-answers-"+d).hide();a(".askInlineWidget #askSeeAllAnswersLink-"+d).show()},500);c(d,1)}var e=5E3;a("body").delegate(".askInlineWidget .askWidgetSeeAllAnswersInline","click",function(b){var c=a(b.currentTarget).attr("data-questionId");g(c,
1);b.preventDefault()});a("body").delegate(".askInlineWidget .askWidgetLoadMoreAnswersInline","click",function(b){var c=a(b.currentTarget).attr("data-questionId"),f=parseInt(a(".askWidgetQuestions input.currentAnswersPage-"+c).val(),10)||0;f>0&&(g(c,f+1),b.preventDefault())});a("body").delegate("input[name='collapse-to-most-helpful-answer']","click",function(b){b=a(b.currentTarget).attr("data-questionId");f(b)})});h.when("jQuery","ready").register("askAuthenticatedAjax",function(a){return{handler:function(b,
i){var g=a(b.currentTarget),c=g.attr("action"),f=g.attr("method"),e=g.serializeArray(),d=g.attr("type"),c={url:c,type:f,data:e,dataType:d,timeout:i,beforeSend:function(b,c){c.dataType===t&&b.setRequestHeader("Accept","*/*;q=0.5, "+c.accepts.script);b.setRequestHeader("X-Requested-With","XMLHttpRequest");var d=a.Event("ajax:beforeSend");g.trigger(d,[b,c]);if(!1!==d.result)g.trigger("ajax:send",b);else return!1},success:function(a,b,c){g.trigger("ajax:success",[a,b,c])},complete:function(a,b){g.trigger("ajax:complete",
[a,b])},error:function(a,b,c){g.trigger("ajax:error",[a,b,c])}};if(!("withCredentials"in new XMLHttpRequest))return!0;c.xhrFields={withCredentials:!0};b.preventDefault();a.ajax(c)}}});h.when("jQuery","ready").register("askLiveSearch",function(a){function b(){var b=l.val(),g=a.trim(b);clearTimeout(e);g!==d&&(j===null&&(j=u(),a(".askLiveSearchSessionId").val(j)),g.length===0?(s(),f&&f.abort(),j=d=null):b.match(/\w\W+$/)?i(g):e=setTimeout(function(){i(g)},c))}function i(b){k();clearTimeout(e);f=a.ajax("/ask/livesearch/search",
{type:"GET",data:{query:b,asin:m,forumId:h,liveSearchSessionId:j,language:r}}).done(o).fail(p);d=b}function g(a){return typeof a!=="function"?function(){}:a}var c=500,f,e,d,m,h,j=null,r,l,k,o,s,p,u=function(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}();return{setup:function(c,d,f){l=c.find(d);var e=l.closest("form");m=a.trim(e.children("input.askAsin").val());h=a.trim(e.children("input.askForumId").val());
r=a.trim(e.children("input[name=language]").val());k=g(f.liveSearchStartCallback);o=g(f.liveSearchDoneCallback);s=g(f.liveSearchClearCallback);p=g(f.liveSearchFailCallback);c.delegate(d,"keyup input",b)}}});h.when("jQuery","ready").register("askExpander",function(a){return{setup:function(b){b.delegate(".askExpanderContainer .askSeeMore","click",function(b){a(b.currentTarget).closest(".askExpanderContainer").addClass("askExpanderExpanded");b.preventDefault()});b.delegate(".askExpanderContainer .askSeeLess",
"click",function(b){a(b.currentTarget).parents(".askExpanderContainer").removeClass("askExpanderExpanded");b.preventDefault()})}}});h.when("jQuery","ready").register("askMobileAllQuestionsPageInfiniteScroll",function(a){function b(){return a(j).scrollTop()+m>=a(document).height()-a(j).height()}function i(){b()&&f()}function g(){e==="true"&&(a("body").hasClass("allQuestionsScrolling")?a(document).scroll(i):(k.show(),k.bind("touchstart click",f)))}function c(){k.hide();a(document).unbind("scroll",i);
k.unbind("touchstart click",f)}function f(){var i=a.trim(a(".askPage input[name=askAsin]").val()),m=a.trim(a(".askPage input[name=askSort]").val()),j=a.trim(a(".askPage input[name=askLanguage]").val()),i="/ask/questions/inline/"+i+"/"+h+"?pageSize="+n+"&sort="+m+"&language="+j;l.show();c();a(".askMobileFailedToFetchMoreQuestions").hide();a.ajax({url:i,data:{},dataType:"html",cache:!1,timeout:r,success:function(c){l.hide();a(".askPage .questionBox > .a-box-inner").append(c);d&&(b()?f():d=!1);e=a.trim(a("input[name=moreQuestionsAfterPage"+
h+"]").val());g();e!=="true"&&k.hide();a(document).trigger("ajax:success");h+=1},error:function(){l.hide();a(".askMobileFailedToFetchMoreQuestions").show();g()}})}var e="true",d=!0,m=5,h=3,n=6,r=2E3,l,k;return{setup:function(){l=a(".questionsLoadingSpinner");k=a(".loadMoreQuestionsMobile");a("body").hasClass("allQuestionsScrolling")&&(b()?f():d=!1,a(document).scroll(i));k.bind("touchstart click",f)},detachHandlers:c,reattachHandlers:g}});h.when("jQuery","askAuthenticatedAjax","ready").register("askInlinePostQuestion",
function(a,b){function i(){h.delegate(".askMobilePostQuestionForm","submit",g);h.delegate(".askMobilePostQuestionForm","ajax:beforeSend",function(){a(".askError").hide()});h.delegate(".askMobilePostQuestionForm","ajax:send",c);h.delegate(".askMobilePostQuestionForm","ajax:error",function(b,c,d){d==="timeout"?a(".askMobileGenericPostQuestionError").show():401===c.status||466===c.status?(h.undelegate(".askMobilePostQuestionForm","submit",g),a(b.currentTarget).trigger("submit"),h.delegate(".askMobilePostQuestionForm",
"submit",g)):a(".askMobilePostQuestionError").html(c.responseText).show();f()});h.delegate(".askMobilePostQuestionForm","ajax:success",function(b,c){r.val("");r.trigger("keyup");f();a(".questionPostResponseContainer").html(c).slideDown()})}function g(a){b.handler(a,m)}function c(){var b=r.val();a("#askQuestionTextDisabledInput").val(b);a("#askQuestionTextInputWrapper").hide();a("#askQuestionTextDisabledInputWrapper").show();a("#askSubmitQuestion").hide();a(".askPostQuestionLoadingSpinner").show()}
function f(){a("#askQuestionTextInputWrapper").show();a("#askQuestionTextDisabledInputWrapper").hide();a("#askSubmitQuestion").show();a(".askPostQuestionLoadingSpinner").hide()}function e(b){j.delegate(l,"focus",function(){var c=a("html,body").scrollTop(),c=b.offset().top+c;a("html,body").animate({scrollTop:c})})}function d(){h.delegate(l,"keypress",function(a){(a.keyCode||a.which)===13&&a.preventDefault()})}var m=1E4,h=a(".askPage"),j=a(".askMobilePostQuestionForm"),r=a("#askQuestionTextInput"),
l="#askQuestionTextInput";return{setup:function(){i();e(a(".askWidgetHeader"));d()}}});h.when("A","jQuery","askAuthenticatedAjax","a-modal","ready").register("askInlinePostQuestionResponse",function(a,b,i,g){function c(){m(b(".modalDeleteFormContainer"),".askMobileDeleteQuestionForm",j,d)}function f(){var a=b(".modalDeleteFormContainer"),c=j,f=d;a.undelegate(".askMobileDeleteQuestionForm","submit",i.handler);a.undelegate(".askMobileDeleteQuestionForm","ajax:beforeSend",s);a.undelegate(".askMobileDeleteQuestionForm",
"ajax:error",f);a.undelegate(".askMobileDeleteQuestionForm","ajax:success",c)}function e(a,b){k(a,b,p,".askMobileEditQuestionForm")}function d(a,c){k(a,c,b(".modalDeleteFormContainer"),".askMobileDeleteQuestionForm")}function m(a,b,c,d){a.delegate(b,"submit",i.handler);a.delegate(b,"ajax:beforeSend",s);a.delegate(b,"ajax:error",d);a.delegate(b,"ajax:success",c)}function h(a){s();b(".askMobilePostQuestionForm").hide();b(".askEditFormContainer").show();b(".successfulQuestionContainer").hide();var c=
b(".inlineQuestionContent").text().trim();b(".askMobileEditQuestionForm").find("[name='askQuestionText']").val(c).focus();a.preventDefault()}function j(){o();p.slideUp().text("")}function r(a,c){l(a);b(".inlineQuestionContent").html(c)}function l(a){s();o();b(".askMobilePostQuestionForm").show();b(".askEditFormContainer").hide();b(".successfulQuestionContainer").show();a.preventDefault()}function k(a,c,d,f){c.status===401||c.status===466?(d.undelegate(f,"submit",i.handler),b(a.currentTarget).submit()):
(o(),b(".askInlineError").html(c.responseText).show())}function o(){g.get(b("#askDeleteModalPopover")).hide()}function s(){b(".askInlineError").hide();b(".askMobilePostQuestionError").hide();b(".askMobileGenericPostQuestionError").hide()}var p=b(".questionPostResponseContainer");return{setup:function(){p.delegate(".askOpenInlineEditForm","click",h);p.delegate(".askCancelInlineEdit","click",l);m(p,".askMobileEditQuestionForm",r,e);a.on("a:popover:beforeShow:deleteModalPopup",c);a.on("a:popover:beforeHide:deleteModalPopup",
f)}}});h.when("A","jQuery","ready").register("askMobileLiveSearch",function(a,b){return{displayResults:function(a){b.trim(a)?b(".askLiveSearchResults").html(a):(b(".askLiveSearchResults").empty(),b(".askNoResultsError").show())},showLiveSearchSuccess:function(){b(".askMobilePostQuestionButtonContainer").show();b(".askLiveSearchSuccessfulMessage").show();b(".askLiveSearchFailureMessage").hide()},showLiveSearchFailure:function(){b(".askMobilePostQuestionButtonContainer").show();b(".askLiveSearchSuccessfulMessage").hide();
b(".askLiveSearchFailureMessage").show()},setupExpander:function(){a.on("a:expander:askMobileLiveSearchResultExpander:toggle:expand",function(a){a=a.expander.$expander;a.find(".askMobileLiveSearchResultHeaderTextExpanded").css("display","block");a.find(".askMobileLiveSearchResultHeaderTextCollapsed").hide()});a.on("a:expander:askMobileLiveSearchResultExpander:toggle:collapse",function(a){a=a.expander.$expander;a.find(".askMobileLiveSearchResultHeaderTextExpanded").hide();a.find(".askMobileLiveSearchResultHeaderTextCollapsed").css("display",
"block")})}}});h.when("jQuery","askInlinePostQuestion","askInlinePostQuestionResponse","askLiveSearch","askMobileLiveSearch","askMobileAllQuestionsPageInfiniteScroll","askPostQuestionValidation","ready").register("askMobileAllQuestionsPage",function(a,b,i,g,c,f,e){var d={liveSearchDoneCallback:function(b){a(".askError").hide();a(".questionsBoxGroup").hide();f.detachHandlers();c.showLiveSearchSuccess();a(".questionPostResponseContainer").hide();c.displayResults(b)},liveSearchClearCallback:function(){a(".askError").hide();
a(".askLiveSearchResults").empty();a(".askMobilePostQuestionButtonContainer").hide();a(".questionsBoxGroup").show();f.reattachHandlers()},liveSearchFailCallback:function(){a(".askError").hide();a(".askLiveSearchResults").empty();a(".questionsBoxGroup").show();f.reattachHandlers();c.showLiveSearchFailure()}};return{setup:function(){var m=a(".askMobileAllQuestionsPage");a(".loadMoreQuestionsMobile");e.setup(m,".askMobilePostQuestionForm",a("#askQuestionTextInput"));b.setup();i.setup();g.setup(m,"#askQuestionTextInput",
d);f.setup();c.setupExpander()}}});h.when("jQuery","askExpander","ready").register("askMobileAllAnswersPage",function(a,b){return{setup:function(){b.setup(a(".answerBox"))}}});h.when("jQuery","askInlinePostQuestion","askInlinePostQuestionResponse","askLiveSearch","askMobileLiveSearch","askPostQuestionValidation","ready").register("askMobileDetailPageWidget",function(a,b,i,g,c,f){var e={liveSearchDoneCallback:function(b){a(".askError").hide();a(".questionsBoxGroup").hide();a(".questionPostResponseContainer").hide();
c.showLiveSearchSuccess();c.displayResults(b);a("#askQuestionTextInput").trigger("askLiveSearchComplete")},liveSearchClearCallback:function(){a(".askError").hide();a(".askLiveSearchResults").empty();a(".askMobilePostQuestionButtonContainer").hide();a(".questionsBoxGroup").show()},liveSearchFailCallback:function(){a(".askError").hide();a(".askLiveSearchResults").empty();a(".questionsBoxGroup").show();c.showLiveSearchFailure()}};return{setup:function(){var d=a(".askMobileDetailPageWidget");f.setup(d,
".askMobilePostQuestionForm",a("#askQuestionTextInput"));b.setup();i.setup();g.setup(d,"#askQuestionTextInput",e);c.setupExpander()}}})})})(function(){var h=window.AmazonUIPageJS||window.P,j=h._namespace||h.attributeErrors;return j?j("AskAuiAssets"):h}(),window);
/* ******** */
(function(c){c.execute(function(){})})(function(){var c=window.AmazonUIPageJS||window.P,f=c._namespace||c.attributeErrors;return f?f("BurjMobileAssets"):c}(),window);
/* ******** */
(function(a){a.execute(function(){a.when("jQuery").register("action-panel",function(c){var a="ap-onetime,ap-sns,ap-deal,ap-mom,ap-fresh,ap-oos,ap-b2brd".split(",");return{setPanelState:function(b){if(b.mode){for(var e=c("#actionPanel"),d=0;d<a.length;d++)e.removeClass(a[d]);b="ap-"+b.mode;c.inArray(b,a)>=0&&e.addClass(b)}}}});a.when("jQuery","action-panel").register("toggleBB",function(a,f){return{init:function(){a('input[name="toggleBuyBox"]:radio').change(function(){var b=a(this).attr("value");
f.setPanelState({mode:b});b==="onetime"?a("#csffsFeaturecontainer").removeClass("a-hidden"):a("#csffsFeaturecontainer").addClass("a-hidden")})}}})})})(function(){var a=window.AmazonUIPageJS||window.P,c=a._namespace||a.attributeErrors;return c?c("ActionPanelAssets"):a}(),window);
/* ******** */
(function(d,b,e){d.execute(function(){d.when("A","jQuery","a-modal","afx-uatc-proxy","afx-update-cart-count","a-dropdown","fresh-dp-double-click","afx-csm-metrics-utils","fresh-show-atc-changeover","fresh-dp-quantity","afx-utils","ready").register("fresh-atc-handler",function(a,c,b,f,D,g,l,h,j,m,s){var k;d.when("EWC").execute("add-to-cart-refresh",function(a){k=a});d.when("nav.getFlyout").execute(function(a){a("ewc")});return{addToFreshCart:function(i){var g,t,u,n,o,y,v,p,F,z,w,A,G,H,E,B,C;function q(a,
c,d,b){I(a);i.error(a,c,d,b)}function I(l,f){var j=l.data.title,z=l.data.asin,i=l.data.offerListingID,m=l.data.sessionID,k=f!==e?f.itemStatusCode:e,D=f!==e?f.availableQuantity:e,L=f!==e?f.requestedQuantity:e;switch(k){case g:h.increment(o);break;case t:h.increment(y);break;case u:h.increment(v);break;case n:h.increment(p);break;default:h.increment(F),d.log("fresh-atc-handler: No error status code.","ERROR")}b.create(l.$currentTarget,{name:"fresh-add-to-cart-modal",sessionID:m,url:"/afx/cart/reservation_conflict?"+
c.param({reasonCode:k,title:j,asin:z,offerListingID:i,sessionID:m,quantityAdded:D,quantityRequested:L})}).show();a.on("a:popover:afterHide:fresh-add-to-cart-modal",function(a){J(m);b.remove(a.popover)})}function K(b,l,r){r||(r=function(){});try{var e=b.data.asin;if(e)if(b.data.title){var j=b.data.offerListingID;if(j){var p=b.data.sessionID;if(p){var i=m.val();i||(d.log('fresh-atc-handler: "quantity" action parameter is missing.',"ERROR"),i=1);h.setWidgetClickTimestamp(A);f({asin:e,offerListingID:j,
sessionID:p,quantity:i,reftag:"afx-dp-addtocart",success:function(f){try{if(h.sendWidgetMetrics(A),f&&f.isOK){var e=f.extraErrorInfos;if(e.constructor!==Array)h.increment(G);else if(e.length===0)h.increment(H),l(f,p,i);else for(f=0;f<e.length;f++){var j=b,g=e[f];if(g)if(g.statusCode==="ADDRESS_NOT_SELECTED"){h.increment(z);d.log("fresh-atc-handler: Address is not selected.","INFO");var m=c.param({asin:j.data.asin,offerListingID:j.data.offerListingID,quantity:1,redirectURL:document.location.href,ref:"afx_atfc_noaddress"});
document.location.href="/afx/nc/chooseaddress?"+m}else I(j,g)}}else h.increment(E),q(b,"","","No response or isOK is false in UATC")}catch(k){h.increment(B),d.log("fresh-atc-handler exception: "+k,"ERROR")}finally{a.delay(r,C)}},error:function(c,f,l){try{h.sendWidgetMetrics(A),h.increment(E),q(b,c,f,l)}catch(e){h.increment(B),d.log("fresh-atc-handler exception: "+e,"ERROR")}finally{a.delay(r,C)}}})}else d.log('fresh-atc-handler: Required "sessionID" action parameter is missing.',"ERROR"),h.increment(w),
q(b)}else d.log('fresh-atc-handler: Required "offerListingID" action parameter is missing.',"ERROR"),h.increment(w),q(b)}else d.log('fresh-atc-handler: Required "title" action parameter is missing.',"ERROR"),h.increment(w),q(b);else d.log('fresh-atc-handler: Required "asin" action parameter is missing.',"ERROR"),h.increment(w),q(b)}catch(g){h.increment(B),d.log("fresh-atc-handler exception: "+g,"ERROR"),a.delay(r,C)}}function M(b){var f={token:(a.state("baseWidgetState")||{}).csrfToken};c.ajax({url:"/afx/slotselection/cancel",
type:"POST",data:f,contentType:"application/json; charset=utf-8",success:function(){K(b,function(){location.reload()})},error:function(){d.log("Failed to clear reservation")}})}function J(a){k&&typeof k.refresh==="function"?k.refresh():D(a)}C=1E3;w="freshAddToCartMissingParameterCount";B="freshAddToCartExceptionCount";A="freshUATCCall";H="freshUATCSuccessCount";E="freshUATCFailureCount";G="freshUATCInvalidErrorResponseCount";z="freshUATCAddressNotSelectedErrorCount";y="freshUATCItemPartiallyAvailableErrorCount";
v="freshUATCItemPartiallyAvailableForReservationErrorCount";o="freshUATCItemNotAvailableErrorCount";p="freshUATCItemNotAvailableForReservationErrorCount";F="freshUATCEmptyItemStatusCodeErrorCount";g="ITEM_NOT_AVAILABLE";t="ITEM_PARTIALLY_AVAILABLE";u="ITEM_PARTIALLY_AVAILABLE_FOR_RESERVATION";n="ITEM_NOT_AVAILABLE_FOR_RESERVATION";var N=function(a,c,b){j(b);J(c);i.success(a)};a.declarative("fresh-clear-slot","click",function(a){M(a)});a.declarative("fresh-atc-handler","click",l(function(a,c){m.valid()?
(s.vibrate(),h.increment("freshAddToCartClickCount"),K(a,N,c)):c()}))}}});d.when("A","jQuery","a-button","fresh-show-atl-changeover","ready").register("FreshAddToShoppingList",function(a,c,b,f){function e(c){var b=(a.state("baseWidgetState")||{}).csrfToken;a.post("/afx/lists/json/shoppinglists/additem",{cache:!1,timeout:5E3,params:{asin:c.asin,listID:c.shoppingListID,token:b},success:function(a){c.addButtonInstance.enable();a.successful?(c.$modalParent.find("#"+c.cancelButtonID).click(),f()):a.errorCodes[0]===
1?c.$alreadyInMessage.removeClass("aok-hidden"):g(c)},error:function(){c.addButtonInstance.enable();g(c)}})}function g(a){a.$errorMessage.removeClass("aok-hidden");d.log("Failed to add asin "+a.asin+" to shopping list "+a.shoppingListID,"ERROR")}a.declarative("add-to-list","click",function(a){var c=a.$currentTarget.closest(".a-popover-wrapper");if(c.length<1)d.log("Could not find the element that parents this modal (it should contain class a-popover wrapper)","FATAL");else{var f=c.find("#"+a.data.addButtonID),
g;f.length<1?(d.log("Could not find the button that will add the item. This is required for preventing double clicks","ERROR"),g=!1):a.data.asin?g=!0:(d.log("ASIN was blank. Please supply the ASIN you wish to add to the list.","ERROR"),g=!1);g&&(f=b(f),f.isEnabled()&&(f.disable(),a={asin:a.data.asin,addButtonInstance:f,$modalParent:c,cancelButtonID:a.data.cancelButtonID,shoppingListID:c.find("#"+a.data.asin+"-afx-atl-dropdown").val(),$alreadyInMessage:c.find("#afx-atl-already-in"),$errorMessage:c.find("#afx-atl-service-error")},
a.$alreadyInMessage.addClass("aok-hidden"),a.$errorMessage.addClass("aok-hidden"),e(a)))}})});d.when("A","jQuery","a-dropdown").register("fresh-dp-quantity",function(a,c,b){var d=/^\d+$/;return function(){var e,g,l,h,j,m,s,k,i,x,t,u,n,o=function(){if(!e){g=c("#freshCartButton");j=b.getSelect("quantity");if(l=!!j){h=c("#quantitySelect");var a=j.getOptions().size();a&&(s=a-1)}k=c("#quantityText");if(m=k.length!==0)i=c("#quantityTextInput"),x=c("#quantityTextErrors > div"),t=c("#quantityFreeTextErrorMsgMin"),
u=c("#quantityFreeTextErrorMsgMax")}},y=function(){a.on("a:dropdown:selected:quantity",function(a){c(a.nativeItemNode).index()===s?(i.attr("validValue",n),i.val(n),k.show(),x.hide(),h.hide(),i.focus().select()):n=j.val()});var b=function(){var a=i.attr("validValue");a&&(j.val(a),j.val()===a?(n=a,h.show(),k.hide()):g.focus())},e=function(){var a=v(i.val());i.attr("validValue",a?a:"")};i.change(e);i.keyup(e);i.keypress(function(a){if(a.which===0||a.which===8||a.ctrlKey||a.altKey)return!0;if(d.test(String.fromCharCode(a.which)))return!0;
a.which===13&&(b(),g.click());return!1});i.blur(b)},v=function(){var a;a:{a=i.val();if(d.test(a)&&(a=parseInt(a,10),!isNaN(a)))break a;a=!1}x.hide();if(a===!1||a<=0)t.show();else if(a>=1E3)u.show();else return String(a);return!1};return{init:function(){e=!1;o();e=!0;if(m){k.hide().removeClass("aok-hidden");x.hide().removeClass("aok-hidden");var a=j.getOption(s),b=a.info()[0].text;a.update({value:"0",text:c.trim(b)+"+"});n=j.val();y()}},valid:function(){o();return m&&k.is(":visible")?v()!==!1:!0},
val:function(){o();return m&&k.is(":visible")?i.attr("validValue"):l?j.val():1}}}()});d.register("fresh-dp-constants",function(){return{actionPanelDataSelector:"#apos",actionPanelStateData:"apstate",actionPanelFreshState:"fresh",navFreshNodeId:"10329849011",mobileNavSearchFormSelector:'#nav-search-form, form[role="search"]'}});d.when("jQuery","fresh-dp-constants").register("fresh-dp-access-panel",function(a,c){var b=a(c.actionPanelDataSelector).data(c.actionPanelStateData);return{state:b,isFresh:c.actionPanelFreshState===
b}});d.when("A").register("afx-uatc-proxy",function(a){return function(c){var b="/gp/add-to-cart/json";c.reftag!==e&&(b+="/ref="+c.reftag);a.post(b,{timeout:5E3,params:{"session-id":c.sessionID,clientName:"SharedFreshHandler",nextPage:"cartitems",ASIN:c.asin,offerListingID:c.offerListingID,useUber:"1",source:"Fresh",ruleSet:"FreshGet",quantity:c.quantity},success:c.success,error:c.error})}});d.when("A").register("afx-get-cart-count",function(a){return function(c){a.get("/gp/api/cart/1.0/get-cart-count.json",
{timeout:5E3,params:{sessionID:c.sessionID,clientName:"sharedFreshHandler"},success:c.success,error:c.error})}});d.when("A").register("afx-dp-get-cart-item-count",function(){return function(a,c){if(c&&c.items){var b;for(b=0;b<c.items.length;++b){var d=c.items[b];if(d&&d.ASIN===a)return d.quantity}}}});d.register("afx-csm-metrics-utils",function(){return{setWidgetClickTimestamp:function(a){b.ue&&b.uet&&a&&b.uet("bb",a,{wb:1})},setWidgetTimestamp:function(a,c){b.ue&&b.uet&&a&&c&&b.uet(a,c,{wb:1})},
increment:function(a){b.ue&&b.ue.count&&a&&b.ue.count(a,(b.ue.count(a)||0)+1)},setCount:function(a,c){b.ue&&b.ue.count&&a&&c&&b.ue.count(a,c)},sendWidgetMetrics:function(a){b.ue&&b.uex&&a&&b.uex("ld",a,{wb:1})}}});d.when("A","jQuery","a-button","ready").register("fresh-dp-double-click",function(a){return function(c){var b={disabled:"true"},d={};return function(e){var g=a.state("fresh-atc-status");if(!g||!g.disabled)g&&a.state("fresh-atc-status",b),c(e,function(){(g=a.state("fresh-atc-status"))&&a.state.replace("fresh-atc-status",
d)})}}});d.register("afx-utils",function(){return{isFunction:function(a){return typeof a==="function"},isDefined:function(a){return typeof a!=="undefined"},vibrate:function(){return b.amazon&&b.amazon.cordova&&b.amazon.cordova.notification&&b.amazon.cordova.notification.vibrate&&b.amazon.cordova.notification.vibrate(50)}}})})})(function(){var d=window.AmazonUIPageJS||window.P,b=d._namespace||d.attributeErrors;return b?b("FreshDetailPageCommonAssets"):d}(),window);
/* ******** */
(function(d){d.execute(function(){d.when("A","afx-update-cart-count","prime-fresh-upsell","ready").register("fresh-dp-add-to-cart",function(b,e,a){return{init:function(c){d.when("fresh-atc-handler").execute(function(b){b.addToFreshCart({success:function(){a.handlePrimeFreshUpsell()},error:function(){d.log("Error adding to Cart on Fresh Detail Page","Error")}})});c&&e(c);b.$("#addToCart").submit(function(a){a.preventDefault()})}}});d.when("A","afx-utils","ready").register("fresh-show-atc-changeover",
function(b,d){var a=b.$,c=a("#afx-atc-changeover");return function(a){if(a&&c.length>0&&d.isFunction(c.find)){var f=b.state("fresh-atc-toast-text");if(f&&f.atcToastTextString&&(a=f.atcToastTextString.replace("FreshATCToastQuantity",a),(f=c.find(".a-changeover-inner"))&&d.isFunction(f.text)))f.text(a),d.isFunction(c.show)&&c.show()}}});d.when("A","afx-get-cart-count").register("afx-update-cart-count",function(b,e){return function(a){var b=function(a){d.when("nav.setCartCount").execute(function(b){b(a)});
d.when("aw-mash").execute(function(b){b.cart&&typeof b.cart.didUpdate==="function"&&b.cart.didUpdate({newCartQuantity:a})})};e({sessionID:a,success:function(e){e&&e.isOK&&e.total&&typeof e.total.numActiveItem!=="undefined"?b(e.total.numActiveItem):d.log("Failed to get cart count","Error",a)},error:function(){d.log("Failed to get cart count","Error",a)}})}});d.when("A","afx-utils","ready").register("fresh-show-atl-changeover",function(b,d){var a=b.$,c=a("#afx-atl-changeover");return function(){c.length>
0&&d.isFunction(c.show)&&c.show()}});d.when("A","ready").register("prime-fresh-upsell",function(b){var e=function(a){a.isOk||d.log("prime-fresh-upsell: prime fresh upsell call encountered error","ERROR")},a=function(){d.log("prime-fresh-upsell: prime fresh upsell call failed","ERROR")};return{handlePrimeFreshUpsell:function(){b.$("#primeFreshUpsellCheckbox").is(":checked")&&b.post("/afx/detailpage/primefreshupsell",{success:e,timeout:500,error:a})}}});d.when("jQuery").register("fresh-dp-availability",
function(b){return{init:function(){var d=b("#fresh-merchant-info a");d.replaceWith(d.text())}}});d.when("jQuery","fresh-dp-constants","fresh-dp-access-panel","ready").register("fresh-dp-s-fix-nav-properties-js",function(b,e,a){if(!d.fixingNavProperties&&a.isFresh)d.fixingNavProperties=!0,a=b("<input>").attr({type:"hidden",name:"n",value:e.navFreshNodeId}),b(e.mobileNavSearchFormSelector).append(a)})})})(function(){var d=window.AmazonUIPageJS||window.P,b=d._namespace||d.attributeErrors;return b?b("FreshDetailPageMobileAssets"):
d}(),window);
/* ******** */
(function(f,h){f.execute(function(){f.when("jQuery","a-button","ready").register("afx-rls-double-click",function(g,a){function b(b){b=b.$currentTarget.find(".a-button");if(b.length)return a(b)}return function(a){return function(d){var e=d.$currentTarget;if(!e.data("afx-event-disabled")){var m=b(d);if(!m||m.isEnabled())e.data("afx-event-disabled",!0),m&&m.disable(),a(d,function(){e.data("afx-event-disabled",!1);m&&m.enable()})}}}});f.when("A","jQuery","ready").execute(function(g,a){g.declarative("see-more-delivery-address",
"click",function(){a("#deliveryAddressListTable").find(".deliveryAddressEntry").removeClass("aok-hidden");a("#seeMoreLinkSection").addClass("aok-hidden");a("#moreAddressesSection").removeClass("aok-hidden")})});f.when("A","ready").register("afx-rls-page-state",function(g){function a(){return c("zip-modal-page-state",a)}function b(){return c("see-more-link-state",b)}function c(a,b){var c=g.state(a);if(!c&&!b.haveTriedAStateParse)b.haveTriedAStateParse=!0,g.state.parse(),c=g.state(a);return c}return{getZipModalPageState:a,
getAddressPageState:b}});f.when("A","jQuery","ready").execute(function(g,a){function b(){a("#rlsZipcodeTextbox").keypress(function(b){b.which===13&&a("#updateZipCodeButton").click()})}g.declarative("show-zipcode-text-input","click",function(){g.post("/afx/regionlocationselector/ajax/showZipcodeTextinput",{cache:!1,timeout:5E3,success:function(c){a("#rls-flyout-locationZipcodeSection").html(c);b()},error:function(){a(".rls-error-message").addClass("aok-hidden");a("#rlsShowZipInputMessage").removeClass("aok-hidden")}})});
g.declarative("show-zipcode-text-input-mobile","click",function(){a("#rls-flyout-locationZipcodeSection").addClass("aok-hidden");a("#rls-flyout-locationZipcodeSection-change").removeClass("aok-hidden")});b()});f.when("A","jQuery","ready").register("afx-rls-update-address",function(g,a){function b(a,b,e,d){g.post("/afx/regionlocationselector/ajax/updateAddress",{cache:!1,timeout:5E3,params:{addressId:a,regionId:b},success:function(){e()},error:function(){c();d&&d()}})}function c(){d();a("#rlsSetAddressErrorMessage").removeClass("aok-hidden")}
function d(){a(".rls-error-message").addClass("aok-hidden")}function e(){return a("#rls-flyout-changingReservationSection")}return{updateAddress:function(a,c,e){b(a.addressID,a.regionID,c,e)},getAddress:function(b){b=(b&&b.length?b.find("#deliveryAddressListTable"):a("#deliveryAddressListTable")).find(".deliveryAddressEntry").find("input:radio:checked").closest(".deliveryAddressEntry");return{addressID:b.data("address-id"),regionID:b.data("region-id")}},cancelReservationAndUpdateAddress:function(a,
e,d){g.post("/afx/slotselection/cancel",{cache:!1,timeout:5E3,params:{remainOrderSlotMapping:"1"},success:function(){b(a.addressID,a.regionID,e,d)},error:function(){c();d&&d()}})},hideChangingReservationSection:function(){e().addClass("aok-hidden")},showChangingReservationSection:function(){d();e().removeClass("aok-hidden")}}});f.when("A","jQuery","afx-rls-mobile-confirm","ready").register("afx-rls-update-zip",function(g,a,b){function c(a,b,c){g.post("/afx/regionlocationselector/ajax/updateZipcode",
{cache:!1,timeout:5E3,params:{zipcode:a},success:function(){b()},error:function(){i();c&&c()}})}function d(){return a("#rlsZipcodeTextbox").val()}function e(a,b){f(a,k,p,function(a){c(a,b)})}function f(a,b,c,e){g.post("/afx/regionlocationselector/ajax/validateZipCode",{cache:!1,timeout:5E3,params:{zipcode:a},success:function(c){c.count>0?e(a):b(a)},error:function(){c()}})}function i(){h();j(a("#rlsSetZipcodeErrorMessage"))}function n(c){l();a("#rlsEligibleZipCodeValue").text(c);a("#rlsZipcodeTextbox").removeClass("a-form-error");
j(a("#rlsEligibleZipInputMessage"));b.eligibleZipEntered()}function h(){l();a("#rlsZipcodeTextbox").addClass("a-form-error")}function k(c){h();a("#rlsIneligibleZipCodeValue").text(c);j(a("#rlsShowIneligibleZipInputMessage"));b.ineligibleZipEntered()}function p(){i();b.ineligibleZipEntered()}function j(a){a.removeClass("aok-hidden")}function l(){a(".rls-error-message").addClass("aok-hidden")}return{validateAndUpdateZip:function(a){var b=d();e(b,a)},validateZip:function(){var a=d();f(a,k,p,n)},updateZip:c,
getZip:d}});f.when("A","afx-rls-update-zip","ready").execute(function(g,a){function b(){document.location.reload(!0)}g.declarative("update-zipcode","click",function(){a.validateAndUpdateZip(b)});g.declarative("check-zipcode","click",function(){a.validateZip()})});f.when("A","jQuery","afx-rls-page-state","a-modal","ready").execute(function(g,a,b,c){function d(a){var b=RegExp(j.regex);return a!==""&&b.test(a)?!0:(f("invalid",j.invalidZipCodeText),!1)}function e(){a(".zip-message").hide()}function f(b,
c){if(b==="eligible")e(),a("#eligible-zip-message-text").html(c),a("#eligible-zip-message").show();else if(b==="ineligible"||b==="invalid")e(),a("#ineligible-zip-message-text").html(c),a("#ineligible-zip-message").show();var d=a("#continue-shop-button"),g=d.find(".a-button-text");b==="eligible"?(d.removeClass("a-button-disabled"),g.text(j.continueShoppingText),d.val("eligible")):b==="ineligible"&&(d.removeClass("a-button-disabled"),g.text(j.continueBrowsingText),d.val("ineligible"))}function i(a,
b){return a.replace(/{zipCode}/g,b)}function n(){var a=(g.state("baseWidgetState")||{}).csrfToken;g.post("/afx/nc/json/storecontinuebrowsinginsession",{cache:!1,timeout:5E3,params:{hasSelected:!0,token:a},success:function(){k()},error:function(){k()}})}function h(a){g.post("/afx/regionlocationselector/ajax/updateZipcode",{cache:!1,timeout:5E3,params:{zipcode:a},success:function(){k();document.location.reload(!0)},error:function(){f("ineligible","Failed to set the zipcode "+a)}})}function k(){l.unlock(11).hide()}
function p(){a("#zip-input").focus()}var j,l=c.get(a("#zip-code-modal"));l&&(l.show().lock(11),a(".a-popover-wrapper").addClass("invisible"));g.on("a:popover:ajaxContentLoaded:zipCodeModal",function(){j=b.getZipModalPageState();e();setTimeout(p,100);var c=a("#zip-modal-section");c.closest(".a-popover-inner").addClass("zip-modal-popover-inner");c.closest(".a-popover-wrapper").addClass("zip-modal-popover-wrapper");a(".a-popover-wrapper").removeClass("invisible")});g.declarative("zip-text-input-action",
"change keyup",function(){var b=a("#zip-input").val().trim();b.length<j.minInputLength?(a("#continue-shop-button").addClass("a-button-disabled"),e()):d(b)&&g.post("/afx/regionlocationselector/ajax/validateZipCode?ref=afx_rls_zip_"+b,{cache:!1,timeout:5E3,params:{zipcode:b},success:function(a){a.results.length>0?f("eligible",i(j.eligibleZipCodeText,b)):a.partialResults.length>0?f("ineligible",i(j.partiallyEligibleZipCodeText,b)):f("ineligible",i(j.ineligibleZipCodeText,b))},error:function(){f("ineligible",
i(j.failedZipCodeText))}})});g.declarative("set-zip-button-action","click",function(b){b.$currentTarget.find("#continue-shop-button").val()==="ineligible"?(n(),k()):(b=a("#zip-input").val().trim(),d(b)&&h(b))})});f.when("A","jQuery","afx-rls-update-address","afx-rls-page-state","ready").execute(function(f,a,b,c){function d(){document.location.reload(!0)}f.declarative("update-address","click",function(a){if(a.data.isCurrentAddress==="true")b.hideChangingReservationSection();else{var f=c.getAddressPageState();
f.reservationId&&!f.isOrderSlot?b.showChangingReservationSection():b.updateAddress(b.getAddress(a.$currentTarget.closest("#rls-flyout-main")),d)}});f.declarative("confirm-change-address","click",function(a){b.cancelReservationAndUpdateAddress(b.getAddress(a.$currentTarget.closest("#rls-flyout-main")),d)});f.declarative("cancel-change-address","click",function(){a("input[.deliveryAddressEntry]:radio","#deliveryAddressEntry0").attr("checked",!0);b.hideChangingReservationSection()})});f.when("A","jQuery",
"mash","ready").execute(function(f,a){if(a("#mobile-location-selector-page").length){var b=h.cordova&&h.cordova.require("cordova/exec"),c=document.URL,d=["amazonfresh","AmazonFresh","/s?i=amazonfresh",c],c=["amazonfresh","AmazonFresh","",c];typeof b==="function"&&(b(a.noop,a.noop,"MASHSearchScope","setSearchScope",d),b(a.noop,a.noop,"AFMSearchScopePlugin","setSearchScope",c))}});f.when("A","afx-rls-mobile-confirm","afx-rls-update-address","afx-rls-page-state","ready").execute(function(f,a,b,c){f.declarative("afx-rls-radio-button-selected",
"click",function(d){var e=d.$currentTarget.find("input:radio");e.is(":checked")||e.attr("checked","checked");e=e.closest(".deliveryAddressButton");e.hasClass("zip-radio-button")?a.zipRadioButtonClicked():e.hasClass("address-radio-button")&&(d=d.data.isCurrentAddress==="true",a.addressRadioButtonClicked(d),e=c.getAddressPageState(),e.reservationId&&!e.isOrderSlot&&(d?b.hideChangingReservationSection():b.showChangingReservationSection()))})});f.when("A","jQuery","a-button","ready").register("afx-rls-mobile-confirm",
function(f,a,b){function c(){var b=a("#zip-radio-button");return a("#rlsZipcodeTextbox").length>0&&b.length===0||b.find("input:radio").is(":checked")}function d(){var a=h();a&&a.enable()}function e(){var a=h();a&&a.disable()}function h(){var c=a("#rls-mobile-confirm-button"),d;c.length!==0&&(d=b(c));return d}var i=!1;return{addressRadioButtonClicked:function(a){a?e():d()},zipRadioButtonClicked:function(){i?d():e()},eligibleZipEntered:function(){i=!0;c()&&d()},ineligibleZipEntered:function(){i=!1;
c()&&e()},isZipRadioButtonChecked:c}});f.when("A","jQuery","afx-rls-update-zip","afx-rls-update-address","afx-rls-page-state","afx-rls-double-click","afx-rls-mobile-confirm","ready").execute(function(f,a,b,c,d,e,m){function i(){var a=d.getAddressPageState().encodedRedirectURL;a?h.location.href=decodeURIComponent(a):document.location.reload(!0)}f.declarative("afx-rls-mobile-confirm",e(function(a,e){m.isZipRadioButtonChecked()?b.updateZip(b.getZip(),i,e):d.getAddressPageState().reservationId?c.cancelReservationAndUpdateAddress(c.getAddress(),
i,e):c.updateAddress(c.getAddress(),i,e)}))})})})(function(){var f=window.AmazonUIPageJS||window.P,h=f._namespace||f.attributeErrors;return h?h("RegionLocationSelectorAssets"):f}(),window);
(function(f,h,g){f.execute(function(){f.when("A","jQuery","mash","fms-constants","ready").execute("ChangeSearchScope",function(a,b,c,d){var a=h.cordova&&h.cordova.require("cordova/exec"),e=document.URL,c=["amazonfresh","AmazonFresh","/s?i=amazonfresh",e],e=["amazonfresh","AmazonFresh","",e];b(d.SUBNAV_BAR_SELECTOR).length&&typeof a==="function"&&(a(b.noop,b.noop,"MASHSearchScope","setSearchScope",c),a(b.noop,b.noop,"AFMSearchScopePlugin","setSearchScope",e))});f.declare("fms-constants",{SUBNAV_BAR_SELECTOR:"#fms-bar",
INNER_SUBNAV_SELECTOR:"#innerSubnavDiv",LINK_FLYOUT_SELECTOR:"#fms-link-flyout",RHS_FLYOUT_SELECTOR:"#fms-rhs-flyout",VEIL_SELECTOR:"#fms-flyout-veil",SUBNAV_HEIGHT:40,SUBNAV_MARGIN:22});f.when("A","jQuery","fms-constants","ready").register("fms-library",function(a,b,c){function d(d,e){var e=e||b.noop,g=i(c.SUBNAV_BAR_SELECTOR),h=b(d).outerHeight();b(d).css({"max-height":g});f(g,h);a.slideDown(b(d),n,q,e)}function e(d,e){e=e||b.noop;b("body").removeClass("disable-scroll");b(c.VEIL_SELECTOR).unbind("touchmove");
b(c.INNER_SUBNAV_SELECTOR).unbind("touchmove");b(d).css({"max-height":""});a.slideUp(b(d),n,q,e)}function f(a,d){b("body").addClass("disable-scroll");var e=function(a){a.preventDefault();a.stopPropagation()};b(c.VEIL_SELECTOR).bind("touchmove",e);d<=a&&b(c.INNER_SUBNAV_SELECTOR).bind("touchmove",e)}function i(){var a=b(h).height(),d=b(h).scrollTop(),d=b(c.SUBNAV_BAR_SELECTOR).offset().top+b(c.SUBNAV_BAR_SELECTOR).outerHeight()-d;return a-d}var n=300,q="ease",k=function(){return a.isAnimated(b(c.LINK_FLYOUT_SELECTOR))||
a.isAnimated(b(c.RHS_FLYOUT_SELECTOR))},p=function(a){d(c.LINK_FLYOUT_SELECTOR,a)},j=function(a){d(c.RHS_FLYOUT_SELECTOR,a)},l=function(){a.fadeOut(b(c.VEIL_SELECTOR),n,"ease")},r=function(){b(c.VEIL_SELECTOR).css({top:b(c.SUBNAV_BAR_SELECTOR).offset().top+c.SUBNAV_HEIGHT-b(h).scrollTop()});a.fadeIn(b(c.VEIL_SELECTOR),n,"ease")},o=function(b){b={linkFlyoutOpen:b.linkFlyoutOpen,rhsFlyoutOpen:b.rhsFlyoutOpen};a.state("fmsState",b)};return{shouldNotStartHidingFlyouts:function(){return a.state("fmsState")===
g||!a.state("fmsState").linkFlyoutOpen&&!a.state("fmsState").rhsFlyoutOpen||k()},performAnimationsToHideFlyouts:function(){e(c.LINK_FLYOUT_SELECTOR,void 0);e(c.RHS_FLYOUT_SELECTOR,void 0);l();o({linkFlyoutOpen:!1,rhsFlyoutOpen:!1})},returnMaxFlyoutHeight:function(a){return i(a)},shouldNotToggleLinkFlyout:function(){return a.state("fmsState")===g||k()},toggleLinkFlyout:function(){a.state("fmsState").rhsFlyoutOpen?(e(c.RHS_FLYOUT_SELECTOR,p),o({linkFlyoutOpen:!0,rhsFlyoutOpen:!1})):a.state("fmsState").linkFlyoutOpen?
(e(c.LINK_FLYOUT_SELECTOR,void 0),l(),o({linkFlyoutOpen:!1,rhsFlyoutOpen:!1})):(p(),r(),o({linkFlyoutOpen:!0,rhsFlyoutOpen:!1}))},shouldNotToggleRhsFlyout:function(){return a.state("fmsState")===g||k()},toggleRhsFlyout:function(){a.state("fmsState").linkFlyoutOpen?(e(c.LINK_FLYOUT_SELECTOR,j),o({linkFlyoutOpen:!1,rhsFlyoutOpen:!0})):a.state("fmsState").rhsFlyoutOpen?(e(c.RHS_FLYOUT_SELECTOR,void 0),l(),o({linkFlyoutOpen:!1,rhsFlyoutOpen:!1})):(j(),r(),o({linkFlyoutOpen:!1,rhsFlyoutOpen:!0}))}}});
f.when("A","jQuery","fms-library","fms-constants","ready").register("fms-link-flyout-library",function(a,b,c,d){return{retrieveLinkFlyoutContents:function(){b(d.LINK_FLYOUT_SELECTOR).length&&a.get("/afx/mobilesubnav/linkflyout",{success:function(a){b(d.LINK_FLYOUT_SELECTOR).html(a)}})},toggleLinkFlyout:function(){c.shouldNotToggleLinkFlyout()||c.toggleLinkFlyout()}}});f.when("fms-link-flyout-library","ready").execute("fms-retrieve-link-flyout-content",function(a){a.retrieveLinkFlyoutContents()});
f.when("A","fms-link-flyout-library","ready").execute("fms-assign-link-flyout-declarative",function(a,b){a.declarative("open-fms-link-flyout","touchend",function(){b.toggleLinkFlyout()})});f.when("A","jQuery","fms-constants","ready").execute("fms-rhscontent",function(a,b,c){b(c.RHS_FLYOUT_SELECTOR).length&&a.get("/afx/mobilesubnav/rhs",{success:function(b){var e=a.$(c.RHS_FLYOUT_SELECTOR);e.length&&(e.html(b),b=e.children("a[href='/afx/m/regionlocationselector']"),e="/afx/m/regionlocationselector?redirectURL="+
encodeURIComponent(h.location.href),b.attr("href",e))}})});f.when("A","jQuery","fms-library","ready").execute("ClickFreshMobileRhsMenu",function(a,b,c){a.declarative("open-fms-rhs-flyout","touchend",function(){c.shouldNotToggleRhsFlyout()||c.toggleRhsFlyout()})});f.when("A","jQuery","fms-library","ready").execute("ClickFreshMobileSubnavVeil",function(a,b,c){a.declarative("fms-hide-flyouts","touchend",function(){c.performAnimationsToHideFlyouts()})});f.when("A","jQuery","fms-constants","ready").execute("fms-scrollEvent",
function(a,b,c){var d=b(c.INNER_SUBNAV_SELECTOR);if(d.length&&!d.css("position").match("sticky")){var e=function(){var a;return{create:function(){a||(a=b("<div></div>").css("height",d.height()+"px"),a.insertAfter(d))},destroy:function(){a&&(a.detach(),a=g)},getElement:function(){return a}}}(),f=d.offset().top;a.on.scroll(function(){var a=b(document).scrollTop(),c;c=d.hasClass("sticky")?e.getElement().offset().top:f;a>c?(e.create(),d.addClass("sticky")):(e.destroy(),d.removeClass("sticky"))})}});f.when("A",
"jQuery","fms-constants","fms-library","ready").register("fms-resizeEvent",function(a,b,c,d){a.on.resize(function(){if(b(c.LINK_FLYOUT_SELECTOR).length){var a=d.returnMaxFlyoutHeight(c.LINK_FLYOUT_SELECTOR);b(c.LINK_FLYOUT_SELECTOR).css({"max-height":a})}})})})})(function(){var f=window.AmazonUIPageJS||window.P,h=f._namespace||f.attributeErrors;return h?h("FreshExperienceMobileSubnavAssets"):f}(),window);
/* ******** */
(function(j,m,a){j.execute(function(){(function(b,d){d.when("A","a-carousel-framework","ready").register("pantry-mobile-dashboard",function(b,c){var d=b.$,h=b.state("pantry-mobile-widget"),h=h?h.pinning:!0,f=d("#pantry-mobile-widget");if(f.length!==0){if(h){var k=f.find(".pantry-mobile-widget-inner"),t=f.parent();if(!f.css("position").match("sticky")){var e=function(){var b;return{create:function(){b||(b=d("<div></div>").css("height",f.height()+"px"),b.insertAfter(f))},destroy:function(){b&&(b.detach(),
b=a)},getElement:function(){return b}}}();d(document).bind("touchmove scroll",function(){d(document).scrollTop();f.position();var a;a=f.hasClass("pw-sticky")?e.getElement().offset().top+k.position().top:k.offset().top;var b=t.offset().top+t.outerHeight()-f.height();d(document).scrollTop()>a&&!(d(document).scrollTop()>b)?(e.create(),f.addClass("pw-sticky")):(e.destroy(),f.removeClass("pw-sticky"))})}}else f.css({position:"static"});var l=f.find(".pw-categories");f.find(".pw-tab").click(function(){f.find(".pw-tab").removeClass("pw-tab-activated");
d(this).addClass("pw-tab-activated");if(d(this).hasClass("pw-tab-categories")){var a=d(this);b.fadeToggle(l,200,"ease-out",function(){var b=f.find(".pw-tab-arrow");l.is(":visible")?(b.removeClass("a-icon-section-expand"),b.addClass("a-icon-section-collapse"),d("#pw-categories-carousel").hasClass("a-carousel-initialized")||c.initializeAll()):(b.addClass("a-icon-section-expand"),b.removeClass("a-icon-section-collapse"),a.removeClass("pw-tab-activated"))});return!1}});return{updateBoxDisplay:function(a){var b=
f.find(".pw-box-display"),e=b[0].className.split(" ").filter(function(a){return!a.match(/-(box|fill)$/)});b.removeClass().addClass(d.trim(e.join(" "))).addClass(a.boxFillClass);b.find(".num-full-overlay").text(a.numBoxes-1>0?a.numBoxes-1:"");b.find(".percent-overlay").text(a.fillPercent+"%")}}}})})(m,j)})})(function(){var j=window.AmazonUIPageJS||window.P,m=j._namespace||j.attributeErrors;return m?m("PantryMobileWidgetJS"):j}(),window);
/* ******** */
(function(g,k){g.execute(function(){g.when("A","jQuery","twister-aui-page-state","ready").register("sampling-feature",function(j,a,g){function l(){this.mainButton=a("#frsmpl-mobile-selector-button");if(this.mainButton.length)this.links=a("#frsmpl-mobile-list").find(".a-touch-select"),typeof j.state("freeSampleList")==="undefined"&&g.updatePageState(),this.freeSampleList=j.state("freeSampleList"),this.buttonFaceShelf=a("#frsmpl-mobile-button-faces"),this.activeChoice=null}function m(a){var h;for(h=
0;h<a.length;h++)if(a[h].isSelectedByDefault)break;return h}function i(e,h,f){a("#freeSampleAsin-"+f).length||(h.append('<input type="hidden" name="fsa" id="freeSampleAsin-'+f+'">'),h.append('<input type="hidden" name="fsoid" id="freeSampleOfferListingID-'+f+'">'),h.append('<input type="hidden" name="fsoq" id="freeSampleOfferQuantity-'+f+'">'));a("#freeSampleAsin-"+f).val(e.asin);a("#freeSampleOfferListingID-"+f).val(e.offerListingId);a("#freeSampleOfferQuantity-"+f).val(1)}function o(e){a("#freeSampleAsin-"+
e).remove();a("#freeSampleOfferListingID-"+e).remove();a("#freeSampleOfferQuantity-"+e).remove()}function n(a){var h=a.indexOf("|");return h>0?a.substr(0,h):a}function k(){var e=a("form#addToCart");return e.length===1?e:null}function p(){var e=a("form#oneClickBuy");return e.length===1?e:null}function q(){var e=a("#buybox").find(".a-declarative").has("#add-to-cart-button");if(e.length===1)return e;e=a("#atc-declarative");return e.length===1?e:null}l.prototype={initialize:function(){var a=this;this.links.unbind("click.sampleChoices").bind("click.sampleChoices",
function(){this!==a.activeChoice&&a.activateChoice(this)});var h=m(a.freeSampleList);a.activateChoice(a.links[h])},activateChoice:function(e){this.activeChoice?(a("#frsmpl-mobile-state-"+this.activeChoice.sampleIndex).appendTo(this.buttonFaceShelf),a(this.activeChoice).removeClass("a-active")):this.mainButton.empty();this.activeChoice=e;e=a(this.activeChoice);if(!this.activeChoice.sampleIndex)this.activeChoice.sampleIndex=e.data("index");var h=a("#frsmpl-mobile-state-"+this.activeChoice.sampleIndex),
f=a("img.frsmpl-mobile-image",h);if(this.activeChoice.sampleIndex<this.freeSampleList.length){var b=this.freeSampleList[this.activeChoice.sampleIndex],c=k();c&&i(b,c,"cart");(c=p())&&i(b,c,"co");if(c=q())if((c=c.data("awMash"))&&c.inputs)c.inputs.a=n(c.inputs.a),c.inputs.a=c.inputs.a+"|"+b.asin,c.inputs.oid=n(c.inputs.oid),c.inputs.oid=c.inputs.oid+"|"+b.offerListingId;a.get(b.foresterURL);f.removeClass("csxfs_faded_image")}else{k()&&o("cart");p()&&o("co");if(b=q())if((b=b.data("awMash"))&&b.inputs)b.inputs.a=
n(b.inputs.a),b.inputs.oid=n(b.inputs.oid);f.addClass("csxfs_faded_image")}h.appendTo(this.mainButton);e.addClass("a-active")}};return{init:function(){var a=new l;a.mainButton.length&&a.initialize()}}});g.when("A","jQuery","twister-aui-page-state","ready").register("beauty-recommendations",function(j,a,g){function l(d){return a("#bRecCheckbox"+d)}function m(a){switch(a){case 0:return b.bRecCart1;case 1:return b.bRecCart2;case 2:return b.bRecCart3;case 3:return b.bRecCart4;default:return b.bRecCart1}}
function i(a){switch(a){case 0:return b.bRecWish1;case 1:return b.bRecWish2;case 2:return b.bRecWish3;case 3:return b.bRecWish4;default:return b.bRecWish1}}function o(a){switch(a){case 0:return b.bRecPrice1;case 1:return b.bRecPrice2;case 2:return b.bRecPrice3;case 3:return b.bRecPrice4;default:return b.bRecPrice1}}function n(){for(var d=0,b,f,g,j=0;j<c;j++)b=l(j),g=a("#bRecImg"+j),(f=b.prop("checked"))?(d++,b.attr("name","asin."+(d+1)),g.removeClass("bRecDisabled")):g.addClass("bRecDisabled");a("#bRecAddToCart").find("span.a-button-text").text(m(d));
a("#bRecAddToList").find("span.a-button-text").text(i(d));a("#bRecPriceLabel").text(o(d));d+=1;a("#bRecForm").attr("action",r+d);d="";for(b=0;b<c;b++)d+=l(b).prop("checked")?"1":"0";d=parseInt(d,2);d=s[d];a("#bRecPrice").text(d);if(e){d=a("#bRecForm").find("input[name='asin.1']").val();for(b=0;b<c;b++)f=l(b),f.prop("checked")&&(d&&(d+=h),d+=f.val());p().data("awMash").inputs.a=d}}function t(){var b=a("#buybox").find(".a-declarative").has("#add-to-cart-button");if(b.length===1)return b;b=a("#atc-declarative");
return b.length===1?b:null}function p(){var b=a("#bRecCartDeclarative");return b.length===1?b:null}function q(b,e){var c=b.data("awMash"),f=e.data("awMash");if(c&&c.inputs&&f)f.inputs={colid:c.inputs.colid,coliid:c.inputs.coliid,verificationSessionID:c.inputs.verificationSessionID,o:c.inputs.o},f.strings=a.extend({},c.strings),f.timeout=c.timeout}var e=a("#bRecCartDeclarative").length,h="|",f,b,c,s,r;return{init:function(){var d=a("#bRecDataDiv").find("script").html();typeof j.state("beautyRecommendations")===
"undefined"&&g.updatePageState();f=d?a.parseJSON(d):j.state("beautyRecommendations");typeof j.state("bRecDynamicStrings")==="undefined"&&g.updatePageState();b=j.state("bRecDynamicStrings");if(f&&b){c=f.numRecommendations;s=f.possibleSums;r=a("#bRecForm").attr("action");a("#bRecAddToList").click(function(){var b=a("#bRecAddToListNative").data("action");a("#bRecForm").attr("action",b)});if(e){var d=t(),h=p();try{q(d,h)}catch(i){k.ueLogError&&k.ueLogError(i,{logLevel:"ERROR",attribution:"beauty_recommendations_mobile",
message:"An error occurred when extracting information from the buybox."})}a("#bRecAddToCart").click(function(a){a.preventDefault()})}a("#bRecPricePara").removeClass("a-hidden");for(d=0;d<c;d++)l(d).prop("checked",!0).change(n);n()}}}});g.when("jQuery","A").register("twister-aui-page-state",function(g,a){var k=["freeSampleList","beautyRecommendations","bRecDynamicStrings"];return{updatePageState:function(){var l=a.parseJSON;a.each(g('script[type="a-state"]'),function(m){m=g(m);if(!m.data("a-eval")){var i=
m.attr("data-a-state");if(i&&(i=l(i),i.key&&g.inArray(i.key,k)!==-1)){var o=l(m.html());a.state.replace(i.key,o);m.data("a-eval",!0)}}})}}})})})(function(){var g=window.AmazonUIPageJS||window.P,k=g._namespace||g.attributeErrors;return k?k("LuxuryBeautyMobileStaticAssets"):g}(),window);
/* ******** */
